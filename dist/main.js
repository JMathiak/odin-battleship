(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{pS:()=>c,IE:()=>p,EA:()=>m});let t=[{name:"Carrier",length:5,placed:!1},{name:"Battleship",length:4,placed:!1},{name:"Cruiser",length:3,placed:!1},{name:"Submarine",length:3,placed:!1},{name:"Destroyer",length:2,placed:!1}],o=0;function r(e){let t=document.getElementById(e),o=["A","B","C","D","E","F","G"];for(let e=0;e<8;e++){let r=document.createElement("div");if(r.className="row",r.setAttribute("Y-Cord",e-1),0==e){let e=document.createElement("div");e.className="box",e.innerText="Y/X ",r.appendChild(e)}for(let t=0;t<8;t++){let a=document.createElement("div");a.className="box",0==e?7!==t&&(a.innerText=o[t],a.innerText+="("+t+")"):0==t&&(a.innerText=e-1),7==t&&0==e||(a.setAttribute("X-Cord",t-1),r.appendChild(a))}t.appendChild(r)}console.log(t.getElementsByClassName("row")[1].childNodes[0])}function a(){console.log(m);let e=document.getElementById("player").getElementsByClassName("row");for(let t=1;t<e.length;t++){let o=e[t],r=o.getAttribute("y-cord");for(let e=1;e<o.childNodes.length;e++){let t=o.childNodes[e],a=t.getAttribute("x-cord");"empty"==m.board.board[r][a]&&t.addEventListener("click",n)}}}function n(){let e=document.querySelector('input[name = "direction"]:checked').value;console.log(e),console.log(event.target),console.log(event.target.parentNode.getAttribute("y-cord")),console.log("xcord",event.target.getAttribute("x-cord")),1==m.board.placeShip(e,t[o].name,t[o].length,event.target.parentNode.getAttribute("y-cord"),event.target.getAttribute("x-cord"))&&function(e,t,r){let l=document.getElementById(e).getElementsByClassName("row");console.log(l[1].childNodes);for(let e=1;e<l.length;e++){let o=l[e],r=o.getAttribute("y-cord");for(let e=1;e<o.childNodes.length;e++){let a=o.childNodes[e],n=a.getAttribute("x-cord");"empty"!==t.board.board[r][n]&&"miss"!==t.board.board[r][n]&&a.classList.add("ship")}}!function(){let e=document.getElementById("player").getElementsByClassName("row");for(let t=1;t<e.length;t++){let o=e[t];for(let e=1;e<o.childNodes.length;e++)o.childNodes[e].removeEventListener("click",n)}}(),o++,o<5&&a(),5==o&&(p=!0,console.log("here"))}("player",m)}function l(){let e=event.target.parentNode.getAttribute("y-cord"),t=event.target.getAttribute("x-cord"),o='[y-Cord="'+e+'"]',r='[x-Cord="'+t+'"]',a=document.getElementById("guess").querySelectorAll(o)[0].querySelectorAll(r)[0];if(c.board.receiveAttack(e,t),"miss"==c.board.board[e][t]?a.classList.add("miss"):"empty"!=c.board.board[e][t]&&a.classList.add("hit"),1==c.board.checkForAllSunk())return void alert("User has Won");let n=Math.floor(7*Math.random()),l=Math.floor(7*Math.random());for(;!m.board.receiveAttack(l,n);)n=Math.floor(7*Math.random()),l=Math.floor(7*Math.random());let d='[y-cord="'+l+'"]',i='[x-cord="'+n+'"]',s=document.getElementById("player").querySelectorAll(d)[0].querySelectorAll(i)[0];"miss"==m.board.board[l][n]?s.classList.add("miss"):"empty"!=c.board.board[e][t]&&s.classList.add("hit"),1!=m.board.checkForAllSunk()||alert("Comp has Won")}function d(e,t,o,r,a){var n={};if(n.name=e,n.length=o,n.startingCord=r,n.endingCord=a,n.health=[],n.sunk=!1,n.direction=t,"horizontal"==t)for(let e=0;e<=o;e++)n.health.push({shipPoint:e,hitStatus:"false",coordinates:{xCord:parseInt(r.startingXCord)+e,yCord:parseInt(r.startingYCord)}});else if("vertical"==t)for(let e=0;e<=o;e++)n.health.push({shipPoint:e,hitStatus:"false",coordinates:{xCord:r.startingXCord,yCord:parseInt(r.startingYCord)+e}});return n.isSunk=function(){for(let e=0;e<this.length;e++)if("false"==this.health[e].hitStatus)return!1;return this.sunk=!0,!0},n.hit=function(e){this.health[e].hitStatus="true"},n}function i(){var e={ships:[],board:[["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"]],checkForValidPlacement:function(e){let t=e.startingCord.startingXCord,o=e.startingCord.startingYCord,r=e.endingCord.endingXCord,a=e.endingCord.endingYCord;if(console.log(t,o,r,a),"vertical"==e.direction){if(6==o)return!1;if(a>6)return console.log(e.name,a),!1;for(let r=o;r<=a;r++)if(console.log(e.name,this.board[r][t]),"empty"!=this.board[r][t])return!1}else if("horizontal"==e.direction){if(6==t)return!1;if(r>6)return!1;for(let a=t;a<=r;a++)if(console.log(e.name,this.board[o][a]),"empty"!=this.board[o][a])return!1}return!0},placeShip:function(t,o,r,a,n){let l={},i={startingXCord:n,startingYCord:a};"horizontal"==t?(l.endingXCord=parseInt(n)+r-1,l.endingYCord=a):"vertical"==t&&(l.endingXCord=n,l.endingYCord=parseInt(a)+r-1);let s=d(o,t,r,i,l);if(0==this.checkForValidPlacement(s))return!1;if(e.ships.push(s),"horizontal"==t)for(let e=0;e<r;e++){let t={name:s.name,spot:s.health[e]};console.log(parseInt(n)+e),this.board[a][parseInt(n)+e]=t}else if("vertical"==t)for(let e=0;e<r;e++){let t={name:s.name,spot:s.health[e]};this.board[parseInt(a)+e][n]=t}return!0},receiveAttack:function(e,t){if("empty"!==this.board[e][t]&&"miss"!==this.board[e][t]){let o=this.board[e][t].name,r=this.ships.filter((e=>e.name==o))[0];console.log(r),console.log("Received X Cord",t),console.log("Received Y Cord",e);let a=r.health.filter((o=>o.coordinates.xCord==t&&o.coordinates.yCord==e));return console.log(o),console.log(a),r.hit(a[0].shipPoint),r.isSunk(),!0}return"empty"==this.board[e][t]?(this.board[e][t]="miss",!0):"miss"!=this.board[e][t]&&"true"!=this.board[e][t].spot.hitStatus},checkForAllSunk:function(){for(let e=0;e<this.ships.length;e++)if(0==this.ships[e].sunk)return!1;return!0}};return e}function s(e){let t={};return t.type=e,t.board=i(),t}let h=[{name:"Carrier",length:5,placed:!1},{name:"Battleship",length:4,placed:!1},{name:"Cruiser",length:3,placed:!1},{name:"Submarine",length:3,placed:!1},{name:"Destroyer",length:2,placed:!1}];let m=s("human"),c=s("computer"),p=!1;r("player"),a(),r("guess"),function e(){1==p?(function(){let e=["horizontal","vertical"],t=Math.floor(7*Math.random()),o=Math.floor(7*Math.random()),r=Math.floor(2*Math.random());for(let a=0;a<h.length;a++){for(;!c.board.placeShip(e[r],h[a].name,h[a].length,o,t);)t=Math.floor(7*Math.random()),o=Math.floor(7*Math.random()),r=Math.floor(2*Math.random());console.log(h[a].name,"placed")}console.log(c.board.board)}(),function(){let e=document.getElementById("guess").getElementsByClassName("row");for(let t=1;t<e.length;t++){let o=e[t];o.getAttribute("y-cord");for(let e=1;e<o.childNodes.length;e++){let t=o.childNodes[e];t.getAttribute("x-cord"),t.addEventListener("click",l)}}}()):setTimeout(e,500)}(),exports.createShip=d,exports.createGameBoard=i,exports.gameLoop=function(){let e=s("human"),t=s("computer"),o=null,r=["Carrier","Battleship","Cruiser","Submarine","Destroyer"],a=[5,4,3,3,2],n=["horizontal","vertical"],l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random()),i=Math.floor(1*Math.random());for(let e=0;e<r.length;e++)for(;!t.board.placeShip(n[i],r[e],a[e],d,l);)l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());for(let t=0;t<r.length;t++)for(;!e.board.placeShip(n[i],r[t],a[t],d,l);)l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());for(;null==o;){for(l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());!t.board.receiveAttack(d,l);)l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());if(1==t.board.checkForAllSunk()&&(o="Human"),null==o){for(l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());!e.board.receiveAttack(d,l);)l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());1==e.board.checkForAllSunk()&&(o="Computer")}}return o}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixFQUFoQkQsS0FBS0UsVUFNMUIsR0FKb0MsR0FBaENQLEVBQUt6QixNQUFNMkIsb0JBQ2JzRCxFQUFTLFNBR0csTUFBVkEsRUFBZ0IsQ0FHbEIsSUFGQW5DLEVBQVFoQixLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsVUFDeEJpQixFQUFRbkIsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtFLFdBQ2hCZ0QsRUFBSWhGLE1BQU0wQixjQUFjdUIsRUFBT0gsSUFDckNBLEVBQVFoQixLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsVUFDeEJpQixFQUFRbkIsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtFLFVBRVMsR0FBL0JnRCxFQUFJaEYsTUFBTTJCLG9CQUNac0QsRUFBUyxhQUtmLE9BQU9BLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9ib2FyZC5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJpbXBvcnQgeyB1c2VyLCBjb21wLCBzaGlwc1BsYWNlZCwgcGxheUFnYWluIH0gZnJvbSBcIi4uL2luZGV4LmpzXCI7XHJcblxyXG5sZXQgc2hpcHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJDYXJyaWVyXCIsXHJcbiAgICBsZW5ndGg6IDUsXHJcbiAgICBwbGFjZWQ6IGZhbHNlLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYXR0bGVzaGlwXCIsXHJcbiAgICBsZW5ndGg6IDQsXHJcbiAgICBwbGFjZWQ6IGZhbHNlLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJDcnVpc2VyXCIsXHJcbiAgICBsZW5ndGg6IDMsXHJcbiAgICBwbGFjZWQ6IGZhbHNlLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJTdWJtYXJpbmVcIixcclxuICAgIGxlbmd0aDogMyxcclxuICAgIHBsYWNlZDogZmFsc2UsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkRlc3Ryb3llclwiLFxyXG4gICAgbGVuZ3RoOiAyLFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG5dO1xyXG5sZXQgc2hpcEluZGV4ID0gMDtcclxuZnVuY3Rpb24gZW1wdHlSZW5kZXIoZGl2KSB7XHJcbiAgbGV0IHBhcmVudERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRpdik7XHJcbiAgbGV0IHJvd0FyciA9IFtcIkFcIiwgXCJCXCIsIFwiQ1wiLCBcIkRcIiwgXCJFXCIsIFwiRlwiLCBcIkdcIl07XHJcbiAgLy9PdXRlciBsb29wIGlzIHJvd3MsIGlubmVyIGxvb3AgaXMgY29sdW1uc1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSsrKSB7XHJcbiAgICBsZXQgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIHJvdy5jbGFzc05hbWUgPSBcInJvd1wiO1xyXG4gICAgcm93LnNldEF0dHJpYnV0ZShcIlktQ29yZFwiLCBpIC0gMSk7XHJcbiAgICBpZiAoaSA9PSAwKSB7XHJcbiAgICAgIGxldCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICBib3guY2xhc3NOYW1lID0gXCJib3hcIjtcclxuICAgICAgYm94LmlubmVyVGV4dCA9IFwiWS9YIFwiO1xyXG4gICAgICByb3cuYXBwZW5kQ2hpbGQoYm94KTtcclxuICAgIH1cclxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgODsgaisrKSB7XHJcbiAgICAgIGxldCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICBib3guY2xhc3NOYW1lID0gXCJib3hcIjtcclxuICAgICAgaWYgKGkgPT0gMCkge1xyXG4gICAgICAgIGlmIChqICE9PSA3KSB7XHJcbiAgICAgICAgICBib3guaW5uZXJUZXh0ID0gcm93QXJyW2pdO1xyXG4gICAgICAgICAgYm94LmlubmVyVGV4dCArPSBcIihcIiArIGogKyBcIilcIjtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoaiA9PSAwKSB7XHJcbiAgICAgICAgYm94LmlubmVyVGV4dCA9IGkgLSAxO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoaiA9PSA3ICYmIGkgPT0gMCkge1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGJveC5zZXRBdHRyaWJ1dGUoXCJYLUNvcmRcIiwgaiAtIDEpO1xyXG4gICAgICAgIHJvdy5hcHBlbmRDaGlsZChib3gpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBwYXJlbnREaXYuYXBwZW5kQ2hpbGQocm93KTtcclxuICB9XHJcbiAgY29uc29sZS5sb2cocGFyZW50RGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJyb3dcIilbMV0uY2hpbGROb2Rlc1swXSk7XHJcbn1cclxuZnVuY3Rpb24gZGVsZXRlQm9hcmQoZGl2KSB7XHJcbiAgbGV0IHBhcmVudERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRpdik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZUFkZFNoaXBzKCkge1xyXG4gIGxldCBwYXJlbnREaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKTtcclxuICBsZXQgcm93cyA9IHBhcmVudERpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwicm93XCIpO1xyXG4gIGZvciAobGV0IGkgPSAxOyBpIDwgcm93cy5sZW5ndGg7IGkrKykge1xyXG4gICAgbGV0IGN1clJvdyA9IHJvd3NbaV07XHJcbiAgICBmb3IgKGxldCBqID0gMTsgaiA8IGN1clJvdy5jaGlsZE5vZGVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgIGxldCBjdXJCb3ggPSBjdXJSb3cuY2hpbGROb2Rlc1tqXTtcclxuICAgICAgY3VyQm94LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkFkZFNoaXBDbGljayk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlZnJlc2hCb2FyZChkaXYsIHBsYXllciwgc2hpcCkge1xyXG4gIGxldCBwYXJlbnREaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkaXYpO1xyXG4gIGxldCByb3dzID0gcGFyZW50RGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJyb3dcIik7XHJcbiAgY29uc29sZS5sb2cocm93c1sxXS5jaGlsZE5vZGVzKTtcclxuICBmb3IgKGxldCBpID0gMTsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHtcclxuICAgIGxldCBjdXJSb3cgPSByb3dzW2ldO1xyXG4gICAgbGV0IGN1cllDb3JkID0gY3VyUm93LmdldEF0dHJpYnV0ZShcInktY29yZFwiKTtcclxuICAgIGZvciAobGV0IGogPSAxOyBqIDwgY3VyUm93LmNoaWxkTm9kZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgbGV0IGN1ckJveCA9IGN1clJvdy5jaGlsZE5vZGVzW2pdO1xyXG4gICAgICBsZXQgY3VyWENvcmQgPSBjdXJCb3guZ2V0QXR0cmlidXRlKFwieC1jb3JkXCIpO1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgcGxheWVyLmJvYXJkLmJvYXJkW2N1cllDb3JkXVtjdXJYQ29yZF0gIT09IFwiZW1wdHlcIiAmJlxyXG4gICAgICAgIHBsYXllci5ib2FyZC5ib2FyZFtjdXJZQ29yZF1bY3VyWENvcmRdICE9PSBcIm1pc3NcIlxyXG4gICAgICApIHtcclxuICAgICAgICBjdXJCb3guY2xhc3NMaXN0LmFkZChcInNoaXBcIik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgcmVtb3ZlQWRkU2hpcHMoKTtcclxuICBzaGlwSW5kZXgrKztcclxuICBpZiAoc2hpcEluZGV4IDwgNSkge1xyXG4gICAgcGxhY2VTaGlwTGlzdGVuZXJzKCk7XHJcbiAgfVxyXG4gIGlmIChzaGlwSW5kZXggPT0gNSkge1xyXG4gICAgc2hpcHNQbGFjZWQgPSB0cnVlO1xyXG4gICAgY29uc29sZS5sb2coXCJoZXJlXCIpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcGxhY2VTaGlwTGlzdGVuZXJzKCkge1xyXG4gIGNvbnNvbGUubG9nKHVzZXIpO1xyXG4gIGxldCBwYXJlbnREaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKTtcclxuICBsZXQgcm93cyA9IHBhcmVudERpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwicm93XCIpO1xyXG4gIC8vbGV0IGRpcmVjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXJlY3Rpb24tcmFkaW8nKS52YWx1ZTtcclxuICBsZXQgZGlyZWN0aW9uID0gXCJob3Jpem9udGFsXCI7XHJcbiAgLy9PdXRlciBpdGVyYXRlcyB0aHJvdWdoIHJvd3MsIGlubmVyIHRocm91Z2ggYm94ZXMgaW4gcm93XHJcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBsZXQgY3VyUm93ID0gcm93c1tpXTtcclxuICAgIGxldCBjdXJZQ29yZCA9IGN1clJvdy5nZXRBdHRyaWJ1dGUoXCJ5LWNvcmRcIik7XHJcbiAgICBmb3IgKGxldCBqID0gMTsgaiA8IGN1clJvdy5jaGlsZE5vZGVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgIGxldCBjdXJCb3ggPSBjdXJSb3cuY2hpbGROb2Rlc1tqXTtcclxuICAgICAgbGV0IGN1clhDb3JkID0gY3VyQm94LmdldEF0dHJpYnV0ZShcIngtY29yZFwiKTtcclxuICAgICAgaWYgKHVzZXIuYm9hcmQuYm9hcmRbY3VyWUNvcmRdW2N1clhDb3JkXSA9PSBcImVtcHR5XCIpIHtcclxuICAgICAgICBjdXJCb3guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQWRkU2hpcENsaWNrKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gb25BZGRTaGlwQ2xpY2soKSB7XHJcbiAgbGV0IGRpcmVjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAnaW5wdXRbbmFtZSA9IFwiZGlyZWN0aW9uXCJdOmNoZWNrZWQnXHJcbiAgKS52YWx1ZTtcclxuICBjb25zb2xlLmxvZyhkaXJlY3Rpb24pO1xyXG4gIGNvbnNvbGUubG9nKGV2ZW50LnRhcmdldCk7XHJcbiAgY29uc29sZS5sb2coZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKFwieS1jb3JkXCIpKTtcclxuICBjb25zb2xlLmxvZyhcInhjb3JkXCIsIGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJ4LWNvcmRcIikpO1xyXG4gIGlmIChcclxuICAgIHVzZXIuYm9hcmQucGxhY2VTaGlwKFxyXG4gICAgICBkaXJlY3Rpb24sXHJcbiAgICAgIHNoaXBzW3NoaXBJbmRleF0ubmFtZSxcclxuICAgICAgc2hpcHNbc2hpcEluZGV4XS5sZW5ndGgsXHJcbiAgICAgIGV2ZW50LnRhcmdldC5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZShcInktY29yZFwiKSxcclxuICAgICAgZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZShcIngtY29yZFwiKVxyXG4gICAgKSA9PSB0cnVlXHJcbiAgKSB7XHJcbiAgICByZWZyZXNoQm9hcmQoXCJwbGF5ZXJcIiwgdXNlcik7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBndWVzc0NsaWNrKCkge1xyXG4gIGxldCB1c2VyWUd1ZXNzID0gZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKFwieS1jb3JkXCIpO1xyXG4gIGxldCB1c2VyWEd1ZXNzID0gZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZShcIngtY29yZFwiKTtcclxuICBsZXQgdXNlcllRdWVyeSA9IGBbeS1Db3JkPVwiYCArIHVzZXJZR3Vlc3MgKyBgXCJdYDtcclxuICBsZXQgdXNlclhRdWVyeSA9IGBbeC1Db3JkPVwiYCArIHVzZXJYR3Vlc3MgKyBgXCJdYDtcclxuICBsZXQgdXNlckJveE9mSW50ZXJlc3QgPSBkb2N1bWVudFxyXG4gICAgLmdldEVsZW1lbnRCeUlkKFwiZ3Vlc3NcIilcclxuICAgIC5xdWVyeVNlbGVjdG9yQWxsKHVzZXJZUXVlcnkpWzBdXHJcbiAgICAucXVlcnlTZWxlY3RvckFsbCh1c2VyWFF1ZXJ5KVswXTtcclxuXHJcbiAgY29tcC5ib2FyZC5yZWNlaXZlQXR0YWNrKHVzZXJZR3Vlc3MsIHVzZXJYR3Vlc3MpO1xyXG4gIGlmIChjb21wLmJvYXJkLmJvYXJkW3VzZXJZR3Vlc3NdW3VzZXJYR3Vlc3NdID09IFwibWlzc1wiKSB7XHJcbiAgICB1c2VyQm94T2ZJbnRlcmVzdC5jbGFzc0xpc3QuYWRkKFwibWlzc1wiKTtcclxuICB9IGVsc2UgaWYgKGNvbXAuYm9hcmQuYm9hcmRbdXNlcllHdWVzc11bdXNlclhHdWVzc10gIT0gXCJlbXB0eVwiKSB7XHJcbiAgICB1c2VyQm94T2ZJbnRlcmVzdC5jbGFzc0xpc3QuYWRkKFwiaGl0XCIpO1xyXG4gIH1cclxuICBpZiAoY29tcC5ib2FyZC5jaGVja0ZvckFsbFN1bmsoKSA9PSB0cnVlKSB7XHJcbiAgICBhbGVydChcIlVzZXIgaGFzIFdvblwiKTtcclxuICAgIC8vTWV0aG9kIHRvIHJlbW92ZSBhbGwgbGlzdGVuZXJzXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBsZXQgY29tcFhHdWVzcyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIGxldCBjb21wWUd1ZXNzID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgd2hpbGUgKCF1c2VyLmJvYXJkLnJlY2VpdmVBdHRhY2soY29tcFlHdWVzcywgY29tcFhHdWVzcykpIHtcclxuICAgIGNvbXBYR3Vlc3MgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgIGNvbXBZR3Vlc3MgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICB9XHJcblxyXG4gIGxldCBjb21wWVF1ZXJ5ID0gYFt5LWNvcmQ9XCJgICsgY29tcFlHdWVzcyArIGBcIl1gO1xyXG4gIGxldCBjb21wWFF1ZXJ5ID0gYFt4LWNvcmQ9XCJgICsgY29tcFhHdWVzcyArIGBcIl1gO1xyXG4gIGxldCBjb21wQm94T2ZJbnRlcmVzdCA9IGRvY3VtZW50XHJcbiAgICAuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJcIilcclxuICAgIC5xdWVyeVNlbGVjdG9yQWxsKGNvbXBZUXVlcnkpWzBdXHJcbiAgICAucXVlcnlTZWxlY3RvckFsbChjb21wWFF1ZXJ5KVswXTtcclxuXHJcbiAgaWYgKHVzZXIuYm9hcmQuYm9hcmRbY29tcFlHdWVzc11bY29tcFhHdWVzc10gPT0gXCJtaXNzXCIpIHtcclxuICAgIGNvbXBCb3hPZkludGVyZXN0LmNsYXNzTGlzdC5hZGQoXCJtaXNzXCIpO1xyXG4gIH0gZWxzZSBpZiAoY29tcC5ib2FyZC5ib2FyZFt1c2VyWUd1ZXNzXVt1c2VyWEd1ZXNzXSAhPSBcImVtcHR5XCIpIHtcclxuICAgIGNvbXBCb3hPZkludGVyZXN0LmNsYXNzTGlzdC5hZGQoXCJoaXRcIik7XHJcbiAgfVxyXG4gIGlmICh1c2VyLmJvYXJkLmNoZWNrRm9yQWxsU3VuaygpID09IHRydWUpIHtcclxuICAgIGFsZXJ0KFwiQ29tcCBoYXMgV29uXCIpO1xyXG4gICAgLy9NZXRob2QgdG8gcmVtb3ZlIGFsbCBsaXN0ZW5lcnNcclxuICAgIHJldHVybjtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZEd1ZXNzQ2xpY2soKSB7XHJcbiAgbGV0IHBhcmVudERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ3Vlc3NcIik7XHJcbiAgbGV0IHJvd3MgPSBwYXJlbnREaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInJvd1wiKTtcclxuICAvL2xldCBkaXJlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlyZWN0aW9uLXJhZGlvJykudmFsdWU7XHJcbiAgLy9PdXRlciBpdGVyYXRlcyB0aHJvdWdoIHJvd3MsIGlubmVyIHRocm91Z2ggYm94ZXMgaW4gcm93XHJcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBsZXQgY3VyUm93ID0gcm93c1tpXTtcclxuICAgIGxldCBjdXJZQ29yZCA9IGN1clJvdy5nZXRBdHRyaWJ1dGUoXCJ5LWNvcmRcIik7XHJcbiAgICBmb3IgKGxldCBqID0gMTsgaiA8IGN1clJvdy5jaGlsZE5vZGVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgIGxldCBjdXJCb3ggPSBjdXJSb3cuY2hpbGROb2Rlc1tqXTtcclxuICAgICAgbGV0IGN1clhDb3JkID0gY3VyQm94LmdldEF0dHJpYnV0ZShcIngtY29yZFwiKTtcclxuICAgICAgY3VyQm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBndWVzc0NsaWNrKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsZWFyQm9hcmRzKCkge1xyXG4gIGxldCB1c2VyQm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKTtcclxuICBsZXQgZ3Vlc3NCb2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ3Vlc3NcIik7XHJcbiAgd2hpbGUgKHVzZXJCb2FyZC5maXJzdENoaWxkKSB7XHJcbiAgICB1c2VyQm9hcmQucmVtb3ZlQ2hpbGQodXNlckJvYXJkLnJlbW92ZUNoaWxkKTtcclxuICB9XHJcbiAgd2hpbGUgKGd1ZXNzQm9hcmQuZmlyc3RDaGlsZCkge1xyXG4gICAgZ3Vlc3NCb2FyZC5yZW1vdmVDaGlsZChndWVzc0JvYXJkLnJlbW92ZUNoaWxkKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluaXRpYWxpemVCdXR0b24oKSB7XHJcbiAgbGV0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheS1hZ2FpblwiKTtcclxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHBsYXlBZ2Fpbik7XHJcbn1cclxuXHJcbmV4cG9ydCB7IGVtcHR5UmVuZGVyLCBwbGFjZVNoaXBMaXN0ZW5lcnMsIGFkZEd1ZXNzQ2xpY2ssIGNsZWFyQm9hcmRzIH07XHJcbiIsImltcG9ydCB7XHJcbiAgZW1wdHlSZW5kZXIsXHJcbiAgcGxhY2VTaGlwTGlzdGVuZXJzLFxyXG4gIGFkZEd1ZXNzQ2xpY2ssXHJcbiAgY2xlYXJCb2FyZHMsXHJcbn0gZnJvbSBcIi4vbW9kdWxlcy9ib2FyZFwiO1xyXG5mdW5jdGlvbiBjcmVhdGVTaGlwKG5hbWUsIGRpcmVjdGlvbiwgbGVuZ3RoLCBzdGFydGluZ0NvcmQsIGVuZGluZ0NvcmQpIHtcclxuICB2YXIgc2hpcCA9IHt9O1xyXG4gIHNoaXAubmFtZSA9IG5hbWU7XHJcbiAgc2hpcC5sZW5ndGggPSBsZW5ndGg7XHJcbiAgc2hpcC5zdGFydGluZ0NvcmQgPSBzdGFydGluZ0NvcmQ7XHJcbiAgc2hpcC5lbmRpbmdDb3JkID0gZW5kaW5nQ29yZDtcclxuICBzaGlwLmhlYWx0aCA9IFtdO1xyXG4gIHNoaXAuc3VuayA9IGZhbHNlO1xyXG4gIHNoaXAuZGlyZWN0aW9uID0gZGlyZWN0aW9uO1xyXG5cclxuICBpZiAoZGlyZWN0aW9uID09IFwiaG9yaXpvbnRhbFwiKSB7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBsZW5ndGg7IGkrKykge1xyXG4gICAgICBzaGlwLmhlYWx0aC5wdXNoKHtcclxuICAgICAgICBzaGlwUG9pbnQ6IGksXHJcbiAgICAgICAgaGl0U3RhdHVzOiBcImZhbHNlXCIsXHJcbiAgICAgICAgY29vcmRpbmF0ZXM6IHtcclxuICAgICAgICAgIHhDb3JkOiBwYXJzZUludChzdGFydGluZ0NvcmQuc3RhcnRpbmdYQ29yZCkgKyBpLFxyXG4gICAgICAgICAgeUNvcmQ6IHBhcnNlSW50KHN0YXJ0aW5nQ29yZC5zdGFydGluZ1lDb3JkKSxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PSBcInZlcnRpY2FsXCIpIHtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHNoaXAuaGVhbHRoLnB1c2goe1xyXG4gICAgICAgIHNoaXBQb2ludDogaSxcclxuICAgICAgICBoaXRTdGF0dXM6IFwiZmFsc2VcIixcclxuICAgICAgICBjb29yZGluYXRlczoge1xyXG4gICAgICAgICAgeENvcmQ6IHN0YXJ0aW5nQ29yZC5zdGFydGluZ1hDb3JkLFxyXG4gICAgICAgICAgeUNvcmQ6IHBhcnNlSW50KHN0YXJ0aW5nQ29yZC5zdGFydGluZ1lDb3JkKSArIGksXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzaGlwLmlzU3VuayA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5sZW5ndGg7IGorKykge1xyXG4gICAgICBpZiAodGhpcy5oZWFsdGhbal0uaGl0U3RhdHVzID09IFwiZmFsc2VcIikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5zdW5rID0gdHJ1ZTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH07XHJcblxyXG4gIHNoaXAuaGl0ID0gZnVuY3Rpb24gKGhpdFBvaW50KSB7XHJcbiAgICB0aGlzLmhlYWx0aFtoaXRQb2ludF0uaGl0U3RhdHVzID0gXCJ0cnVlXCI7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHNoaXA7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUdhbWVCb2FyZCgpIHtcclxuICB2YXIgZ2FtZUJvYXJkID0ge307XHJcbiAgZ2FtZUJvYXJkLnNoaXBzID0gW107XHJcbiAgZ2FtZUJvYXJkLmJvYXJkID0gW1xyXG4gICAgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgXTtcclxuXHJcbiAgZ2FtZUJvYXJkLmNoZWNrRm9yVmFsaWRQbGFjZW1lbnQgPSBmdW5jdGlvbiAoc2hpcFRvUGxhY2UpIHtcclxuICAgIGxldCBzdGFydGluZ0NvbHVtbiA9IHNoaXBUb1BsYWNlLnN0YXJ0aW5nQ29yZC5zdGFydGluZ1hDb3JkO1xyXG4gICAgbGV0IHN0YXJ0aW5nUm93ID0gc2hpcFRvUGxhY2Uuc3RhcnRpbmdDb3JkLnN0YXJ0aW5nWUNvcmQ7XHJcbiAgICBsZXQgZW5kaW5nQ29sdW1uID0gc2hpcFRvUGxhY2UuZW5kaW5nQ29yZC5lbmRpbmdYQ29yZDtcclxuICAgIGxldCBlbmRpbmdSb3cgPSBzaGlwVG9QbGFjZS5lbmRpbmdDb3JkLmVuZGluZ1lDb3JkO1xyXG4gICAgY29uc29sZS5sb2coc3RhcnRpbmdDb2x1bW4sIHN0YXJ0aW5nUm93LCBlbmRpbmdDb2x1bW4sIGVuZGluZ1Jvdyk7XHJcbiAgICBpZiAoc2hpcFRvUGxhY2UuZGlyZWN0aW9uID09IFwidmVydGljYWxcIikge1xyXG4gICAgICBpZiAoc3RhcnRpbmdSb3cgPT0gNikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZW5kaW5nUm93ID4gNikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHNoaXBUb1BsYWNlLm5hbWUsIGVuZGluZ1Jvdyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAobGV0IGkgPSBzdGFydGluZ1JvdzsgaSA8PSBlbmRpbmdSb3c7IGkrKykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHNoaXBUb1BsYWNlLm5hbWUsIHRoaXMuYm9hcmRbaV1bc3RhcnRpbmdDb2x1bW5dKTtcclxuICAgICAgICBpZiAodGhpcy5ib2FyZFtpXVtzdGFydGluZ0NvbHVtbl0gIT0gXCJlbXB0eVwiKSB7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKHNoaXBUb1BsYWNlLmRpcmVjdGlvbiA9PSBcImhvcml6b250YWxcIikge1xyXG4gICAgICBpZiAoc3RhcnRpbmdDb2x1bW4gPT0gNikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZW5kaW5nQ29sdW1uID4gNikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGxldCBqID0gc3RhcnRpbmdDb2x1bW47IGogPD0gZW5kaW5nQ29sdW1uOyBqKyspIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhzaGlwVG9QbGFjZS5uYW1lLCB0aGlzLmJvYXJkW3N0YXJ0aW5nUm93XVtqXSk7XHJcbiAgICAgICAgaWYgKHRoaXMuYm9hcmRbc3RhcnRpbmdSb3ddW2pdICE9IFwiZW1wdHlcIikge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfTtcclxuXHJcbiAgZ2FtZUJvYXJkLnBsYWNlU2hpcCA9IGZ1bmN0aW9uIChkaXJlY3Rpb24sIG5hbWUsIGxlbmd0aCwgeUNvcmQsIHhDb3JkKSB7XHJcbiAgICBsZXQgZW5kaW5nQ29yZCA9IHt9O1xyXG4gICAgbGV0IHN0YXJ0aW5nQ29yZCA9IHsgc3RhcnRpbmdYQ29yZDogeENvcmQsIHN0YXJ0aW5nWUNvcmQ6IHlDb3JkIH07XHJcblxyXG4gICAgaWYgKGRpcmVjdGlvbiA9PSBcImhvcml6b250YWxcIikge1xyXG4gICAgICBlbmRpbmdDb3JkLmVuZGluZ1hDb3JkID0gcGFyc2VJbnQoeENvcmQpICsgbGVuZ3RoIC0gMTtcclxuICAgICAgZW5kaW5nQ29yZC5lbmRpbmdZQ29yZCA9IHlDb3JkO1xyXG4gICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gXCJ2ZXJ0aWNhbFwiKSB7XHJcbiAgICAgIGVuZGluZ0NvcmQuZW5kaW5nWENvcmQgPSB4Q29yZDtcclxuICAgICAgZW5kaW5nQ29yZC5lbmRpbmdZQ29yZCA9IHBhcnNlSW50KHlDb3JkKSArIGxlbmd0aCAtIDE7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHNoaXAgPSBjcmVhdGVTaGlwKG5hbWUsIGRpcmVjdGlvbiwgbGVuZ3RoLCBzdGFydGluZ0NvcmQsIGVuZGluZ0NvcmQpO1xyXG4gICAgaWYgKHRoaXMuY2hlY2tGb3JWYWxpZFBsYWNlbWVudChzaGlwKSA9PSBmYWxzZSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBnYW1lQm9hcmQuc2hpcHMucHVzaChzaGlwKTtcclxuICAgICAgaWYgKGRpcmVjdGlvbiA9PSBcImhvcml6b250YWxcIikge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgIGxldCBwbGFjZU9iaiA9IHtcclxuICAgICAgICAgICAgbmFtZTogc2hpcC5uYW1lLFxyXG4gICAgICAgICAgICBzcG90OiBzaGlwLmhlYWx0aFtpXSxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhwYXJzZUludCh4Q29yZCkgKyBpKTtcclxuICAgICAgICAgIHRoaXMuYm9hcmRbeUNvcmRdW3BhcnNlSW50KHhDb3JkKSArIGldID0gcGxhY2VPYmo7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PSBcInZlcnRpY2FsXCIpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICBsZXQgcGxhY2VPYmogPSB7XHJcbiAgICAgICAgICAgIG5hbWU6IHNoaXAubmFtZSxcclxuICAgICAgICAgICAgc3BvdDogc2hpcC5oZWFsdGhbaV0sXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgdGhpcy5ib2FyZFtwYXJzZUludCh5Q29yZCkgKyBpXVt4Q29yZF0gPSBwbGFjZU9iajtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH07XHJcblxyXG4gIGdhbWVCb2FyZC5yZWNlaXZlQXR0YWNrID0gZnVuY3Rpb24gKHlDb3JkLCB4Q29yZCkge1xyXG4gICAgaWYgKFxyXG4gICAgICB0aGlzLmJvYXJkW3lDb3JkXVt4Q29yZF0gIT09IFwiZW1wdHlcIiAmJlxyXG4gICAgICB0aGlzLmJvYXJkW3lDb3JkXVt4Q29yZF0gIT09IFwibWlzc1wiXHJcbiAgICApIHtcclxuICAgICAgbGV0IHNoaXBOYW1lID0gdGhpcy5ib2FyZFt5Q29yZF1beENvcmRdLm5hbWU7XHJcbiAgICAgIGxldCBmaWx0ZXJlZEFyciA9IHRoaXMuc2hpcHMuZmlsdGVyKChzaCkgPT4gc2gubmFtZSA9PSBzaGlwTmFtZSk7XHJcbiAgICAgIGxldCBzaGlwID0gZmlsdGVyZWRBcnJbMF07XHJcbiAgICAgIGNvbnNvbGUubG9nKHNoaXApO1xyXG4gICAgICBjb25zb2xlLmxvZyhcIlJlY2VpdmVkIFggQ29yZFwiLCB4Q29yZCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiUmVjZWl2ZWQgWSBDb3JkXCIsIHlDb3JkKTtcclxuICAgICAgbGV0IHBvaW50QXJyID0gc2hpcC5oZWFsdGguZmlsdGVyKFxyXG4gICAgICAgIChwb2ludCkgPT5cclxuICAgICAgICAgIHBvaW50LmNvb3JkaW5hdGVzLnhDb3JkID09IHhDb3JkICYmIHBvaW50LmNvb3JkaW5hdGVzLnlDb3JkID09IHlDb3JkXHJcbiAgICAgICk7XHJcbiAgICAgIGNvbnNvbGUubG9nKHNoaXBOYW1lKTtcclxuICAgICAgY29uc29sZS5sb2cocG9pbnRBcnIpO1xyXG4gICAgICBzaGlwLmhpdChwb2ludEFyclswXS5zaGlwUG9pbnQpO1xyXG4gICAgICBzaGlwLmlzU3VuaygpO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5ib2FyZFt5Q29yZF1beENvcmRdID09IFwiZW1wdHlcIikge1xyXG4gICAgICB0aGlzLmJvYXJkW3lDb3JkXVt4Q29yZF0gPSBcIm1pc3NcIjtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2UgaWYgKFxyXG4gICAgICB0aGlzLmJvYXJkW3lDb3JkXVt4Q29yZF0gPT0gXCJtaXNzXCIgfHxcclxuICAgICAgdGhpcy5ib2FyZFt5Q29yZF1beENvcmRdLnNwb3QuaGl0U3RhdHVzID09IFwidHJ1ZVwiXHJcbiAgICApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfTtcclxuXHJcbiAgZ2FtZUJvYXJkLmNoZWNrRm9yQWxsU3VuayA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zaGlwcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAodGhpcy5zaGlwc1tpXS5zdW5rID09IGZhbHNlKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9O1xyXG5cclxuICByZXR1cm4gZ2FtZUJvYXJkO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVQbGF5ZXIodHlwZSkge1xyXG4gIGxldCBwbGF5ZXIgPSB7fTtcclxuICBwbGF5ZXIudHlwZSA9IHR5cGU7XHJcbiAgcGxheWVyLmJvYXJkID0gY3JlYXRlR2FtZUJvYXJkKCk7XHJcblxyXG4gIHJldHVybiBwbGF5ZXI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdhbWVMb29wKCkge1xyXG4gIGxldCBodW0gPSBjcmVhdGVQbGF5ZXIoXCJodW1hblwiKTtcclxuICBsZXQgY29tcCA9IGNyZWF0ZVBsYXllcihcImNvbXB1dGVyXCIpO1xyXG4gIGxldCB3aW5uZXIgPSBudWxsO1xyXG4gIGxldCB0dXJuQ291bnRlciA9IDE7XHJcbiAgbGV0IHNoaXBOYW1lcyA9IFtcclxuICAgIFwiQ2FycmllclwiLFxyXG4gICAgXCJCYXR0bGVzaGlwXCIsXHJcbiAgICBcIkNydWlzZXJcIixcclxuICAgIFwiU3VibWFyaW5lXCIsXHJcbiAgICBcIkRlc3Ryb3llclwiLFxyXG4gIF07XHJcbiAgbGV0IHNoaXBMZW5ndGhzID0gWzUsIDQsIDMsIDMsIDJdO1xyXG4gIGxldCBkaXJlY3Rpb25zID0gW1wiaG9yaXpvbnRhbFwiLCBcInZlcnRpY2FsXCJdO1xyXG4gIGxldCB4Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIGxldCB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIGxldCBkaXJlY3Rpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxKTtcclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTmFtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgIHdoaWxlIChcclxuICAgICAgIWNvbXAuYm9hcmQucGxhY2VTaGlwKFxyXG4gICAgICAgIGRpcmVjdGlvbnNbZGlyZWN0aW9uXSxcclxuICAgICAgICBzaGlwTmFtZXNbaV0sXHJcbiAgICAgICAgc2hpcExlbmd0aHNbaV0sXHJcbiAgICAgICAgeUNvcmQsXHJcbiAgICAgICAgeENvcmRcclxuICAgICAgKVxyXG4gICAgKSB7XHJcbiAgICAgIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICAgIHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgeUNvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuXHJcbiAgZm9yIChsZXQgaiA9IDA7IGogPCBzaGlwTmFtZXMubGVuZ3RoOyBqKyspIHtcclxuICAgIHdoaWxlIChcclxuICAgICAgIWh1bS5ib2FyZC5wbGFjZVNoaXAoXHJcbiAgICAgICAgZGlyZWN0aW9uc1tkaXJlY3Rpb25dLFxyXG4gICAgICAgIHNoaXBOYW1lc1tqXSxcclxuICAgICAgICBzaGlwTGVuZ3Roc1tqXSxcclxuICAgICAgICB5Q29yZCxcclxuICAgICAgICB4Q29yZFxyXG4gICAgICApXHJcbiAgICApIHtcclxuICAgICAgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgeUNvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHdoaWxlICh3aW5uZXIgPT0gbnVsbCkge1xyXG4gICAgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgIHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICB3aGlsZSAoIWNvbXAuYm9hcmQucmVjZWl2ZUF0dGFjayh5Q29yZCwgeENvcmQpKSB7XHJcbiAgICAgIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICAgIHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICB9XHJcbiAgICBpZiAoY29tcC5ib2FyZC5jaGVja0ZvckFsbFN1bmsoKSA9PSB0cnVlKSB7XHJcbiAgICAgIHdpbm5lciA9IFwiSHVtYW5cIjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAod2lubmVyID09IG51bGwpIHtcclxuICAgICAgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgeUNvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgd2hpbGUgKCFodW0uYm9hcmQucmVjZWl2ZUF0dGFjayh5Q29yZCwgeENvcmQpKSB7XHJcbiAgICAgICAgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgICB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChodW0uYm9hcmQuY2hlY2tGb3JBbGxTdW5rKCkgPT0gdHJ1ZSkge1xyXG4gICAgICAgIHdpbm5lciA9IFwiQ29tcHV0ZXJcIjtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHdpbm5lcjtcclxufVxyXG5cclxuZnVuY3Rpb24gdGVzdFJlbmRlcigpIHtcclxuICBsZXQgc2hpcE5hbWVzID0gW1xyXG4gICAgXCJDYXJyaWVyXCIsXHJcbiAgICBcIkJhdHRsZXNoaXBcIixcclxuICAgIFwiQ3J1aXNlclwiLFxyXG4gICAgXCJTdWJtYXJpbmVcIixcclxuICAgIFwiRGVzdHJveWVyXCIsXHJcbiAgXTtcclxuICBsZXQgc2hpcExlbmd0aHMgPSBbNSwgNCwgMywgMywgMl07XHJcbiAgbGV0IGRpcmVjdGlvbnMgPSBbXCJob3Jpem9udGFsXCIsIFwidmVydGljYWxcIl07XHJcbiAgbGV0IHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgbGV0IHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgbGV0IGRpcmVjdGlvbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xyXG4gIGxldCBwbGF5ZXIgPSBjcmVhdGVQbGF5ZXIoXCJodW1hblwiKTtcclxuICBmb3IgKGxldCBqID0gMDsgaiA8IHNoaXBOYW1lcy5sZW5ndGg7IGorKykge1xyXG4gICAgd2hpbGUgKFxyXG4gICAgICAhcGxheWVyLmJvYXJkLnBsYWNlU2hpcChcclxuICAgICAgICBkaXJlY3Rpb25zW2RpcmVjdGlvbl0sXHJcbiAgICAgICAgc2hpcE5hbWVzW2pdLFxyXG4gICAgICAgIHNoaXBMZW5ndGhzW2pdLFxyXG4gICAgICAgIHlDb3JkLFxyXG4gICAgICAgIHhDb3JkXHJcbiAgICAgIClcclxuICAgICkge1xyXG4gICAgICB4Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgICB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgICBkaXJlY3Rpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxKTtcclxuICAgIH1cclxuICB9XHJcbiAgbGV0IHBhcmVudERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyXCIpO1xyXG4gIGxldCByb3dBcnIgPSBbXCJBXCIsIFwiQlwiLCBcIkNcIiwgXCJEXCIsIFwiRVwiLCBcIkZcIiwgXCJHXCJdO1xyXG4gIC8vT3V0ZXIgbG9vcCBpcyByb3dzLCBpbm5lciBsb29wIGlzIGNvbHVtbnNcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkrKykge1xyXG4gICAgbGV0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICByb3cuY2xhc3NOYW1lID0gXCJyb3dcIjtcclxuICAgIHJvdy5zZXRBdHRyaWJ1dGUoXCJZLUNvcmRcIiwgaSk7XHJcbiAgICBpZiAoaSA9PSAwKSB7XHJcbiAgICAgIGxldCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICBib3guY2xhc3NOYW1lID0gXCJib3hcIjtcclxuICAgICAgYm94LmlubmVyVGV4dCA9IFwiWS9YIFwiO1xyXG4gICAgICByb3cuYXBwZW5kQ2hpbGQoYm94KTtcclxuICAgIH1cclxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgODsgaisrKSB7XHJcbiAgICAgIGxldCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICBib3guY2xhc3NOYW1lID0gXCJib3hcIjtcclxuICAgICAgYm94LnNldEF0dHJpYnV0ZShcIlgtQ29yZFwiLCBqKTtcclxuICAgICAgaWYgKGkgPT0gMCkge1xyXG4gICAgICAgIGlmIChqICE9PSA3KSB7XHJcbiAgICAgICAgICBib3guaW5uZXJUZXh0ID0gcm93QXJyW2pdO1xyXG4gICAgICAgICAgYm94LmlubmVyVGV4dCArPSBcIihcIiArIGogKyBcIilcIjtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoaiA9PSAwKSB7XHJcbiAgICAgICAgYm94LmlubmVyVGV4dCA9IGk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKHBsYXllci5ib2FyZC5ib2FyZFtpIC0gMV1baiAtIDFdID09IFwiZW1wdHlcIikge1xyXG4gICAgICAgICAgYm94LmlubmVyVGV4dCA9IHBsYXllci5ib2FyZC5ib2FyZFtpIC0gMV1baiAtIDFdO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBib3guaW5uZXJUZXh0ID0gcGxheWVyLmJvYXJkLmJvYXJkW2kgLSAxXVtqIC0gMV0ubmFtZTtcclxuICAgICAgICAgIGJveC5jbGFzc0xpc3QuYWRkKFwic2hpcFwiKTtcclxuICAgICAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsZXQgc2hpcE5hbWUgPSBwbGF5ZXIuYm9hcmQuYm9hcmRbaSAtIDFdW2ogLSAxXS5uYW1lO1xyXG4gICAgICAgICAgICBsZXQgZmlsdGVyZWRBcnIgPSBwbGF5ZXIuYm9hcmQuc2hpcHMuZmlsdGVyKFxyXG4gICAgICAgICAgICAgIChzaCkgPT4gc2gubmFtZSA9PSBzaGlwTmFtZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBsZXQgc2hpcCA9IGZpbHRlcmVkQXJyWzBdO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzaGlwKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocGxheWVyLmJvYXJkLmJvYXJkKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGogPT0gNyAmJiBpID09IDApIHtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByb3cuYXBwZW5kQ2hpbGQoYm94KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcGFyZW50RGl2LmFwcGVuZENoaWxkKHJvdyk7XHJcbiAgfVxyXG59XHJcblxyXG4vL3Rlc3RSZW5kZXIoKTtcclxuLy8gZ2FtZUxvb3AoKTtcclxubGV0IHNoaXBzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiQ2FycmllclwiLFxyXG4gICAgbGVuZ3RoOiA1LFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmF0dGxlc2hpcFwiLFxyXG4gICAgbGVuZ3RoOiA0LFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQ3J1aXNlclwiLFxyXG4gICAgbGVuZ3RoOiAzLFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiU3VibWFyaW5lXCIsXHJcbiAgICBsZW5ndGg6IDMsXHJcbiAgICBwbGFjZWQ6IGZhbHNlLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJEZXN0cm95ZXJcIixcclxuICAgIGxlbmd0aDogMixcclxuICAgIHBsYWNlZDogZmFsc2UsXHJcbiAgfSxcclxuXTtcclxuXHJcbmZ1bmN0aW9uIHdhaXRGb3JTaGlwcygpIHtcclxuICBpZiAoc2hpcHNQbGFjZWQgIT0gdHJ1ZSkge1xyXG4gICAgc2V0VGltZW91dCh3YWl0Rm9yU2hpcHMsIDUwMCk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIHBsYWNlQ29tcHV0ZXJTaGlwcygpO1xyXG4gIGFkZEd1ZXNzQ2xpY2soKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcGxhY2VDb21wdXRlclNoaXBzKCkge1xyXG4gIGxldCBkaXJlY3Rpb25zID0gW1wiaG9yaXpvbnRhbFwiLCBcInZlcnRpY2FsXCJdO1xyXG4gIGxldCB4Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIGxldCB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIGxldCBkaXJlY3Rpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICB3aGlsZSAoXHJcbiAgICAgICFjb21wLmJvYXJkLnBsYWNlU2hpcChcclxuICAgICAgICBkaXJlY3Rpb25zW2RpcmVjdGlvbl0sXHJcbiAgICAgICAgc2hpcHNbaV0ubmFtZSxcclxuICAgICAgICBzaGlwc1tpXS5sZW5ndGgsXHJcbiAgICAgICAgeUNvcmQsXHJcbiAgICAgICAgeENvcmRcclxuICAgICAgKVxyXG4gICAgKSB7XHJcbiAgICAgIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICAgIHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICAgIGRpcmVjdGlvbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xyXG4gICAgfVxyXG4gICAgY29uc29sZS5sb2coc2hpcHNbaV0ubmFtZSwgXCJwbGFjZWRcIik7XHJcbiAgfVxyXG4gIGNvbnNvbGUubG9nKGNvbXAuYm9hcmQuYm9hcmQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRVcEdhbWUoKSB7XHJcbiAgLy8gbGV0IHVzZXIgPSBjcmVhdGVQbGF5ZXIoXCJodW1hblwiKTtcclxuICAvLyBsZXQgY29tcCA9IGNyZWF0ZVBsYXllcihcImNvbXB1dGVyXCIpO1xyXG4gIC8vIGxldCB0dXJuQ291bnQgPSAwO1xyXG4gIC8vIGxldCBzaGlwc1BsYWNlZCA9IGZhbHNlO1xyXG4gIC8vIEFib3ZlIG5lZWQgdG8gYmUgZ2xvYmFsIGZvciB0aGUgZXhwb3J0XHJcbiAgLy8gZXhwb3J0IHsgdXNlciwgY29tcCwgdHVybkNvdW50LCBzaGlwc1BsYWNlZCB9O1xyXG4gIGVtcHR5UmVuZGVyKFwicGxheWVyXCIpO1xyXG4gIHBsYWNlU2hpcExpc3RlbmVycygpO1xyXG4gIGVtcHR5UmVuZGVyKFwiZ3Vlc3NcIik7XHJcbiAgd2FpdEZvclNoaXBzKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBsYXlBZ2FpbigpIHtcclxuICBjbGVhckJvYXJkcygpO1xyXG4gIGNsZWFyQXJyYXlzKCk7XHJcbiAgc2hpcHNQbGFjZWQgPSBmYWxzZTtcclxuICBlbXB0eVJlbmRlcihcInBsYXllclwiKTtcclxuICBwbGFjZVNoaXBMaXN0ZW5lcnMoKTtcclxuICBlbXB0eVJlbmRlcihcImd1ZXNzXCIpO1xyXG4gIHdhaXRGb3JTaGlwcygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbGVhckFycmF5cygpIHtcclxuICAvL091dHRlciByb3dzLCBpbm5lciBjb2x1bW5zXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCA3OyBpKyspIHtcclxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgNzsgaisrKSB7XHJcbiAgICAgIHVzZXIuYm9hcmQuYm9hcmRbaV1bal0gPSBcImVtcHR5XCI7XHJcbiAgICAgIGNvbXAuYm9hcmQuYm9hcmRbaV1bal0gPSBcImVtcHR5XCI7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbmxldCB1c2VyID0gY3JlYXRlUGxheWVyKFwiaHVtYW5cIik7XHJcbmxldCBjb21wID0gY3JlYXRlUGxheWVyKFwiY29tcHV0ZXJcIik7XHJcbmxldCB0dXJuQ291bnQgPSAwOyAvL05vdCB1c2VkP1xyXG5sZXQgc2hpcHNQbGFjZWQgPSBmYWxzZTtcclxuZXhwb3J0IHsgdXNlciwgY29tcCwgdHVybkNvdW50LCBzaGlwc1BsYWNlZCwgcGxheUFnYWluIH07XHJcbnNldFVwR2FtZSgpO1xyXG4vKlxyXG5BZnRlciB3YWl0IGZvciBzaGlwcywgY2FsbCBmdW5jdGlvbiB0aGF0IHNldHMgdXAgY29tcHV0ZXIgcGxheWVyXHJcbkRvIG5vdGhpbmcgdW50aWwgb24gY2xpY2sgZnVuY3Rpb24gaXMgY2FsbGVkXHJcbk9uIGNsaWNrIGZ1bmN0aW9uIGZvciBodW1hbiBndWVzc2VzOlxyXG4tR2V0IGNvb3JkaW5hdGVzXHJcbi1Db21wLnJlY2VpdmUgYXR0YWNrXHJcbi1VcGRhdGUgZ3Vlc3Mgc3F1YXJlIHdpdGggY2xhc3MgZm9yIGhpdCBvciBtaXNzXHJcbi1DaGVjayBmb3IgYWxsIHN1bmtcclxuLSBpZiBhbGwgc3VuaywgcmVtb3ZlIGFsbCBsaXN0ZW5lcnMsIHJldHVybiwgYW5kIGRpc3BsYXkgd2lubmVyXHJcbi1pZiBub3QgYWxsIHN1bmssIHJlbW92ZSBsaXN0ZW5lciBmcm9tIHByZXZpb3VzIGd1ZXNzLCAtLT4gY29tcHV0ZXIgdHVybiBcclxuLWdlbmVyYXRlIHJhbmRvbSBndWVzcyB1bnRpbCB2YWxpZCBndWVzc1xyXG4tSHVtYW4ucmVjZWl2ZSBhdHRhY2tcclxuLVVwZGF0ZSBib2FyZCB3aXRoIGd1ZXNzIHJlc3VsdFxyXG4tQ2hlY2sgZm9yIGFsbCBzdW5rXHJcbi1pZiBhbGwgc3VuaywgcmVtb3ZlIGFsbCBsaXN0ZW5lcmVzLCByZXR1cm4sIGRpc3BsYXkgd2lubmVyXHJcbi1pZiBub3QgYWxsIHN1bmsgLS0+IGRvIG5vdGhpbmcuIFxyXG5cclxuKi9cclxuXHJcbi8qXHJcbnJlY2VpdmUgYXR0YWNrIFxyXG5maW5kIHJvdyBkaXYgYnkgYXR0cmlidXRlIC0tPiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKS5xdWVyeVNlbGVjdG9yQWxsKCdbeS1Db3JkPVwiMVwiXScpO1xyXG5maW5kIGJveCBkaXYgYnkgYXR0cmlidXRlXHJcblxyXG5pZihwbGF5ZXIuYm9hcmQuYm9hcmRbeUd1ZXNzIC0xXVt4R3Vlc3MgLTFdID09ICdtaXNzJylcclxue1xyXG4gIGFkZCBjbGFzcyBuYW1lIG1pc3NcclxufWVsc2V7XHJcbiAgYWRkIGNsYXNzIG5hbWUgaGl0XHJcbn1cclxuICBOZWVkIGZ1bmN0aW9ucyBmb3I6XHJcbiAgICAtUmVtb3ZpbmcgYWxsIGd1ZXNzIGxpc3RlbmVyc1xyXG4gICAgXHJcblxyXG5cclxuKi9cclxuXHJcbmV4cG9ydHMuY3JlYXRlU2hpcCA9IGNyZWF0ZVNoaXA7XHJcbmV4cG9ydHMuY3JlYXRlR2FtZUJvYXJkID0gY3JlYXRlR2FtZUJvYXJkO1xyXG5leHBvcnRzLmdhbWVMb29wID0gZ2FtZUxvb3A7XHJcblxyXG4vKlxyXG4yZCBBcnJheTpcclxuICB4LT4gICAwICAgICAgIDEgICAgICAgICAyICAgICAgICAgMyAgICAgICA0ICAgICAgIDUgICAgICAgNlxyXG4gICAgMCBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIDEgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICAyIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgMyBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIDQgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICA1IFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgNiBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIF5cclxuICAgIHlcclxuICAgIEVhY2ggbmV3IHN1Yi1hcnJheSBpcyBhIHkgaW5jcmVtZW50YXRpb25cclxuICAgIEVhY2ggaW5kZXggaW5zaWRlIG9mIHRoZSBzdWJhcnJheSBpcyBhIHgtIGluY3JlbWVudGF0aW9uXHJcbiAgICBCb2FyZCB3aWxsIGJlIHkgPSAwIGZyb20gdGhlIHRvcCB4ID0gMCBmcm9tIHRoZSBsZWZ0XHJcbiAgICBib2FyZFtyb3ddW2NvbHVtbl1cclxuKi9cclxuXHJcbi8qXHJcbiAgICBTaGlwczpcclxuICAgIENhcnJpZXItIDVcclxuICAgIEJhdHRsZXNoaXAgLSA0XHJcbiAgICBDcnVpc2VyIC0gM1xyXG4gICAgU3VibWFyaW5lIC0gM1xyXG4gICAgRGVzdHJveWVyIC0gMlxyXG5cclxuKi9cclxuXHJcbi8qXHJcblxyXG5Gb3IgY29tcHV0ZXIgZ3Vlc3Nlc3M6XHJcbmxldCB4R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxubGV0IHlHdWVzcyA9IE1hdGgucmFuZG9tKDcpO1xyXG53aGlsZSghcDEuYm9hcmQucmVjZWl2ZUF0dGFjayh5R3Vlc3MsIHhHdWVzcykpXHJcbntcclxuICB4R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxuICB5R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxufVxyXG5cclxuRm9yIGdhbWUgbG9vcFwiXHJcbmxldCB0dXJuQ291bnRlciA9IDE7XHJcbmxldCB3aW5uZXIgPSBudWxsO1xyXG53aGlsZSh3aW5uZXIgPT0gbnVsbClcclxue1xyXG4gIGlmKHR1cm5Db3VudGVyJTIgPT0gKVxyXG4gIHtcclxuICAgIGdldCBndWVzcyB2YWx1ZXNcclxuICAgIHdoaWxlKCFwMi5ib2FyZC5yZWNlaXZlQXR0YWNrKHZhbHVlcykpXHJcbiAgICB7XHJcbiAgICAgIHVwZGF0ZSBndWVzcyB2YWx1ZXNcclxuICAgIH1cclxuICAgIGNoZWNrIGZvciBhbGwgc3Vua1xyXG4gIH1lbHNle1xyXG5sZXQgeEd1ZXNzID0gTWF0aC5yYW5kb20oNyk7XHJcbmxldCB5R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxud2hpbGUoIXAxLmJvYXJkLnJlY2VpdmVBdHRhY2soeUd1ZXNzLCB4R3Vlc3MpKVxyXG57XHJcbiAgeEd1ZXNzID0gTWF0aC5yYW5kb20oNyk7XHJcbiAgeUd1ZXNzID0gTWF0aC5yYW5kb20oNyk7XHJcbn1cclxuY2hlY2sgZm9yIGFsbCBzdW5rXHJcbiAgfVxyXG4gIHR1cm5Db3VudGVyKys7XHJcbn1cclxuXHJcblxyXG5cclxuTmVlZCBhIHdheSB0byB3YWl0IGZvciBuZXcgdmFsdWVzIGlmIGd1ZXNzIGZyb20gdXNlciBpcyBpbnZhbGlkXHJcbk1heWJlIGFuIG9uY2xpY2sgbWV0aG9kIHRoYXQgc2VuZHMgdmFsdWVzXHJcbk5lZWQgYSB3YXkgdG8gZ2V0IHJldHVybiBmcm9tIGNoZWNrIGlmIGFsbCBhcmUgc3Vuaz8gTWF5YmUgcmVtb3ZlIGl0IGZyb20gcmVjZWl2ZVxyXG5hdHRhY2sgYW5kIGNhbGwgaXQgYWZ0ZXIgZXZlcnkgdHVybiBcclxuXHJcbiovXHJcblxyXG4vKlxyXG4tUmVuZGVyIGVtcHR5IGJvYXJkXHJcbi1OZWVkIGEgd2F5IHRvIHRyYWNrIHdoaWNoIHNxdWFyZSBpcyBnZXR0aW5nIGNsaWNrZWQgaW4gcmVsYXRpb24gdG8gdGhlIDJkIGFycmF5XHJcbi1SZW5kZXIgYm9hcmQgYWZ0ZXIgcGxhY2luZyBlYWNoIHNoaXAgdy9hIHNoaXAgbWFya2VyXHJcbi1VcGRhdGUgc3F1YXJlcyBhZnRlciBlYWNoIGd1ZXNzIG9uIGVhY2ggc2lkZS4gXHJcbi1NYXliZSB1c2UgZ2V0IHNvdXJjZSB0byBnZXQgMmQgYXJyYXkgY29vcmRpbmF0ZXNcclxuXHJcblxyXG4tRXhwb3J0IGNvbXB1dGVyIHBsYXllclxyXG4tRXhwb3J0IHR1cm4gY291bnRlciB0byB0cmFjayB3aGVuIGNvbXAgc2hvdWxkIG1ha2UgYSBtb3ZlIGFuZCB3aGVuIHRvIGNoZWNrIGZvclxyXG5hbGwgc3VuayBmb3Igd2hvc2UgYm9hcmRcclxuLSBFdmVudCBsaXN0ZW5lciBvbiByaWdodCBzaWRlIGJvYXJkIGZvciBjb21wLmJvYXJkLnJlY2VpdmVBdHRhY2tcclxuLSBFbXB0eSB3aGlsZSBsb29wIHdpdGggY29uZGl0aW9uIG9mIHR1cm5Db3VudCBtb2QgMiA9PSAwLCBhZGQgdHVybkNvdW50IGluY3JlbWVudFxyXG4tIHRvIGd1ZXNzIG9uIGNsaWNrIFxyXG5cclxuKi9cclxuXHJcbi8qXHJcbjYvMTMvMjIgV2hhdCdzIExlZnQgVG8gRG86XHJcbi1Nb2RhbHNcclxuLVN0eWxpbmdcclxuLVBsYXkgQWdhaW4gQnV0dG9ucyAtPiBvbiBtb2RhbCBhbmQgb24gc2NyZWVuXHJcbi1BZGQgcmFkaW8gZm9yIGhvcml6IHZlcnQgcGxhY2VtZW50XHJcbiovXHJcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInNoaXBzIiwibmFtZSIsImxlbmd0aCIsInBsYWNlZCIsInNoaXBJbmRleCIsImRpdiIsInBhcmVudERpdiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyb3dBcnIiLCJpIiwicm93IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInNldEF0dHJpYnV0ZSIsImJveCIsImlubmVyVGV4dCIsImFwcGVuZENoaWxkIiwiaiIsImNvbnNvbGUiLCJsb2ciLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiY2hpbGROb2RlcyIsInVzZXIiLCJyb3dzIiwiY3VyUm93IiwiY3VyWUNvcmQiLCJnZXRBdHRyaWJ1dGUiLCJjdXJCb3giLCJjdXJYQ29yZCIsImJvYXJkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uQWRkU2hpcENsaWNrIiwiZGlyZWN0aW9uIiwicXVlcnlTZWxlY3RvciIsInZhbHVlIiwiZXZlbnQiLCJ0YXJnZXQiLCJwYXJlbnROb2RlIiwicGxhY2VTaGlwIiwicGxheWVyIiwic2hpcCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZW1vdmVBZGRTaGlwcyIsInNoaXBzUGxhY2VkIiwicmVmcmVzaEJvYXJkIiwiZ3Vlc3NDbGljayIsInVzZXJZR3Vlc3MiLCJ1c2VyWEd1ZXNzIiwidXNlcllRdWVyeSIsInVzZXJYUXVlcnkiLCJ1c2VyQm94T2ZJbnRlcmVzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjb21wIiwicmVjZWl2ZUF0dGFjayIsImNoZWNrRm9yQWxsU3VuayIsImFsZXJ0IiwiY29tcFhHdWVzcyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNvbXBZR3Vlc3MiLCJjb21wWVF1ZXJ5IiwiY29tcFhRdWVyeSIsImNvbXBCb3hPZkludGVyZXN0IiwiY3JlYXRlU2hpcCIsInN0YXJ0aW5nQ29yZCIsImVuZGluZ0NvcmQiLCJoZWFsdGgiLCJzdW5rIiwicHVzaCIsInNoaXBQb2ludCIsImhpdFN0YXR1cyIsImNvb3JkaW5hdGVzIiwieENvcmQiLCJwYXJzZUludCIsInN0YXJ0aW5nWENvcmQiLCJ5Q29yZCIsInN0YXJ0aW5nWUNvcmQiLCJpc1N1bmsiLCJ0aGlzIiwiaGl0IiwiaGl0UG9pbnQiLCJjcmVhdGVHYW1lQm9hcmQiLCJnYW1lQm9hcmQiLCJzaGlwVG9QbGFjZSIsInN0YXJ0aW5nQ29sdW1uIiwic3RhcnRpbmdSb3ciLCJlbmRpbmdDb2x1bW4iLCJlbmRpbmdYQ29yZCIsImVuZGluZ1JvdyIsImVuZGluZ1lDb3JkIiwiY2hlY2tGb3JWYWxpZFBsYWNlbWVudCIsInBsYWNlT2JqIiwic3BvdCIsInNoaXBOYW1lIiwiZmlsdGVyIiwic2giLCJwb2ludEFyciIsInBvaW50IiwiY3JlYXRlUGxheWVyIiwidHlwZSIsIndhaXRGb3JTaGlwcyIsImRpcmVjdGlvbnMiLCJwbGFjZUNvbXB1dGVyU2hpcHMiLCJhZGRHdWVzc0NsaWNrIiwic2V0VGltZW91dCIsImdhbWVMb29wIiwiaHVtIiwid2lubmVyIiwic2hpcE5hbWVzIiwic2hpcExlbmd0aHMiXSwic291cmNlUm9vdCI6IiJ9
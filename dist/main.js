(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{pS:()=>c,IE:()=>p,EA:()=>m});let t=[{name:"Carrier",length:5,placed:!1},{name:"Battleship",length:4,placed:!1},{name:"Cruiser",length:3,placed:!1},{name:"Submarine",length:3,placed:!1},{name:"Destroyer",length:2,placed:!1}],o=0;function r(e,t){let o=document.getElementById(e),r=["A","B","C","D","E","F","G"];for(let e=0;e<8;e++){let t=document.createElement("div");if(t.className="row",t.setAttribute("Y-Cord",e-1),0==e){let e=document.createElement("div");e.className="box",e.innerText="Y/X ",t.appendChild(e)}for(let o=0;o<8;o++){let a=document.createElement("div");a.className="box",0==e?7!==o&&(a.innerText=r[o],a.innerText+="("+o+")"):0==o&&(a.innerText=e-1),7==o&&0==e||(a.setAttribute("X-Cord",o-1),t.appendChild(a))}o.appendChild(t)}console.log(o.getElementsByClassName("row")[1].childNodes[0])}function a(){console.log(m);let e=document.getElementById("player").getElementsByClassName("row");for(let t=1;t<e.length;t++){let o=e[t],r=o.getAttribute("y-cord");for(let e=1;e<o.childNodes.length;e++){let t=o.childNodes[e],a=t.getAttribute("x-cord");"empty"==m.board.board[r][a]&&t.addEventListener("click",n)}}}function n(){console.log(event.target),console.log(event.target.parentNode.getAttribute("y-cord")),console.log("xcord",event.target.getAttribute("x-cord")),1==m.board.placeShip("horizontal",t[o].name,t[o].length,event.target.parentNode.getAttribute("y-cord"),event.target.getAttribute("x-cord"))&&function(e,t,r){let l=document.getElementById(e).getElementsByClassName("row");console.log(l[1].childNodes);for(let e=1;e<l.length;e++){let o=l[e],r=o.getAttribute("y-cord");for(let e=1;e<o.childNodes.length;e++){let a=o.childNodes[e],n=a.getAttribute("x-cord");"empty"!==t.board.board[r][n]&&"miss"!==t.board.board[r][n]&&a.classList.add("ship")}}!function(){let e=document.getElementById("player").getElementsByClassName("row");for(let t=1;t<e.length;t++){let o=e[t];for(let e=1;e<o.childNodes.length;e++)o.childNodes[e].removeEventListener("click",n)}}(),o++,o<5&&a(),5==o&&(p=!0,console.log("here"))}("player",m)}function l(){let e=event.target.parentNode.getAttribute("y-cord"),t=event.target.getAttribute("x-cord"),o='[y-Cord="'+e+'"]',r='[x-Cord="'+t+'"]',a=document.getElementById("guess").querySelectorAll(o)[0].querySelectorAll(r)[0];if(c.board.receiveAttack(e,t),"miss"==c.board.board[e][t]?a.classList.add("miss"):"empty"!=c.board.board[e][t]&&a.classList.add("hit"),1==c.board.checkForAllSunk())return void alert("User has Won");let n=Math.floor(7*Math.random()),l=Math.floor(7*Math.random());for(;!m.board.receiveAttack(l,n);)n=Math.floor(7*Math.random()),l=Math.floor(7*Math.random());let d='[y-cord="'+l+'"]',i='[x-cord="'+n+'"]',s=document.getElementById("player").querySelectorAll(d)[0].querySelectorAll(i)[0];"miss"==m.board.board[l][n]?s.classList.add("miss"):"empty"!=c.board.board[e][t]&&s.classList.add("hit"),1!=m.board.checkForAllSunk()||alert("Comp has Won")}function d(e,t,o,r,a){var n={};if(n.name=e,n.length=o,n.startingCord=r,n.endingCord=a,n.health=[],n.sunk=!1,n.direction=t,"horizontal"==t)for(let e=0;e<=o;e++)n.health.push({shipPoint:e,hitStatus:"false",coordinates:{xCord:parseInt(r.startingXCord)+e,yCord:parseInt(r.startingYCord)}});else if("vertical"==t)for(let e=0;e<=o;e++)n.health.push({shipPoint:e,hitStatus:"false",coordinates:{xCord:r.startingXCord,yCord:parseInt(r.startingYCord)+e}});return n.isSunk=function(){for(let e=0;e<this.length;e++)if("false"==this.health[e].hitStatus)return!1;return this.sunk=!0,!0},n.hit=function(e){this.health[e].hitStatus="true"},n}function i(){var e={ships:[],board:[["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"]],checkForValidPlacement:function(e){let t=e.startingCord.startingXCord,o=e.startingCord.startingYCord,r=e.endingCord.endingXCord,a=e.endingCord.endingYCord;if(console.log(t,o,r,a),"vertical"==e.direction){if(6==o)return!1;if(a>6)return console.log(e.name,a),!1;for(let r=o;r<=a;r++)if(console.log(e.name,this.board[r][t]),"empty"!=this.board[r][t])return!1}else if("horizontal"==e.direction){if(6==t)return!1;if(r>6)return!1;for(let a=t;a<=r;a++)if(console.log(e.name,this.board[o][a]),"empty"!=this.board[o][a])return!1}return!0},placeShip:function(t,o,r,a,n){let l={},i={startingXCord:n,startingYCord:a};"horizontal"==t?(l.endingXCord=parseInt(n)+r-1,l.endingYCord=a):"vertical"==t&&(l.endingXCord=n,l.endingYCord=parseInt(a)+r-1);let s=d(o,t,r,i,l);if(0==this.checkForValidPlacement(s))return!1;if(e.ships.push(s),"horizontal"==t)for(let e=0;e<r;e++){let t={name:s.name,spot:s.health[e]};console.log(parseInt(n)+e),this.board[a][parseInt(n)+e]=t}else if("vertical"==t)for(let e=0;e<r;e++){let t={name:s.name,spot:s.health[e]};this.board[parseInt(a)+e][n]=t}return!0},receiveAttack:function(e,t){if("empty"!==this.board[e][t]&&"miss"!==this.board[e][t]){let o=this.board[e][t].name,r=this.ships.filter((e=>e.name==o))[0];console.log(r),console.log("Received X Cord",t),console.log("Received Y Cord",e);let a=r.health.filter((o=>o.coordinates.xCord==t&&o.coordinates.yCord==e));return console.log(o),console.log(a),r.hit(a[0].shipPoint),r.isSunk(),!0}return"empty"==this.board[e][t]?(this.board[e][t]="miss",!0):"miss"!=this.board[e][t]&&"true"!=this.board[e][t].spot.hitStatus},checkForAllSunk:function(){for(let e=0;e<this.ships.length;e++)if(0==this.ships[e].sunk)return!1;return!0}};return e}function s(e){let t={};return t.type=e,t.board=i(),t}let h=[{name:"Carrier",length:5,placed:!1},{name:"Battleship",length:4,placed:!1},{name:"Cruiser",length:3,placed:!1},{name:"Submarine",length:3,placed:!1},{name:"Destroyer",length:2,placed:!1}],m=s("human"),c=s("computer"),p=!1;r("player"),a(),r("guess"),function e(){1==p?(function(){let e=["horizontal","vertical"],t=Math.floor(7*Math.random()),o=Math.floor(7*Math.random()),r=Math.floor(2*Math.random());for(let a=0;a<h.length;a++){for(;!c.board.placeShip(e[r],h[a].name,h[a].length,o,t);)t=Math.floor(7*Math.random()),o=Math.floor(7*Math.random()),r=Math.floor(2*Math.random());console.log(h[a].name,"placed")}console.log(c.board.board)}(),function(){let e=document.getElementById("guess").getElementsByClassName("row");for(let t=1;t<e.length;t++){let o=e[t];o.getAttribute("y-cord");for(let e=1;e<o.childNodes.length;e++){let t=o.childNodes[e];t.getAttribute("x-cord"),t.addEventListener("click",l)}}}()):setTimeout(e,500)}(),exports.createShip=d,exports.createGameBoard=i,exports.gameLoop=function(){let e=s("human"),t=s("computer"),o=null,r=["Carrier","Battleship","Cruiser","Submarine","Destroyer"],a=[5,4,3,3,2],n=["horizontal","vertical"],l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random()),i=Math.floor(1*Math.random());for(let e=0;e<r.length;e++)for(;!t.board.placeShip(n[i],r[e],a[e],d,l);)l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());for(let t=0;t<r.length;t++)for(;!e.board.placeShip(n[i],r[t],a[t],d,l);)l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());for(;null==o;){for(l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());!t.board.receiveAttack(d,l);)l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());if(1==t.board.checkForAllSunk()&&(o="Human"),null==o){for(l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());!e.board.receiveAttack(d,l);)l=Math.floor(7*Math.random()),d=Math.floor(7*Math.random());1==e.board.checkForAllSunk()&&(o="Computer")}}return o}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVMsU0FHRyxNQUFWQSxFQUFnQixDQUdsQixJQUZBbkMsRUFBUWpCLEtBQUtDLE1BQXNCLEVBQWhCRCxLQUFLRSxVQUN4QmtCLEVBQVFwQixLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsV0FDaEJpRCxFQUFJN0UsTUFBTXNCLGNBQWN3QixFQUFPSCxJQUNyQ0EsRUFBUWpCLEtBQUtDLE1BQXNCLEVBQWhCRCxLQUFLRSxVQUN4QmtCLEVBQVFwQixLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsVUFFUyxHQUEvQmlELEVBQUk3RSxNQUFNdUIsb0JBQ1p1RCxFQUFTLGFBS2YsT0FBT0EsSSIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL2JvYXJkLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImltcG9ydCB7IHVzZXIsIGNvbXAsIHNoaXBzUGxhY2VkIH0gZnJvbSBcIi4uL2luZGV4LmpzXCI7XHJcblxyXG5sZXQgc2hpcHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJDYXJyaWVyXCIsXHJcbiAgICBsZW5ndGg6IDUsXHJcbiAgICBwbGFjZWQ6IGZhbHNlLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYXR0bGVzaGlwXCIsXHJcbiAgICBsZW5ndGg6IDQsXHJcbiAgICBwbGFjZWQ6IGZhbHNlLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJDcnVpc2VyXCIsXHJcbiAgICBsZW5ndGg6IDMsXHJcbiAgICBwbGFjZWQ6IGZhbHNlLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJTdWJtYXJpbmVcIixcclxuICAgIGxlbmd0aDogMyxcclxuICAgIHBsYWNlZDogZmFsc2UsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkRlc3Ryb3llclwiLFxyXG4gICAgbGVuZ3RoOiAyLFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG5dO1xyXG5sZXQgc2hpcEluZGV4ID0gMDtcclxuZnVuY3Rpb24gZW1wdHlSZW5kZXIoZGl2LCBwbGF5ZXIpIHtcclxuICBsZXQgcGFyZW50RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGl2KTtcclxuICBsZXQgcm93QXJyID0gW1wiQVwiLCBcIkJcIiwgXCJDXCIsIFwiRFwiLCBcIkVcIiwgXCJGXCIsIFwiR1wiXTtcclxuICAvL091dGVyIGxvb3AgaXMgcm93cywgaW5uZXIgbG9vcCBpcyBjb2x1bW5zXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHtcclxuICAgIGxldCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgcm93LmNsYXNzTmFtZSA9IFwicm93XCI7XHJcbiAgICByb3cuc2V0QXR0cmlidXRlKFwiWS1Db3JkXCIsIGkgLSAxKTtcclxuICAgIGlmIChpID09IDApIHtcclxuICAgICAgbGV0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgIGJveC5jbGFzc05hbWUgPSBcImJveFwiO1xyXG4gICAgICBib3guaW5uZXJUZXh0ID0gXCJZL1ggXCI7XHJcbiAgICAgIHJvdy5hcHBlbmRDaGlsZChib3gpO1xyXG4gICAgfVxyXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCA4OyBqKyspIHtcclxuICAgICAgbGV0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgIGJveC5jbGFzc05hbWUgPSBcImJveFwiO1xyXG4gICAgICBpZiAoaSA9PSAwKSB7XHJcbiAgICAgICAgaWYgKGogIT09IDcpIHtcclxuICAgICAgICAgIGJveC5pbm5lclRleHQgPSByb3dBcnJbal07XHJcbiAgICAgICAgICBib3guaW5uZXJUZXh0ICs9IFwiKFwiICsgaiArIFwiKVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChqID09IDApIHtcclxuICAgICAgICBib3guaW5uZXJUZXh0ID0gaSAtIDE7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChqID09IDcgJiYgaSA9PSAwKSB7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYm94LnNldEF0dHJpYnV0ZShcIlgtQ29yZFwiLCBqIC0gMSk7XHJcbiAgICAgICAgcm93LmFwcGVuZENoaWxkKGJveCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHBhcmVudERpdi5hcHBlbmRDaGlsZChyb3cpO1xyXG4gIH1cclxuICBjb25zb2xlLmxvZyhwYXJlbnREaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInJvd1wiKVsxXS5jaGlsZE5vZGVzWzBdKTtcclxufVxyXG5mdW5jdGlvbiBkZWxldGVCb2FyZChkaXYpIHtcclxuICBsZXQgcGFyZW50RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGl2KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlQWRkU2hpcHMoKSB7XHJcbiAgbGV0IHBhcmVudERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyXCIpO1xyXG4gIGxldCByb3dzID0gcGFyZW50RGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJyb3dcIik7XHJcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBsZXQgY3VyUm93ID0gcm93c1tpXTtcclxuICAgIGZvciAobGV0IGogPSAxOyBqIDwgY3VyUm93LmNoaWxkTm9kZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgbGV0IGN1ckJveCA9IGN1clJvdy5jaGlsZE5vZGVzW2pdO1xyXG4gICAgICBjdXJCb3gucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uQWRkU2hpcENsaWNrKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuZnVuY3Rpb24gcmVmcmVzaEJvYXJkKGRpdiwgcGxheWVyLCBzaGlwKSB7XHJcbiAgbGV0IHBhcmVudERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRpdik7XHJcbiAgbGV0IHJvd3MgPSBwYXJlbnREaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInJvd1wiKTtcclxuICBjb25zb2xlLmxvZyhyb3dzWzFdLmNoaWxkTm9kZXMpO1xyXG4gIGZvciAobGV0IGkgPSAxOyBpIDwgcm93cy5sZW5ndGg7IGkrKykge1xyXG4gICAgbGV0IGN1clJvdyA9IHJvd3NbaV07XHJcbiAgICBsZXQgY3VyWUNvcmQgPSBjdXJSb3cuZ2V0QXR0cmlidXRlKFwieS1jb3JkXCIpO1xyXG4gICAgZm9yIChsZXQgaiA9IDE7IGogPCBjdXJSb3cuY2hpbGROb2Rlcy5sZW5ndGg7IGorKykge1xyXG4gICAgICBsZXQgY3VyQm94ID0gY3VyUm93LmNoaWxkTm9kZXNbal07XHJcbiAgICAgIGxldCBjdXJYQ29yZCA9IGN1ckJveC5nZXRBdHRyaWJ1dGUoXCJ4LWNvcmRcIik7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBwbGF5ZXIuYm9hcmQuYm9hcmRbY3VyWUNvcmRdW2N1clhDb3JkXSAhPT0gXCJlbXB0eVwiICYmXHJcbiAgICAgICAgcGxheWVyLmJvYXJkLmJvYXJkW2N1cllDb3JkXVtjdXJYQ29yZF0gIT09IFwibWlzc1wiXHJcbiAgICAgICkge1xyXG4gICAgICAgIGN1ckJveC5jbGFzc0xpc3QuYWRkKFwic2hpcFwiKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICByZW1vdmVBZGRTaGlwcygpO1xyXG4gIHNoaXBJbmRleCsrO1xyXG4gIGlmIChzaGlwSW5kZXggPCA1KSB7XHJcbiAgICBwbGFjZVNoaXBMaXN0ZW5lcnMoKTtcclxuICB9XHJcbiAgaWYgKHNoaXBJbmRleCA9PSA1KSB7XHJcbiAgICBzaGlwc1BsYWNlZCA9IHRydWU7XHJcbiAgICBjb25zb2xlLmxvZyhcImhlcmVcIik7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBwbGFjZVNoaXBMaXN0ZW5lcnMoKSB7XHJcbiAgY29uc29sZS5sb2codXNlcik7XHJcbiAgbGV0IHBhcmVudERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyXCIpO1xyXG4gIGxldCByb3dzID0gcGFyZW50RGl2LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJyb3dcIik7XHJcbiAgLy9sZXQgZGlyZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RpcmVjdGlvbi1yYWRpbycpLnZhbHVlO1xyXG4gIGxldCBkaXJlY3Rpb24gPSBcImhvcml6b250YWxcIjtcclxuICAvL091dGVyIGl0ZXJhdGVzIHRocm91Z2ggcm93cywgaW5uZXIgdGhyb3VnaCBib3hlcyBpbiByb3dcclxuICBmb3IgKGxldCBpID0gMTsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHtcclxuICAgIGxldCBjdXJSb3cgPSByb3dzW2ldO1xyXG4gICAgbGV0IGN1cllDb3JkID0gY3VyUm93LmdldEF0dHJpYnV0ZShcInktY29yZFwiKTtcclxuICAgIGZvciAobGV0IGogPSAxOyBqIDwgY3VyUm93LmNoaWxkTm9kZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgbGV0IGN1ckJveCA9IGN1clJvdy5jaGlsZE5vZGVzW2pdO1xyXG4gICAgICBsZXQgY3VyWENvcmQgPSBjdXJCb3guZ2V0QXR0cmlidXRlKFwieC1jb3JkXCIpO1xyXG4gICAgICBpZiAodXNlci5ib2FyZC5ib2FyZFtjdXJZQ29yZF1bY3VyWENvcmRdID09IFwiZW1wdHlcIikge1xyXG4gICAgICAgIGN1ckJveC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25BZGRTaGlwQ2xpY2spO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBvbkFkZFNoaXBDbGljaygpIHtcclxuICBsZXQgZGlyZWN0aW9uID0gXCJob3Jpem9udGFsXCI7XHJcbiAgY29uc29sZS5sb2coZXZlbnQudGFyZ2V0KTtcclxuICBjb25zb2xlLmxvZyhldmVudC50YXJnZXQucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoXCJ5LWNvcmRcIikpO1xyXG4gIGNvbnNvbGUubG9nKFwieGNvcmRcIiwgZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZShcIngtY29yZFwiKSk7XHJcbiAgaWYgKFxyXG4gICAgdXNlci5ib2FyZC5wbGFjZVNoaXAoXHJcbiAgICAgIGRpcmVjdGlvbixcclxuICAgICAgc2hpcHNbc2hpcEluZGV4XS5uYW1lLFxyXG4gICAgICBzaGlwc1tzaGlwSW5kZXhdLmxlbmd0aCxcclxuICAgICAgZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKFwieS1jb3JkXCIpLFxyXG4gICAgICBldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKFwieC1jb3JkXCIpXHJcbiAgICApID09IHRydWVcclxuICApIHtcclxuICAgIHJlZnJlc2hCb2FyZChcInBsYXllclwiLCB1c2VyKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGd1ZXNzQ2xpY2soKSB7XHJcbiAgbGV0IHVzZXJZR3Vlc3MgPSBldmVudC50YXJnZXQucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoXCJ5LWNvcmRcIik7XHJcbiAgbGV0IHVzZXJYR3Vlc3MgPSBldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKFwieC1jb3JkXCIpO1xyXG4gIGxldCB1c2VyWVF1ZXJ5ID0gYFt5LUNvcmQ9XCJgICsgdXNlcllHdWVzcyArIGBcIl1gO1xyXG4gIGxldCB1c2VyWFF1ZXJ5ID0gYFt4LUNvcmQ9XCJgICsgdXNlclhHdWVzcyArIGBcIl1gO1xyXG4gIGxldCB1c2VyQm94T2ZJbnRlcmVzdCA9IGRvY3VtZW50XHJcbiAgICAuZ2V0RWxlbWVudEJ5SWQoXCJndWVzc1wiKVxyXG4gICAgLnF1ZXJ5U2VsZWN0b3JBbGwodXNlcllRdWVyeSlbMF1cclxuICAgIC5xdWVyeVNlbGVjdG9yQWxsKHVzZXJYUXVlcnkpWzBdO1xyXG5cclxuICBjb21wLmJvYXJkLnJlY2VpdmVBdHRhY2sodXNlcllHdWVzcywgdXNlclhHdWVzcyk7XHJcbiAgaWYgKGNvbXAuYm9hcmQuYm9hcmRbdXNlcllHdWVzc11bdXNlclhHdWVzc10gPT0gXCJtaXNzXCIpIHtcclxuICAgIHVzZXJCb3hPZkludGVyZXN0LmNsYXNzTGlzdC5hZGQoXCJtaXNzXCIpO1xyXG4gIH0gZWxzZSBpZiAoY29tcC5ib2FyZC5ib2FyZFt1c2VyWUd1ZXNzXVt1c2VyWEd1ZXNzXSAhPSBcImVtcHR5XCIpIHtcclxuICAgIHVzZXJCb3hPZkludGVyZXN0LmNsYXNzTGlzdC5hZGQoXCJoaXRcIik7XHJcbiAgfVxyXG4gIGlmIChjb21wLmJvYXJkLmNoZWNrRm9yQWxsU3VuaygpID09IHRydWUpIHtcclxuICAgIGFsZXJ0KFwiVXNlciBoYXMgV29uXCIpO1xyXG4gICAgLy9NZXRob2QgdG8gcmVtb3ZlIGFsbCBsaXN0ZW5lcnNcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGxldCBjb21wWEd1ZXNzID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgbGV0IGNvbXBZR3Vlc3MgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICB3aGlsZSAoIXVzZXIuYm9hcmQucmVjZWl2ZUF0dGFjayhjb21wWUd1ZXNzLCBjb21wWEd1ZXNzKSkge1xyXG4gICAgY29tcFhHdWVzcyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgY29tcFlHdWVzcyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIH1cclxuXHJcbiAgbGV0IGNvbXBZUXVlcnkgPSBgW3ktY29yZD1cImAgKyBjb21wWUd1ZXNzICsgYFwiXWA7XHJcbiAgbGV0IGNvbXBYUXVlcnkgPSBgW3gtY29yZD1cImAgKyBjb21wWEd1ZXNzICsgYFwiXWA7XHJcbiAgbGV0IGNvbXBCb3hPZkludGVyZXN0ID0gZG9jdW1lbnRcclxuICAgIC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKVxyXG4gICAgLnF1ZXJ5U2VsZWN0b3JBbGwoY29tcFlRdWVyeSlbMF1cclxuICAgIC5xdWVyeVNlbGVjdG9yQWxsKGNvbXBYUXVlcnkpWzBdO1xyXG5cclxuICBpZiAodXNlci5ib2FyZC5ib2FyZFtjb21wWUd1ZXNzXVtjb21wWEd1ZXNzXSA9PSBcIm1pc3NcIikge1xyXG4gICAgY29tcEJveE9mSW50ZXJlc3QuY2xhc3NMaXN0LmFkZChcIm1pc3NcIik7XHJcbiAgfSBlbHNlIGlmIChjb21wLmJvYXJkLmJvYXJkW3VzZXJZR3Vlc3NdW3VzZXJYR3Vlc3NdICE9IFwiZW1wdHlcIikge1xyXG4gICAgY29tcEJveE9mSW50ZXJlc3QuY2xhc3NMaXN0LmFkZChcImhpdFwiKTtcclxuICB9XHJcbiAgaWYgKHVzZXIuYm9hcmQuY2hlY2tGb3JBbGxTdW5rKCkgPT0gdHJ1ZSkge1xyXG4gICAgYWxlcnQoXCJDb21wIGhhcyBXb25cIik7XHJcbiAgICAvL01ldGhvZCB0byByZW1vdmUgYWxsIGxpc3RlbmVyc1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gYWRkR3Vlc3NDbGljaygpIHtcclxuICBsZXQgcGFyZW50RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJndWVzc1wiKTtcclxuICBsZXQgcm93cyA9IHBhcmVudERpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwicm93XCIpO1xyXG4gIC8vbGV0IGRpcmVjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXJlY3Rpb24tcmFkaW8nKS52YWx1ZTtcclxuICAvL091dGVyIGl0ZXJhdGVzIHRocm91Z2ggcm93cywgaW5uZXIgdGhyb3VnaCBib3hlcyBpbiByb3dcclxuICBmb3IgKGxldCBpID0gMTsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHtcclxuICAgIGxldCBjdXJSb3cgPSByb3dzW2ldO1xyXG4gICAgbGV0IGN1cllDb3JkID0gY3VyUm93LmdldEF0dHJpYnV0ZShcInktY29yZFwiKTtcclxuICAgIGZvciAobGV0IGogPSAxOyBqIDwgY3VyUm93LmNoaWxkTm9kZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgbGV0IGN1ckJveCA9IGN1clJvdy5jaGlsZE5vZGVzW2pdO1xyXG4gICAgICBsZXQgY3VyWENvcmQgPSBjdXJCb3guZ2V0QXR0cmlidXRlKFwieC1jb3JkXCIpO1xyXG4gICAgICBjdXJCb3guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGd1ZXNzQ2xpY2spO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHsgZW1wdHlSZW5kZXIsIHBsYWNlU2hpcExpc3RlbmVycywgYWRkR3Vlc3NDbGljayB9O1xyXG4iLCJpbXBvcnQge1xyXG4gIGVtcHR5UmVuZGVyLFxyXG4gIHBsYWNlU2hpcExpc3RlbmVycyxcclxuICBhZGRHdWVzc0NsaWNrLFxyXG59IGZyb20gXCIuL21vZHVsZXMvYm9hcmRcIjtcclxuZnVuY3Rpb24gY3JlYXRlU2hpcChuYW1lLCBkaXJlY3Rpb24sIGxlbmd0aCwgc3RhcnRpbmdDb3JkLCBlbmRpbmdDb3JkKSB7XHJcbiAgdmFyIHNoaXAgPSB7fTtcclxuICBzaGlwLm5hbWUgPSBuYW1lO1xyXG4gIHNoaXAubGVuZ3RoID0gbGVuZ3RoO1xyXG4gIHNoaXAuc3RhcnRpbmdDb3JkID0gc3RhcnRpbmdDb3JkO1xyXG4gIHNoaXAuZW5kaW5nQ29yZCA9IGVuZGluZ0NvcmQ7XHJcbiAgc2hpcC5oZWFsdGggPSBbXTtcclxuICBzaGlwLnN1bmsgPSBmYWxzZTtcclxuICBzaGlwLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjtcclxuXHJcbiAgaWYgKGRpcmVjdGlvbiA9PSBcImhvcml6b250YWxcIikge1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbGVuZ3RoOyBpKyspIHtcclxuICAgICAgc2hpcC5oZWFsdGgucHVzaCh7XHJcbiAgICAgICAgc2hpcFBvaW50OiBpLFxyXG4gICAgICAgIGhpdFN0YXR1czogXCJmYWxzZVwiLFxyXG4gICAgICAgIGNvb3JkaW5hdGVzOiB7XHJcbiAgICAgICAgICB4Q29yZDogcGFyc2VJbnQoc3RhcnRpbmdDb3JkLnN0YXJ0aW5nWENvcmQpICsgaSxcclxuICAgICAgICAgIHlDb3JkOiBwYXJzZUludChzdGFydGluZ0NvcmQuc3RhcnRpbmdZQ29yZCksXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gXCJ2ZXJ0aWNhbFwiKSB7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBsZW5ndGg7IGkrKykge1xyXG4gICAgICBzaGlwLmhlYWx0aC5wdXNoKHtcclxuICAgICAgICBzaGlwUG9pbnQ6IGksXHJcbiAgICAgICAgaGl0U3RhdHVzOiBcImZhbHNlXCIsXHJcbiAgICAgICAgY29vcmRpbmF0ZXM6IHtcclxuICAgICAgICAgIHhDb3JkOiBzdGFydGluZ0NvcmQuc3RhcnRpbmdYQ29yZCxcclxuICAgICAgICAgIHlDb3JkOiBwYXJzZUludChzdGFydGluZ0NvcmQuc3RhcnRpbmdZQ29yZCkgKyBpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2hpcC5pc1N1bmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgaWYgKHRoaXMuaGVhbHRoW2pdLmhpdFN0YXR1cyA9PSBcImZhbHNlXCIpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuc3VuayA9IHRydWU7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9O1xyXG5cclxuICBzaGlwLmhpdCA9IGZ1bmN0aW9uIChoaXRQb2ludCkge1xyXG4gICAgdGhpcy5oZWFsdGhbaGl0UG9pbnRdLmhpdFN0YXR1cyA9IFwidHJ1ZVwiO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiBzaGlwO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVHYW1lQm9hcmQoKSB7XHJcbiAgdmFyIGdhbWVCb2FyZCA9IHt9O1xyXG4gIGdhbWVCb2FyZC5zaGlwcyA9IFtdO1xyXG4gIGdhbWVCb2FyZC5ib2FyZCA9IFtcclxuICAgIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gIF07XHJcblxyXG4gIGdhbWVCb2FyZC5jaGVja0ZvclZhbGlkUGxhY2VtZW50ID0gZnVuY3Rpb24gKHNoaXBUb1BsYWNlKSB7XHJcbiAgICBsZXQgc3RhcnRpbmdDb2x1bW4gPSBzaGlwVG9QbGFjZS5zdGFydGluZ0NvcmQuc3RhcnRpbmdYQ29yZDtcclxuICAgIGxldCBzdGFydGluZ1JvdyA9IHNoaXBUb1BsYWNlLnN0YXJ0aW5nQ29yZC5zdGFydGluZ1lDb3JkO1xyXG4gICAgbGV0IGVuZGluZ0NvbHVtbiA9IHNoaXBUb1BsYWNlLmVuZGluZ0NvcmQuZW5kaW5nWENvcmQ7XHJcbiAgICBsZXQgZW5kaW5nUm93ID0gc2hpcFRvUGxhY2UuZW5kaW5nQ29yZC5lbmRpbmdZQ29yZDtcclxuICAgIGNvbnNvbGUubG9nKHN0YXJ0aW5nQ29sdW1uLCBzdGFydGluZ1JvdywgZW5kaW5nQ29sdW1uLCBlbmRpbmdSb3cpO1xyXG4gICAgaWYgKHNoaXBUb1BsYWNlLmRpcmVjdGlvbiA9PSBcInZlcnRpY2FsXCIpIHtcclxuICAgICAgaWYgKHN0YXJ0aW5nUm93ID09IDYpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGVuZGluZ1JvdyA+IDYpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhzaGlwVG9QbGFjZS5uYW1lLCBlbmRpbmdSb3cpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGxldCBpID0gc3RhcnRpbmdSb3c7IGkgPD0gZW5kaW5nUm93OyBpKyspIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhzaGlwVG9QbGFjZS5uYW1lLCB0aGlzLmJvYXJkW2ldW3N0YXJ0aW5nQ29sdW1uXSk7XHJcbiAgICAgICAgaWYgKHRoaXMuYm9hcmRbaV1bc3RhcnRpbmdDb2x1bW5dICE9IFwiZW1wdHlcIikge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChzaGlwVG9QbGFjZS5kaXJlY3Rpb24gPT0gXCJob3Jpem9udGFsXCIpIHtcclxuICAgICAgaWYgKHN0YXJ0aW5nQ29sdW1uID09IDYpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGVuZGluZ0NvbHVtbiA+IDYpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChsZXQgaiA9IHN0YXJ0aW5nQ29sdW1uOyBqIDw9IGVuZGluZ0NvbHVtbjsgaisrKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coc2hpcFRvUGxhY2UubmFtZSwgdGhpcy5ib2FyZFtzdGFydGluZ1Jvd11bal0pO1xyXG4gICAgICAgIGlmICh0aGlzLmJvYXJkW3N0YXJ0aW5nUm93XVtqXSAhPSBcImVtcHR5XCIpIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH07XHJcblxyXG4gIGdhbWVCb2FyZC5wbGFjZVNoaXAgPSBmdW5jdGlvbiAoZGlyZWN0aW9uLCBuYW1lLCBsZW5ndGgsIHlDb3JkLCB4Q29yZCkge1xyXG4gICAgbGV0IGVuZGluZ0NvcmQgPSB7fTtcclxuICAgIGxldCBzdGFydGluZ0NvcmQgPSB7IHN0YXJ0aW5nWENvcmQ6IHhDb3JkLCBzdGFydGluZ1lDb3JkOiB5Q29yZCB9O1xyXG5cclxuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJob3Jpem9udGFsXCIpIHtcclxuICAgICAgZW5kaW5nQ29yZC5lbmRpbmdYQ29yZCA9IHBhcnNlSW50KHhDb3JkKSArIGxlbmd0aCAtIDE7XHJcbiAgICAgIGVuZGluZ0NvcmQuZW5kaW5nWUNvcmQgPSB5Q29yZDtcclxuICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09IFwidmVydGljYWxcIikge1xyXG4gICAgICBlbmRpbmdDb3JkLmVuZGluZ1hDb3JkID0geENvcmQ7XHJcbiAgICAgIGVuZGluZ0NvcmQuZW5kaW5nWUNvcmQgPSBwYXJzZUludCh5Q29yZCkgKyBsZW5ndGggLSAxO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBzaGlwID0gY3JlYXRlU2hpcChuYW1lLCBkaXJlY3Rpb24sIGxlbmd0aCwgc3RhcnRpbmdDb3JkLCBlbmRpbmdDb3JkKTtcclxuICAgIGlmICh0aGlzLmNoZWNrRm9yVmFsaWRQbGFjZW1lbnQoc2hpcCkgPT0gZmFsc2UpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZ2FtZUJvYXJkLnNoaXBzLnB1c2goc2hpcCk7XHJcbiAgICAgIGlmIChkaXJlY3Rpb24gPT0gXCJob3Jpem9udGFsXCIpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICBsZXQgcGxhY2VPYmogPSB7XHJcbiAgICAgICAgICAgIG5hbWU6IHNoaXAubmFtZSxcclxuICAgICAgICAgICAgc3BvdDogc2hpcC5oZWFsdGhbaV0sXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgY29uc29sZS5sb2cocGFyc2VJbnQoeENvcmQpICsgaSk7XHJcbiAgICAgICAgICB0aGlzLmJvYXJkW3lDb3JkXVtwYXJzZUludCh4Q29yZCkgKyBpXSA9IHBsYWNlT2JqO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gXCJ2ZXJ0aWNhbFwiKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgbGV0IHBsYWNlT2JqID0ge1xyXG4gICAgICAgICAgICBuYW1lOiBzaGlwLm5hbWUsXHJcbiAgICAgICAgICAgIHNwb3Q6IHNoaXAuaGVhbHRoW2ldLFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIHRoaXMuYm9hcmRbcGFyc2VJbnQoeUNvcmQpICsgaV1beENvcmRdID0gcGxhY2VPYmo7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9O1xyXG5cclxuICBnYW1lQm9hcmQucmVjZWl2ZUF0dGFjayA9IGZ1bmN0aW9uICh5Q29yZCwgeENvcmQpIHtcclxuICAgIGlmIChcclxuICAgICAgdGhpcy5ib2FyZFt5Q29yZF1beENvcmRdICE9PSBcImVtcHR5XCIgJiZcclxuICAgICAgdGhpcy5ib2FyZFt5Q29yZF1beENvcmRdICE9PSBcIm1pc3NcIlxyXG4gICAgKSB7XHJcbiAgICAgIGxldCBzaGlwTmFtZSA9IHRoaXMuYm9hcmRbeUNvcmRdW3hDb3JkXS5uYW1lO1xyXG4gICAgICBsZXQgZmlsdGVyZWRBcnIgPSB0aGlzLnNoaXBzLmZpbHRlcigoc2gpID0+IHNoLm5hbWUgPT0gc2hpcE5hbWUpO1xyXG4gICAgICBsZXQgc2hpcCA9IGZpbHRlcmVkQXJyWzBdO1xyXG4gICAgICBjb25zb2xlLmxvZyhzaGlwKTtcclxuICAgICAgY29uc29sZS5sb2coXCJSZWNlaXZlZCBYIENvcmRcIiwgeENvcmQpO1xyXG4gICAgICBjb25zb2xlLmxvZyhcIlJlY2VpdmVkIFkgQ29yZFwiLCB5Q29yZCk7XHJcbiAgICAgIGxldCBwb2ludEFyciA9IHNoaXAuaGVhbHRoLmZpbHRlcihcclxuICAgICAgICAocG9pbnQpID0+XHJcbiAgICAgICAgICBwb2ludC5jb29yZGluYXRlcy54Q29yZCA9PSB4Q29yZCAmJiBwb2ludC5jb29yZGluYXRlcy55Q29yZCA9PSB5Q29yZFxyXG4gICAgICApO1xyXG4gICAgICBjb25zb2xlLmxvZyhzaGlwTmFtZSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKHBvaW50QXJyKTtcclxuICAgICAgc2hpcC5oaXQocG9pbnRBcnJbMF0uc2hpcFBvaW50KTtcclxuICAgICAgc2hpcC5pc1N1bmsoKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuYm9hcmRbeUNvcmRdW3hDb3JkXSA9PSBcImVtcHR5XCIpIHtcclxuICAgICAgdGhpcy5ib2FyZFt5Q29yZF1beENvcmRdID0gXCJtaXNzXCI7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBlbHNlIGlmIChcclxuICAgICAgdGhpcy5ib2FyZFt5Q29yZF1beENvcmRdID09IFwibWlzc1wiIHx8XHJcbiAgICAgIHRoaXMuYm9hcmRbeUNvcmRdW3hDb3JkXS5zcG90LmhpdFN0YXR1cyA9PSBcInRydWVcIlxyXG4gICAgKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH07XHJcblxyXG4gIGdhbWVCb2FyZC5jaGVja0ZvckFsbFN1bmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2hpcHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKHRoaXMuc2hpcHNbaV0uc3VuayA9PSBmYWxzZSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIGdhbWVCb2FyZDtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlUGxheWVyKHR5cGUpIHtcclxuICBsZXQgcGxheWVyID0ge307XHJcbiAgcGxheWVyLnR5cGUgPSB0eXBlO1xyXG4gIHBsYXllci5ib2FyZCA9IGNyZWF0ZUdhbWVCb2FyZCgpO1xyXG5cclxuICByZXR1cm4gcGxheWVyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnYW1lTG9vcCgpIHtcclxuICBsZXQgaHVtID0gY3JlYXRlUGxheWVyKFwiaHVtYW5cIik7XHJcbiAgbGV0IGNvbXAgPSBjcmVhdGVQbGF5ZXIoXCJjb21wdXRlclwiKTtcclxuICBsZXQgd2lubmVyID0gbnVsbDtcclxuICBsZXQgdHVybkNvdW50ZXIgPSAxO1xyXG4gIGxldCBzaGlwTmFtZXMgPSBbXHJcbiAgICBcIkNhcnJpZXJcIixcclxuICAgIFwiQmF0dGxlc2hpcFwiLFxyXG4gICAgXCJDcnVpc2VyXCIsXHJcbiAgICBcIlN1Ym1hcmluZVwiLFxyXG4gICAgXCJEZXN0cm95ZXJcIixcclxuICBdO1xyXG4gIGxldCBzaGlwTGVuZ3RocyA9IFs1LCA0LCAzLCAzLCAyXTtcclxuICBsZXQgZGlyZWN0aW9ucyA9IFtcImhvcml6b250YWxcIiwgXCJ2ZXJ0aWNhbFwiXTtcclxuICBsZXQgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICBsZXQgeUNvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICBsZXQgZGlyZWN0aW9uID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMSk7XHJcblxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcE5hbWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICB3aGlsZSAoXHJcbiAgICAgICFjb21wLmJvYXJkLnBsYWNlU2hpcChcclxuICAgICAgICBkaXJlY3Rpb25zW2RpcmVjdGlvbl0sXHJcbiAgICAgICAgc2hpcE5hbWVzW2ldLFxyXG4gICAgICAgIHNoaXBMZW5ndGhzW2ldLFxyXG4gICAgICAgIHlDb3JkLFxyXG4gICAgICAgIHhDb3JkXHJcbiAgICAgIClcclxuICAgICkge1xyXG4gICAgICB4Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgICB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgfVxyXG4gIH1cclxuICB4Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcblxyXG4gIGZvciAobGV0IGogPSAwOyBqIDwgc2hpcE5hbWVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICB3aGlsZSAoXHJcbiAgICAgICFodW0uYm9hcmQucGxhY2VTaGlwKFxyXG4gICAgICAgIGRpcmVjdGlvbnNbZGlyZWN0aW9uXSxcclxuICAgICAgICBzaGlwTmFtZXNbal0sXHJcbiAgICAgICAgc2hpcExlbmd0aHNbal0sXHJcbiAgICAgICAgeUNvcmQsXHJcbiAgICAgICAgeENvcmRcclxuICAgICAgKVxyXG4gICAgKSB7XHJcbiAgICAgIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICAgIHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICB3aGlsZSAod2lubmVyID09IG51bGwpIHtcclxuICAgIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgd2hpbGUgKCFjb21wLmJvYXJkLnJlY2VpdmVBdHRhY2soeUNvcmQsIHhDb3JkKSkge1xyXG4gICAgICB4Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgICB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgfVxyXG4gICAgaWYgKGNvbXAuYm9hcmQuY2hlY2tGb3JBbGxTdW5rKCkgPT0gdHJ1ZSkge1xyXG4gICAgICB3aW5uZXIgPSBcIkh1bWFuXCI7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHdpbm5lciA9PSBudWxsKSB7XHJcbiAgICAgIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICAgIHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICAgIHdoaWxlICghaHVtLmJvYXJkLnJlY2VpdmVBdHRhY2soeUNvcmQsIHhDb3JkKSkge1xyXG4gICAgICAgIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICAgICAgeUNvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoaHVtLmJvYXJkLmNoZWNrRm9yQWxsU3VuaygpID09IHRydWUpIHtcclxuICAgICAgICB3aW5uZXIgPSBcIkNvbXB1dGVyXCI7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiB3aW5uZXI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRlc3RSZW5kZXIoKSB7XHJcbiAgbGV0IHNoaXBOYW1lcyA9IFtcclxuICAgIFwiQ2FycmllclwiLFxyXG4gICAgXCJCYXR0bGVzaGlwXCIsXHJcbiAgICBcIkNydWlzZXJcIixcclxuICAgIFwiU3VibWFyaW5lXCIsXHJcbiAgICBcIkRlc3Ryb3llclwiLFxyXG4gIF07XHJcbiAgbGV0IHNoaXBMZW5ndGhzID0gWzUsIDQsIDMsIDMsIDJdO1xyXG4gIGxldCBkaXJlY3Rpb25zID0gW1wiaG9yaXpvbnRhbFwiLCBcInZlcnRpY2FsXCJdO1xyXG4gIGxldCB4Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIGxldCB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIGxldCBkaXJlY3Rpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcclxuICBsZXQgcGxheWVyID0gY3JlYXRlUGxheWVyKFwiaHVtYW5cIik7XHJcbiAgZm9yIChsZXQgaiA9IDA7IGogPCBzaGlwTmFtZXMubGVuZ3RoOyBqKyspIHtcclxuICAgIHdoaWxlIChcclxuICAgICAgIXBsYXllci5ib2FyZC5wbGFjZVNoaXAoXHJcbiAgICAgICAgZGlyZWN0aW9uc1tkaXJlY3Rpb25dLFxyXG4gICAgICAgIHNoaXBOYW1lc1tqXSxcclxuICAgICAgICBzaGlwTGVuZ3Roc1tqXSxcclxuICAgICAgICB5Q29yZCxcclxuICAgICAgICB4Q29yZFxyXG4gICAgICApXHJcbiAgICApIHtcclxuICAgICAgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgeUNvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgZGlyZWN0aW9uID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGxldCBwYXJlbnREaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKTtcclxuICBsZXQgcm93QXJyID0gW1wiQVwiLCBcIkJcIiwgXCJDXCIsIFwiRFwiLCBcIkVcIiwgXCJGXCIsIFwiR1wiXTtcclxuICAvL091dGVyIGxvb3AgaXMgcm93cywgaW5uZXIgbG9vcCBpcyBjb2x1bW5zXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHtcclxuICAgIGxldCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgcm93LmNsYXNzTmFtZSA9IFwicm93XCI7XHJcbiAgICByb3cuc2V0QXR0cmlidXRlKFwiWS1Db3JkXCIsIGkpO1xyXG4gICAgaWYgKGkgPT0gMCkge1xyXG4gICAgICBsZXQgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgYm94LmNsYXNzTmFtZSA9IFwiYm94XCI7XHJcbiAgICAgIGJveC5pbm5lclRleHQgPSBcIlkvWCBcIjtcclxuICAgICAgcm93LmFwcGVuZENoaWxkKGJveCk7XHJcbiAgICB9XHJcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IDg7IGorKykge1xyXG4gICAgICBsZXQgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgYm94LmNsYXNzTmFtZSA9IFwiYm94XCI7XHJcbiAgICAgIGJveC5zZXRBdHRyaWJ1dGUoXCJYLUNvcmRcIiwgaik7XHJcbiAgICAgIGlmIChpID09IDApIHtcclxuICAgICAgICBpZiAoaiAhPT0gNykge1xyXG4gICAgICAgICAgYm94LmlubmVyVGV4dCA9IHJvd0FycltqXTtcclxuICAgICAgICAgIGJveC5pbm5lclRleHQgKz0gXCIoXCIgKyBqICsgXCIpXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKGogPT0gMCkge1xyXG4gICAgICAgIGJveC5pbm5lclRleHQgPSBpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChwbGF5ZXIuYm9hcmQuYm9hcmRbaSAtIDFdW2ogLSAxXSA9PSBcImVtcHR5XCIpIHtcclxuICAgICAgICAgIGJveC5pbm5lclRleHQgPSBwbGF5ZXIuYm9hcmQuYm9hcmRbaSAtIDFdW2ogLSAxXTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgYm94LmlubmVyVGV4dCA9IHBsYXllci5ib2FyZC5ib2FyZFtpIC0gMV1baiAtIDFdLm5hbWU7XHJcbiAgICAgICAgICBib3guY2xhc3NMaXN0LmFkZChcInNoaXBcIik7XHJcbiAgICAgICAgICBib3guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGV0IHNoaXBOYW1lID0gcGxheWVyLmJvYXJkLmJvYXJkW2kgLSAxXVtqIC0gMV0ubmFtZTtcclxuICAgICAgICAgICAgbGV0IGZpbHRlcmVkQXJyID0gcGxheWVyLmJvYXJkLnNoaXBzLmZpbHRlcihcclxuICAgICAgICAgICAgICAoc2gpID0+IHNoLm5hbWUgPT0gc2hpcE5hbWVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgbGV0IHNoaXAgPSBmaWx0ZXJlZEFyclswXTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coc2hpcCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHBsYXllci5ib2FyZC5ib2FyZCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChqID09IDcgJiYgaSA9PSAwKSB7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcm93LmFwcGVuZENoaWxkKGJveCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHBhcmVudERpdi5hcHBlbmRDaGlsZChyb3cpO1xyXG4gIH1cclxufVxyXG5cclxuLy90ZXN0UmVuZGVyKCk7XHJcbi8vIGdhbWVMb29wKCk7XHJcbmxldCBzaGlwcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIkNhcnJpZXJcIixcclxuICAgIGxlbmd0aDogNSxcclxuICAgIHBsYWNlZDogZmFsc2UsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhdHRsZXNoaXBcIixcclxuICAgIGxlbmd0aDogNCxcclxuICAgIHBsYWNlZDogZmFsc2UsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkNydWlzZXJcIixcclxuICAgIGxlbmd0aDogMyxcclxuICAgIHBsYWNlZDogZmFsc2UsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlN1Ym1hcmluZVwiLFxyXG4gICAgbGVuZ3RoOiAzLFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiRGVzdHJveWVyXCIsXHJcbiAgICBsZW5ndGg6IDIsXHJcbiAgICBwbGFjZWQ6IGZhbHNlLFxyXG4gIH0sXHJcbl07XHJcbmxldCB1c2VyID0gY3JlYXRlUGxheWVyKFwiaHVtYW5cIik7XHJcbmxldCBjb21wID0gY3JlYXRlUGxheWVyKFwiY29tcHV0ZXJcIik7XHJcbmxldCB0dXJuQ291bnQgPSAwO1xyXG5sZXQgc2hpcHNQbGFjZWQgPSBmYWxzZTtcclxuZXhwb3J0IHsgdXNlciwgY29tcCwgdHVybkNvdW50LCBzaGlwc1BsYWNlZCB9O1xyXG5lbXB0eVJlbmRlcihcInBsYXllclwiLCB1c2VyKTtcclxucGxhY2VTaGlwTGlzdGVuZXJzKCk7XHJcbmVtcHR5UmVuZGVyKFwiZ3Vlc3NcIik7XHJcblxyXG5mdW5jdGlvbiB3YWl0Rm9yU2hpcHMoKSB7XHJcbiAgaWYgKHNoaXBzUGxhY2VkICE9IHRydWUpIHtcclxuICAgIHNldFRpbWVvdXQod2FpdEZvclNoaXBzLCA1MDApO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBwbGFjZUNvbXB1dGVyU2hpcHMoKTtcclxuICBhZGRHdWVzc0NsaWNrKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBsYWNlQ29tcHV0ZXJTaGlwcygpIHtcclxuICBsZXQgZGlyZWN0aW9ucyA9IFtcImhvcml6b250YWxcIiwgXCJ2ZXJ0aWNhbFwiXTtcclxuICBsZXQgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICBsZXQgeUNvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICBsZXQgZGlyZWN0aW9uID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMik7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwcy5sZW5ndGg7IGkrKykge1xyXG4gICAgd2hpbGUgKFxyXG4gICAgICAhY29tcC5ib2FyZC5wbGFjZVNoaXAoXHJcbiAgICAgICAgZGlyZWN0aW9uc1tkaXJlY3Rpb25dLFxyXG4gICAgICAgIHNoaXBzW2ldLm5hbWUsXHJcbiAgICAgICAgc2hpcHNbaV0ubGVuZ3RoLFxyXG4gICAgICAgIHlDb3JkLFxyXG4gICAgICAgIHhDb3JkXHJcbiAgICAgIClcclxuICAgICkge1xyXG4gICAgICB4Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgICB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgICBkaXJlY3Rpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcclxuICAgIH1cclxuICAgIGNvbnNvbGUubG9nKHNoaXBzW2ldLm5hbWUsIFwicGxhY2VkXCIpO1xyXG4gIH1cclxuICBjb25zb2xlLmxvZyhjb21wLmJvYXJkLmJvYXJkKTtcclxufVxyXG5cclxud2FpdEZvclNoaXBzKCk7XHJcbi8qXHJcbkFmdGVyIHdhaXQgZm9yIHNoaXBzLCBjYWxsIGZ1bmN0aW9uIHRoYXQgc2V0cyB1cCBjb21wdXRlciBwbGF5ZXJcclxuRG8gbm90aGluZyB1bnRpbCBvbiBjbGljayBmdW5jdGlvbiBpcyBjYWxsZWRcclxuT24gY2xpY2sgZnVuY3Rpb24gZm9yIGh1bWFuIGd1ZXNzZXM6XHJcbi1HZXQgY29vcmRpbmF0ZXNcclxuLUNvbXAucmVjZWl2ZSBhdHRhY2tcclxuLVVwZGF0ZSBndWVzcyBzcXVhcmUgd2l0aCBjbGFzcyBmb3IgaGl0IG9yIG1pc3NcclxuLUNoZWNrIGZvciBhbGwgc3Vua1xyXG4tIGlmIGFsbCBzdW5rLCByZW1vdmUgYWxsIGxpc3RlbmVycywgcmV0dXJuLCBhbmQgZGlzcGxheSB3aW5uZXJcclxuLWlmIG5vdCBhbGwgc3VuaywgcmVtb3ZlIGxpc3RlbmVyIGZyb20gcHJldmlvdXMgZ3Vlc3MsIC0tPiBjb21wdXRlciB0dXJuIFxyXG4tZ2VuZXJhdGUgcmFuZG9tIGd1ZXNzIHVudGlsIHZhbGlkIGd1ZXNzXHJcbi1IdW1hbi5yZWNlaXZlIGF0dGFja1xyXG4tVXBkYXRlIGJvYXJkIHdpdGggZ3Vlc3MgcmVzdWx0XHJcbi1DaGVjayBmb3IgYWxsIHN1bmtcclxuLWlmIGFsbCBzdW5rLCByZW1vdmUgYWxsIGxpc3RlbmVyZXMsIHJldHVybiwgZGlzcGxheSB3aW5uZXJcclxuLWlmIG5vdCBhbGwgc3VuayAtLT4gZG8gbm90aGluZy4gXHJcblxyXG4qL1xyXG5cclxuLypcclxucmVjZWl2ZSBhdHRhY2sgXHJcbmZpbmQgcm93IGRpdiBieSBhdHRyaWJ1dGUgLS0+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyXCIpLnF1ZXJ5U2VsZWN0b3JBbGwoJ1t5LUNvcmQ9XCIxXCJdJyk7XHJcbmZpbmQgYm94IGRpdiBieSBhdHRyaWJ1dGVcclxuXHJcbmlmKHBsYXllci5ib2FyZC5ib2FyZFt5R3Vlc3MgLTFdW3hHdWVzcyAtMV0gPT0gJ21pc3MnKVxyXG57XHJcbiAgYWRkIGNsYXNzIG5hbWUgbWlzc1xyXG59ZWxzZXtcclxuICBhZGQgY2xhc3MgbmFtZSBoaXRcclxufVxyXG4gIE5lZWQgZnVuY3Rpb25zIGZvcjpcclxuICAgIC1SZW1vdmluZyBhbGwgZ3Vlc3MgbGlzdGVuZXJzXHJcbiAgICBcclxuXHJcblxyXG4qL1xyXG5cclxuZXhwb3J0cy5jcmVhdGVTaGlwID0gY3JlYXRlU2hpcDtcclxuZXhwb3J0cy5jcmVhdGVHYW1lQm9hcmQgPSBjcmVhdGVHYW1lQm9hcmQ7XHJcbmV4cG9ydHMuZ2FtZUxvb3AgPSBnYW1lTG9vcDtcclxuXHJcbi8qXHJcbjJkIEFycmF5OlxyXG4gIHgtPiAgIDAgICAgICAgMSAgICAgICAgIDIgICAgICAgICAzICAgICAgIDQgICAgICAgNSAgICAgICA2XHJcbiAgICAwIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgMSBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIDIgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICAzIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgNCBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIDUgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICA2IFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgXlxyXG4gICAgeVxyXG4gICAgRWFjaCBuZXcgc3ViLWFycmF5IGlzIGEgeSBpbmNyZW1lbnRhdGlvblxyXG4gICAgRWFjaCBpbmRleCBpbnNpZGUgb2YgdGhlIHN1YmFycmF5IGlzIGEgeC0gaW5jcmVtZW50YXRpb25cclxuICAgIEJvYXJkIHdpbGwgYmUgeSA9IDAgZnJvbSB0aGUgdG9wIHggPSAwIGZyb20gdGhlIGxlZnRcclxuICAgIGJvYXJkW3Jvd11bY29sdW1uXVxyXG4qL1xyXG5cclxuLypcclxuICAgIFNoaXBzOlxyXG4gICAgQ2Fycmllci0gNVxyXG4gICAgQmF0dGxlc2hpcCAtIDRcclxuICAgIENydWlzZXIgLSAzXHJcbiAgICBTdWJtYXJpbmUgLSAzXHJcbiAgICBEZXN0cm95ZXIgLSAyXHJcblxyXG4qL1xyXG5cclxuLypcclxuXHJcbkZvciBjb21wdXRlciBndWVzc2VzczpcclxubGV0IHhHdWVzcyA9IE1hdGgucmFuZG9tKDcpO1xyXG5sZXQgeUd1ZXNzID0gTWF0aC5yYW5kb20oNyk7XHJcbndoaWxlKCFwMS5ib2FyZC5yZWNlaXZlQXR0YWNrKHlHdWVzcywgeEd1ZXNzKSlcclxue1xyXG4gIHhHdWVzcyA9IE1hdGgucmFuZG9tKDcpO1xyXG4gIHlHdWVzcyA9IE1hdGgucmFuZG9tKDcpO1xyXG59XHJcblxyXG5Gb3IgZ2FtZSBsb29wXCJcclxubGV0IHR1cm5Db3VudGVyID0gMTtcclxubGV0IHdpbm5lciA9IG51bGw7XHJcbndoaWxlKHdpbm5lciA9PSBudWxsKVxyXG57XHJcbiAgaWYodHVybkNvdW50ZXIlMiA9PSApXHJcbiAge1xyXG4gICAgZ2V0IGd1ZXNzIHZhbHVlc1xyXG4gICAgd2hpbGUoIXAyLmJvYXJkLnJlY2VpdmVBdHRhY2sodmFsdWVzKSlcclxuICAgIHtcclxuICAgICAgdXBkYXRlIGd1ZXNzIHZhbHVlc1xyXG4gICAgfVxyXG4gICAgY2hlY2sgZm9yIGFsbCBzdW5rXHJcbiAgfWVsc2V7XHJcbmxldCB4R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxubGV0IHlHdWVzcyA9IE1hdGgucmFuZG9tKDcpO1xyXG53aGlsZSghcDEuYm9hcmQucmVjZWl2ZUF0dGFjayh5R3Vlc3MsIHhHdWVzcykpXHJcbntcclxuICB4R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxuICB5R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxufVxyXG5jaGVjayBmb3IgYWxsIHN1bmtcclxuICB9XHJcbiAgdHVybkNvdW50ZXIrKztcclxufVxyXG5cclxuXHJcblxyXG5OZWVkIGEgd2F5IHRvIHdhaXQgZm9yIG5ldyB2YWx1ZXMgaWYgZ3Vlc3MgZnJvbSB1c2VyIGlzIGludmFsaWRcclxuTWF5YmUgYW4gb25jbGljayBtZXRob2QgdGhhdCBzZW5kcyB2YWx1ZXNcclxuTmVlZCBhIHdheSB0byBnZXQgcmV0dXJuIGZyb20gY2hlY2sgaWYgYWxsIGFyZSBzdW5rPyBNYXliZSByZW1vdmUgaXQgZnJvbSByZWNlaXZlXHJcbmF0dGFjayBhbmQgY2FsbCBpdCBhZnRlciBldmVyeSB0dXJuIFxyXG5cclxuKi9cclxuXHJcbi8qXHJcbi1SZW5kZXIgZW1wdHkgYm9hcmRcclxuLU5lZWQgYSB3YXkgdG8gdHJhY2sgd2hpY2ggc3F1YXJlIGlzIGdldHRpbmcgY2xpY2tlZCBpbiByZWxhdGlvbiB0byB0aGUgMmQgYXJyYXlcclxuLVJlbmRlciBib2FyZCBhZnRlciBwbGFjaW5nIGVhY2ggc2hpcCB3L2Egc2hpcCBtYXJrZXJcclxuLVVwZGF0ZSBzcXVhcmVzIGFmdGVyIGVhY2ggZ3Vlc3Mgb24gZWFjaCBzaWRlLiBcclxuLU1heWJlIHVzZSBnZXQgc291cmNlIHRvIGdldCAyZCBhcnJheSBjb29yZGluYXRlc1xyXG5cclxuXHJcbi1FeHBvcnQgY29tcHV0ZXIgcGxheWVyXHJcbi1FeHBvcnQgdHVybiBjb3VudGVyIHRvIHRyYWNrIHdoZW4gY29tcCBzaG91bGQgbWFrZSBhIG1vdmUgYW5kIHdoZW4gdG8gY2hlY2sgZm9yXHJcbmFsbCBzdW5rIGZvciB3aG9zZSBib2FyZFxyXG4tIEV2ZW50IGxpc3RlbmVyIG9uIHJpZ2h0IHNpZGUgYm9hcmQgZm9yIGNvbXAuYm9hcmQucmVjZWl2ZUF0dGFja1xyXG4tIEVtcHR5IHdoaWxlIGxvb3Agd2l0aCBjb25kaXRpb24gb2YgdHVybkNvdW50IG1vZCAyID09IDAsIGFkZCB0dXJuQ291bnQgaW5jcmVtZW50XHJcbi0gdG8gZ3Vlc3Mgb24gY2xpY2sgXHJcblxyXG4qL1xyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImV4cG9ydHMiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJzaGlwcyIsIm5hbWUiLCJsZW5ndGgiLCJwbGFjZWQiLCJzaGlwSW5kZXgiLCJlbXB0eVJlbmRlciIsImRpdiIsInBsYXllciIsInBhcmVudERpdiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyb3dBcnIiLCJpIiwicm93IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInNldEF0dHJpYnV0ZSIsImJveCIsImlubmVyVGV4dCIsImFwcGVuZENoaWxkIiwiaiIsImNvbnNvbGUiLCJsb2ciLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiY2hpbGROb2RlcyIsInBsYWNlU2hpcExpc3RlbmVycyIsInVzZXIiLCJyb3dzIiwiY3VyUm93IiwiY3VyWUNvcmQiLCJnZXRBdHRyaWJ1dGUiLCJjdXJCb3giLCJjdXJYQ29yZCIsImJvYXJkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uQWRkU2hpcENsaWNrIiwiZXZlbnQiLCJ0YXJnZXQiLCJwYXJlbnROb2RlIiwicGxhY2VTaGlwIiwic2hpcCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZW1vdmVBZGRTaGlwcyIsInNoaXBzUGxhY2VkIiwicmVmcmVzaEJvYXJkIiwiZ3Vlc3NDbGljayIsInVzZXJZR3Vlc3MiLCJ1c2VyWEd1ZXNzIiwidXNlcllRdWVyeSIsInVzZXJYUXVlcnkiLCJ1c2VyQm94T2ZJbnRlcmVzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjb21wIiwicmVjZWl2ZUF0dGFjayIsImNoZWNrRm9yQWxsU3VuayIsImFsZXJ0IiwiY29tcFhHdWVzcyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNvbXBZR3Vlc3MiLCJjb21wWVF1ZXJ5IiwiY29tcFhRdWVyeSIsImNvbXBCb3hPZkludGVyZXN0IiwiY3JlYXRlU2hpcCIsImRpcmVjdGlvbiIsInN0YXJ0aW5nQ29yZCIsImVuZGluZ0NvcmQiLCJoZWFsdGgiLCJzdW5rIiwicHVzaCIsInNoaXBQb2ludCIsImhpdFN0YXR1cyIsImNvb3JkaW5hdGVzIiwieENvcmQiLCJwYXJzZUludCIsInN0YXJ0aW5nWENvcmQiLCJ5Q29yZCIsInN0YXJ0aW5nWUNvcmQiLCJpc1N1bmsiLCJ0aGlzIiwiaGl0IiwiaGl0UG9pbnQiLCJjcmVhdGVHYW1lQm9hcmQiLCJnYW1lQm9hcmQiLCJzaGlwVG9QbGFjZSIsInN0YXJ0aW5nQ29sdW1uIiwic3RhcnRpbmdSb3ciLCJlbmRpbmdDb2x1bW4iLCJlbmRpbmdYQ29yZCIsImVuZGluZ1JvdyIsImVuZGluZ1lDb3JkIiwiY2hlY2tGb3JWYWxpZFBsYWNlbWVudCIsInBsYWNlT2JqIiwic3BvdCIsInNoaXBOYW1lIiwiZmlsdGVyIiwic2giLCJwb2ludEFyciIsInBvaW50IiwiY3JlYXRlUGxheWVyIiwidHlwZSIsIndhaXRGb3JTaGlwcyIsImRpcmVjdGlvbnMiLCJwbGFjZUNvbXB1dGVyU2hpcHMiLCJhZGRHdWVzc0NsaWNrIiwic2V0VGltZW91dCIsImdhbWVMb29wIiwiaHVtIiwid2lubmVyIiwic2hpcE5hbWVzIiwic2hpcExlbmd0aHMiXSwic291cmNlUm9vdCI6IiJ9
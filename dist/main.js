(()=>{"use strict";var t={d:(e,r)=>{for(var o in r)t.o(r,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{IE:()=>s,EA:()=>h});let e=[{name:"Carrier",length:5,placed:!1},{name:"Battleship",length:4,placed:!1},{name:"Cruiser",length:3,placed:!1},{name:"Submarine",length:3,placed:!1},{name:"Destroyer",length:2,placed:!1}],r=0;function o(t,e){let r=document.getElementById(t),o=["A","B","C","D","E","F","G"];for(let t=0;t<8;t++){let e=document.createElement("div");if(e.className="row",e.setAttribute("Y-Cord",t),0==t){let t=document.createElement("div");t.className="box",t.innerText="Y/X ",e.appendChild(t)}for(let r=0;r<8;r++){let n=document.createElement("div");n.className="box",n.setAttribute("X-Cord",r),0==t?7!==r&&(n.innerText=o[r],n.innerText+="("+r+")"):0==r&&(n.innerText=t),7==r&&0==t||e.appendChild(n)}r.appendChild(e)}console.log(r.getElementsByClassName("row")[1].childNodes[0])}function n(){console.log(h);let t=document.getElementById("player").getElementsByClassName("row");for(let e=1;e<t.length;e++){let r=t[e],o=r.getAttribute("y-cord");for(let t=1;t<r.childNodes.length;t++){let e=r.childNodes[t],n=e.getAttribute("x-cord");"empty"==h.board.board[o-1][n-1]&&e.addEventListener("click",a)}}}function a(){console.log(event.target),1==h.board.placeShip("horizontal",e[r].name,e[r].length,event.target.parentNode.getAttribute("y-cord")-1,event.target.getAttribute("x-cord")-1)&&function(t,e,o){let l=document.getElementById(t).getElementsByClassName("row");for(let t=1;t<l.length;t++){let r=l[t],o=r.getAttribute("y-cord");for(let t=1;t<r.childNodes.length;t++){let n=r.childNodes[t],a=n.getAttribute("x-cord");"empty"!==e.board.board[o-1][a-1]&&"miss"!==e.board.board[o-1][a-1]&&n.classList.add("ship")}}!function(){let t=document.getElementById("player").getElementsByClassName("row");for(let e=1;e<t.length;e++){let r=t[e];for(let t=1;t<r.childNodes.length;t++)r.childNodes[t].removeEventListener("click",a)}}(),r++,r<5&&n(),5==r&&(s=!0)}("player",h)}function l(t,e,r,o,n){var a={};if(a.name=t,a.length=r,a.startingCord=o,a.endingCord=n,a.health=[],a.sunk=!1,a.direction=e,"horizontal"==e)for(let t=1;t<=r;t++)a.health.push({shipPoint:t,hitStatus:"false",coordinates:{xCord:o.startingXCord+t,yCord:o.startingYCord}});else if("vertical"==e)for(let t=1;t<=r;t++)a.health.push({shipPoint:t,hitStatus:"false",coordinates:{xCord:o.startingXCord,yCord:o.startingYCord+t}});return a.isSunk=function(){for(let t=0;t<this.length;t++)if("false"===this.health[t].hitStatus)return!1;return this.sunk=!0,!0},a.hit=function(t){this.health[t].hitStatus="true"},a}function i(){var t={ships:[],board:[["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"],["empty","empty","empty","empty","empty","empty","empty"]],checkForValidPlacement:function(t){let e=t.startingCord.startingXCord,r=t.startingCord.startingYCord,o=t.endingCord.endingXCord,n=t.endingCord.endingYCord;if("vertical"==t.direction){if(6==r)return!1;if(n>6)return console.log(t.name,n),!1;for(let o=r;o<=n;o++)if(console.log(t.name,this.board[o][e]),"empty"!=this.board[o][e])return!1}else if("horizontal"==t.direction){if(6==e)return!1;if(o>6)return!1;for(let n=e;n<=o;n++)if(console.log(t.name,this.board[r][n]),"empty"!=this.board[r][n])return!1}return!0},placeShip:function(e,r,o,n,a){let i={},d={startingXCord:a,startingYCord:n};"horizontal"==e?(i.endingXCord=a+o-1,i.endingYCord=n):"vertical"==e&&(i.endingXCord=a,i.endingYCord=n+o-1);let h=l(r,e,o,d,i);if(0==this.checkForValidPlacement(h))return!1;if(t.ships.push(h),"horizontal"==e)for(let t=0;t<o;t++){let e={name:h.name,spot:h.health[t]};this.board[n][a+t]=e}else if("vertical"==e)for(let t=0;t<o;t++){let e={name:h.name,spot:h.health[t]};this.board[n+t][a]=e}return!0},receiveAttack:function(t,e){if("empty"!==this.board[t][e]&&"miss"!==this.board[t][e]){let r=this.board[t][e].name,o=this.ships.filter((t=>t.name==r))[0],n=o.health.filter((r=>r.coordinates.xCord===e&&r.coordinates.yCord===t));return o.hit(n[0].shipPoint),o.isSunk(),!0}return"empty"==this.board[t][e]?(this.board[t][e]="miss",!0):"miss"!=this.board[t][e]&&"true"!=this.board[t][e].spot.hitStatus},checkForAllSunk:function(){for(let t=0;t<this.ships.length;t++)if(0==this.ships[t].sunk)return!1;return!0}};return t}function d(t){let e={};return e.type=t,e.board=i(),e}let h=d("human"),s=(d("computer"),!1);o("player"),n(),o("guess"),exports.createShip=l,exports.createGameBoard=i,exports.gameLoop=function(){let t=d("human"),e=d("computer"),r=null,o=["Carrier","Battleship","Cruiser","Submarine","Destroyer"],n=[5,4,3,3,2],a=["horizontal","vertical"],l=Math.floor(7*Math.random()),i=Math.floor(7*Math.random()),h=Math.floor(1*Math.random());for(let t=0;t<o.length;t++)for(;!e.board.placeShip(a[h],o[t],n[t],i,l);)l=Math.floor(7*Math.random()),i=Math.floor(7*Math.random());l=Math.floor(7*Math.random()),i=Math.floor(7*Math.random());for(let e=0;e<o.length;e++)for(;!t.board.placeShip(a[h],o[e],n[e],i,l);)l=Math.floor(7*Math.random()),i=Math.floor(7*Math.random());for(;null==r;){for(l=Math.floor(7*Math.random()),i=Math.floor(7*Math.random());!e.board.receiveAttack(i,l);)l=Math.floor(7*Math.random()),i=Math.floor(7*Math.random());if(1==e.board.checkForAllSunk()&&(r="Human"),null==r){for(l=Math.floor(7*Math.random()),i=Math.floor(7*Math.random());!t.board.receiveAttack(i,l);)l=Math.floor(7*Math.random()),i=Math.floor(7*Math.random());1==t.board.checkForAllSunk()&&(r="Computer")}}return r}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQ0EsSUFBSUEsRUFBc0IsQ0NBMUJBLEVBQXdCLENBQUNDLEVBQVNDLEtBQ2pDLElBQUksSUFBSUMsS0FBT0QsRUFDWEYsRUFBb0JJLEVBQUVGLEVBQVlDLEtBQVNILEVBQW9CSSxFQUFFSCxFQUFTRSxJQUM1RUUsT0FBT0MsZUFBZUwsRUFBU0UsRUFBSyxDQUFFSSxZQUFZLEVBQU1DLElBQUtOLEVBQVdDLE1DSjNFSCxFQUF3QixDQUFDUyxFQUFLQyxJQUFVTCxPQUFPTSxVQUFVQyxlQUFlQyxLQUFLSixFQUFLQyxJLDRCQ0VsRixJQUFJSSxFQUFRLENBQ1YsQ0FDRUMsS0FBTSxVQUNOQyxPQUFRLEVBQ1JDLFFBQVEsR0FFVixDQUNFRixLQUFNLGFBQ05DLE9BQVEsRUFDUkMsUUFBUSxHQUVWLENBQ0VGLEtBQU0sVUFDTkMsT0FBUSxFQUNSQyxRQUFRLEdBRVYsQ0FDRUYsS0FBTSxZQUNOQyxPQUFRLEVBQ1JDLFFBQVEsR0FFVixDQUNFRixLQUFNLFlBQ05DLE9BQVEsRUFDUkMsUUFBUSxJQUdSQyxFQUFZLEVBQ2hCLFNBQVNDLEVBQVlDLEVBQUtDLEdBQ3hCLElBQUlDLEVBQVlDLFNBQVNDLGVBQWVKLEdBQ3BDSyxFQUFTLENBQUMsSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssS0FFNUMsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUksRUFBR0EsSUFBSyxDQUMxQixJQUFJQyxFQUFNSixTQUFTSyxjQUFjLE9BR2pDLEdBRkFELEVBQUlFLFVBQVksTUFDaEJGLEVBQUlHLGFBQWEsU0FBVUosR0FDbEIsR0FBTEEsRUFBUSxDQUNWLElBQUlLLEVBQU1SLFNBQVNLLGNBQWMsT0FDakNHLEVBQUlGLFVBQVksTUFDaEJFLEVBQUlDLFVBQVksT0FDaEJMLEVBQUlNLFlBQVlGLEdBRWxCLElBQUssSUFBSUcsRUFBSSxFQUFHQSxFQUFJLEVBQUdBLElBQUssQ0FDMUIsSUFBSUgsRUFBTVIsU0FBU0ssY0FBYyxPQUNqQ0csRUFBSUYsVUFBWSxNQUNoQkUsRUFBSUQsYUFBYSxTQUFVSSxHQUNsQixHQUFMUixFQUNRLElBQU5RLElBQ0ZILEVBQUlDLFVBQVlQLEVBQU9TLEdBQ3ZCSCxFQUFJQyxXQUFhLElBQU1FLEVBQUksS0FFZixHQUFMQSxJQUNUSCxFQUFJQyxVQUFZTixHQUdULEdBQUxRLEdBQWUsR0FBTFIsR0FFWkMsRUFBSU0sWUFBWUYsR0FHcEJULEVBQVVXLFlBQVlOLEdBRXhCUSxRQUFRQyxJQUFJZCxFQUFVZSx1QkFBdUIsT0FBTyxHQUFHQyxXQUFXLElBNENwRSxTQUFTQyxJQUNQSixRQUFRQyxJQUFJSSxHQUNaLElBQ0lDLEVBRFlsQixTQUFTQyxlQUFlLFVBQ25CYSx1QkFBdUIsT0FJNUMsSUFBSyxJQUFJWCxFQUFJLEVBQUdBLEVBQUllLEVBQUt6QixPQUFRVSxJQUFLLENBQ3BDLElBQUlnQixFQUFTRCxFQUFLZixHQUNkaUIsRUFBV0QsRUFBT0UsYUFBYSxVQUNuQyxJQUFLLElBQUlWLEVBQUksRUFBR0EsRUFBSVEsRUFBT0osV0FBV3RCLE9BQVFrQixJQUFLLENBQ2pELElBQUlXLEVBQVNILEVBQU9KLFdBQVdKLEdBQzNCWSxFQUFXRCxFQUFPRCxhQUFhLFVBQ2lCLFNBQWhESixFQUFLTyxNQUFNQSxNQUFNSixFQUFXLEdBQUdHLEVBQVcsSUFDNUNELEVBQU9HLGlCQUFpQixRQUFTQyxLQU16QyxTQUFTQSxJQUVQZCxRQUFRQyxJQUFJYyxNQUFNQyxRQVFYLEdBTkxYLEVBQUtPLE1BQU1LLFVBSEcsYUFLWnRDLEVBQU1JLEdBQVdILEtBQ2pCRCxFQUFNSSxHQUFXRixPQUNqQmtDLE1BQU1DLE9BQU9FLFdBQVdULGFBQWEsVUFBWSxFQUNqRE0sTUFBTUMsT0FBT1AsYUFBYSxVQUFZLElBeEQ1QyxTQUFzQnhCLEVBQUtDLEVBQVFpQyxHQUNqQyxJQUNJYixFQURZbEIsU0FBU0MsZUFBZUosR0FDbkJpQix1QkFBdUIsT0FDNUMsSUFBSyxJQUFJWCxFQUFJLEVBQUdBLEVBQUllLEVBQUt6QixPQUFRVSxJQUFLLENBQ3BDLElBQUlnQixFQUFTRCxFQUFLZixHQUNkaUIsRUFBV0QsRUFBT0UsYUFBYSxVQUNuQyxJQUFLLElBQUlWLEVBQUksRUFBR0EsRUFBSVEsRUFBT0osV0FBV3RCLE9BQVFrQixJQUFLLENBQ2pELElBQUlXLEVBQVNILEVBQU9KLFdBQVdKLEdBQzNCWSxFQUFXRCxFQUFPRCxhQUFhLFVBRWtCLFVBQW5EdkIsRUFBTzBCLE1BQU1BLE1BQU1KLEVBQVcsR0FBR0csRUFBVyxJQUNPLFNBQW5EekIsRUFBTzBCLE1BQU1BLE1BQU1KLEVBQVcsR0FBR0csRUFBVyxJQUU1Q0QsRUFBT1UsVUFBVUMsSUFBSSxVQXhCN0IsV0FDRSxJQUNJZixFQURZbEIsU0FBU0MsZUFBZSxVQUNuQmEsdUJBQXVCLE9BQzVDLElBQUssSUFBSVgsRUFBSSxFQUFHQSxFQUFJZSxFQUFLekIsT0FBUVUsSUFBSyxDQUNwQyxJQUFJZ0IsRUFBU0QsRUFBS2YsR0FDbEIsSUFBSyxJQUFJUSxFQUFJLEVBQUdBLEVBQUlRLEVBQU9KLFdBQVd0QixPQUFRa0IsSUFDL0JRLEVBQU9KLFdBQVdKLEdBQ3hCdUIsb0JBQW9CLFFBQVNSLElBcUJ4Q1MsR0FDQXhDLElBQ0lBLEVBQVksR0FDZHFCLElBRWUsR0FBYnJCLElBQ0Z5QyxHQUFjLEdBb0NkQyxDQUFhLFNBQVVwQixHQzNJM0IsU0FBU3FCLEVBQVc5QyxFQUFNK0MsRUFBVzlDLEVBQVErQyxFQUFjQyxHQUN6RCxJQUFJVixFQUFPLEdBU1gsR0FSQUEsRUFBS3ZDLEtBQU9BLEVBQ1p1QyxFQUFLdEMsT0FBU0EsRUFDZHNDLEVBQUtTLGFBQWVBLEVBQ3BCVCxFQUFLVSxXQUFhQSxFQUNsQlYsRUFBS1csT0FBUyxHQUNkWCxFQUFLWSxNQUFPLEVBQ1paLEVBQUtRLFVBQVlBLEVBRUEsY0FBYkEsRUFDRixJQUFLLElBQUlwQyxFQUFJLEVBQUdBLEdBQUtWLEVBQVFVLElBQzNCNEIsRUFBS1csT0FBT0UsS0FBSyxDQUNmQyxVQUFXMUMsRUFDWDJDLFVBQVcsUUFDWEMsWUFBYSxDQUNYQyxNQUFPUixFQUFhUyxjQUFnQjlDLEVBQ3BDK0MsTUFBT1YsRUFBYVcsc0JBSXJCLEdBQWlCLFlBQWJaLEVBQ1QsSUFBSyxJQUFJcEMsRUFBSSxFQUFHQSxHQUFLVixFQUFRVSxJQUMzQjRCLEVBQUtXLE9BQU9FLEtBQUssQ0FDZkMsVUFBVzFDLEVBQ1gyQyxVQUFXLFFBQ1hDLFlBQWEsQ0FDWEMsTUFBT1IsRUFBYVMsY0FDcEJDLE1BQU9WLEVBQWFXLGNBQWdCaEQsS0FvQjVDLE9BZEE0QixFQUFLcUIsT0FBUyxXQUNaLElBQUssSUFBSXpDLEVBQUksRUFBR0EsRUFBSTBDLEtBQUs1RCxPQUFRa0IsSUFDL0IsR0FBaUMsVUFBN0IwQyxLQUFLWCxPQUFPL0IsR0FBR21DLFVBQ2pCLE9BQU8sRUFJWCxPQURBTyxLQUFLVixNQUFPLEdBQ0wsR0FHVFosRUFBS3VCLElBQU0sU0FBVUMsR0FDbkJGLEtBQUtYLE9BQU9hLEdBQVVULFVBQVksUUFHN0JmLEVBR1QsU0FBU3lCLElBQ1AsSUFBSUMsRUFBWSxDQUNoQkEsTUFBa0IsR0FDbEJBLE1BQWtCLENBQ2hCLENBQUMsUUFBUyxRQUFTLFFBQVMsUUFBUyxRQUFTLFFBQVMsU0FDdkQsQ0FBQyxRQUFTLFFBQVMsUUFBUyxRQUFTLFFBQVMsUUFBUyxTQUN2RCxDQUFDLFFBQVMsUUFBUyxRQUFTLFFBQVMsUUFBUyxRQUFTLFNBQ3ZELENBQUMsUUFBUyxRQUFTLFFBQVMsUUFBUyxRQUFTLFFBQVMsU0FDdkQsQ0FBQyxRQUFTLFFBQVMsUUFBUyxRQUFTLFFBQVMsUUFBUyxTQUN2RCxDQUFDLFFBQVMsUUFBUyxRQUFTLFFBQVMsUUFBUyxRQUFTLFNBQ3ZELENBQUMsUUFBUyxRQUFTLFFBQVMsUUFBUyxRQUFTLFFBQVMsVUFHekRBLHVCQUFtQyxTQUFVQyxHQUMzQyxJQUFJQyxFQUFpQkQsRUFBWWxCLGFBQWFTLGNBQzFDVyxFQUFjRixFQUFZbEIsYUFBYVcsY0FDdkNVLEVBQWVILEVBQVlqQixXQUFXcUIsWUFDdENDLEVBQVlMLEVBQVlqQixXQUFXdUIsWUFFdkMsR0FBNkIsWUFBekJOLEVBQVluQixVQUF5QixDQUN2QyxHQUFtQixHQUFmcUIsRUFDRixPQUFPLEVBRVQsR0FBSUcsRUFBWSxFQUVkLE9BREFuRCxRQUFRQyxJQUFJNkMsRUFBWWxFLEtBQU11RSxJQUN2QixFQUVULElBQUssSUFBSTVELEVBQUl5RCxFQUFhekQsR0FBSzRELEVBQVc1RCxJQUV4QyxHQURBUyxRQUFRQyxJQUFJNkMsRUFBWWxFLEtBQU02RCxLQUFLN0IsTUFBTXJCLEdBQUd3RCxJQUNQLFNBQWpDTixLQUFLN0IsTUFBTXJCLEdBQUd3RCxHQUNoQixPQUFPLE9BR04sR0FBNkIsY0FBekJELEVBQVluQixVQUEyQixDQUNoRCxHQUFzQixHQUFsQm9CLEVBQ0YsT0FBTyxFQUVULEdBQUlFLEVBQWUsRUFDakIsT0FBTyxFQUVULElBQUssSUFBSWxELEVBQUlnRCxFQUFnQmhELEdBQUtrRCxFQUFjbEQsSUFFOUMsR0FEQUMsUUFBUUMsSUFBSTZDLEVBQVlsRSxLQUFNNkQsS0FBSzdCLE1BQU1vQyxHQUFhakQsSUFDcEIsU0FBOUIwQyxLQUFLN0IsTUFBTW9DLEdBQWFqRCxHQUMxQixPQUFPLEVBSWIsT0FBTyxHQUdUOEMsVUFBc0IsU0FBVWxCLEVBQVcvQyxFQUFNQyxFQUFReUQsRUFBT0YsR0FDOUQsSUFBSVAsRUFBYSxHQUNiRCxFQUFlLENBQUVTLGNBQWVELEVBQU9HLGNBQWVELEdBRXpDLGNBQWJYLEdBQ0ZFLEVBQVdxQixZQUFjZCxFQUFRdkQsRUFBUyxFQUMxQ2dELEVBQVd1QixZQUFjZCxHQUNILFlBQWJYLElBQ1RFLEVBQVdxQixZQUFjZCxFQUN6QlAsRUFBV3VCLFlBQWNkLEVBQVF6RCxFQUFTLEdBRzVDLElBQUlzQyxFQUFPTyxFQUFXOUMsRUFBTStDLEVBQVc5QyxFQUFRK0MsRUFBY0MsR0FDN0QsR0FBeUMsR0FBckNZLEtBQUtZLHVCQUF1QmxDLEdBQzlCLE9BQU8sRUFHUCxHQURBMEIsRUFBVWxFLE1BQU1xRCxLQUFLYixHQUNKLGNBQWJRLEVBQ0YsSUFBSyxJQUFJcEMsRUFBSSxFQUFHQSxFQUFJVixFQUFRVSxJQUFLLENBQy9CLElBQUkrRCxFQUFXLENBQ2IxRSxLQUFNdUMsRUFBS3ZDLEtBQ1gyRSxLQUFNcEMsRUFBS1csT0FBT3ZDLElBRXBCa0QsS0FBSzdCLE1BQU0wQixHQUFPRixFQUFRN0MsR0FBSytELE9BRTVCLEdBQWlCLFlBQWIzQixFQUNULElBQUssSUFBSXBDLEVBQUksRUFBR0EsRUFBSVYsRUFBUVUsSUFBSyxDQUMvQixJQUFJK0QsRUFBVyxDQUNiMUUsS0FBTXVDLEVBQUt2QyxLQUNYMkUsS0FBTXBDLEVBQUtXLE9BQU92QyxJQUVwQmtELEtBQUs3QixNQUFNMEIsRUFBUS9DLEdBQUc2QyxHQUFTa0IsRUFJckMsT0FBTyxHQUdUVCxjQUEwQixTQUFVUCxFQUFPRixHQUN6QyxHQUMrQixVQUE3QkssS0FBSzdCLE1BQU0wQixHQUFPRixJQUNXLFNBQTdCSyxLQUFLN0IsTUFBTTBCLEdBQU9GLEdBQ2xCLENBQ0EsSUFBSW9CLEVBQVdmLEtBQUs3QixNQUFNMEIsR0FBT0YsR0FBT3hELEtBRXBDdUMsRUFEY3NCLEtBQUs5RCxNQUFNOEUsUUFBUUMsR0FBT0EsRUFBRzlFLE1BQVE0RSxJQUNoQyxHQUNuQkcsRUFBV3hDLEVBQUtXLE9BQU8yQixRQUN4QkcsR0FDQ0EsRUFBTXpCLFlBQVlDLFFBQVVBLEdBQVN3QixFQUFNekIsWUFBWUcsUUFBVUEsSUFJckUsT0FGQW5CLEVBQUt1QixJQUFJaUIsRUFBUyxHQUFHMUIsV0FDckJkLEVBQUtxQixVQUNFLEVBQ0YsTUFBZ0MsU0FBNUJDLEtBQUs3QixNQUFNMEIsR0FBT0YsSUFDM0JLLEtBQUs3QixNQUFNMEIsR0FBT0YsR0FBUyxRQUNwQixHQUVxQixRQUE1QkssS0FBSzdCLE1BQU0wQixHQUFPRixJQUN5QixRQUEzQ0ssS0FBSzdCLE1BQU0wQixHQUFPRixHQUFPbUIsS0FBS3JCLFdBT2xDVyxnQkFBNEIsV0FDMUIsSUFBSyxJQUFJdEQsRUFBSSxFQUFHQSxFQUFJa0QsS0FBSzlELE1BQU1FLE9BQVFVLElBQ3JDLEdBQTBCLEdBQXRCa0QsS0FBSzlELE1BQU1ZLEdBQUd3QyxLQUNoQixPQUFPLEVBR1gsT0FBTyxJQUdULE9BQU9jLEVBR1QsU0FBU2dCLEVBQWFDLEdBQ3BCLElBQUk1RSxFQUFTLEdBSWIsT0FIQUEsRUFBTzRFLEtBQU9BLEVBQ2Q1RSxFQUFPMEIsTUFBUWdDLElBRVIxRCxFQWtLVCxJQTJCSW1CLEVBQU93RCxFQUFhLFNBR3BCckMsR0FGT3FDLEVBQWEsYUFFTixHQUVsQjdFLEVBQVksVUFDWm9CLElBQ0FwQixFQUFZLFNBZ0RabEIsUUFBUTRELFdBQWFBLEVBQ3JCNUQsUUFBUThFLGdCQUFrQkEsRUFDMUI5RSxRQUFRaUcsU0FuUFIsV0FDRSxJQUFJQyxFQUFNSCxFQUFhLFNBQ25CSSxFQUFPSixFQUFhLFlBQ3BCSyxFQUFTLEtBRVRDLEVBQVksQ0FDZCxVQUNBLGFBQ0EsVUFDQSxZQUNBLGFBRUVDLEVBQWMsQ0FBQyxFQUFHLEVBQUcsRUFBRyxFQUFHLEdBQzNCQyxFQUFhLENBQUMsYUFBYyxZQUM1QmpDLEVBQVFrQyxLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsVUFDeEJsQyxFQUFRZ0MsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtFLFVBQ3hCN0MsRUFBWTJDLEtBQUtDLE1BQXNCLEVBQWhCRCxLQUFLRSxVQUVoQyxJQUFLLElBQUlqRixFQUFJLEVBQUdBLEVBQUk0RSxFQUFVdEYsT0FBUVUsSUFDcEMsTUFDRzBFLEVBQUtyRCxNQUFNSyxVQUNWb0QsRUFBVzFDLEdBQ1h3QyxFQUFVNUUsR0FDVjZFLEVBQVk3RSxHQUNaK0MsRUFDQUYsSUFHRkEsRUFBUWtDLEtBQUtDLE1BQXNCLEVBQWhCRCxLQUFLRSxVQUN4QmxDLEVBQVFnQyxLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsVUFHNUJwQyxFQUFRa0MsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtFLFVBQ3hCbEMsRUFBUWdDLEtBQUtDLE1BQXNCLEVBQWhCRCxLQUFLRSxVQUV4QixJQUFLLElBQUl6RSxFQUFJLEVBQUdBLEVBQUlvRSxFQUFVdEYsT0FBUWtCLElBQ3BDLE1BQ0dpRSxFQUFJcEQsTUFBTUssVUFDVG9ELEVBQVcxQyxHQUNYd0MsRUFBVXBFLEdBQ1ZxRSxFQUFZckUsR0FDWnVDLEVBQ0FGLElBR0ZBLEVBQVFrQyxLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsVUFDeEJsQyxFQUFRZ0MsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtFLFVBSTVCLEtBQWlCLE1BQVZOLEdBQWdCLENBR3JCLElBRkE5QixFQUFRa0MsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtFLFVBQ3hCbEMsRUFBUWdDLEtBQUtDLE1BQXNCLEVBQWhCRCxLQUFLRSxXQUNoQlAsRUFBS3JELE1BQU02RCxjQUFjbkMsRUFBT0YsSUFDdENBLEVBQVFrQyxLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsVUFDeEJsQyxFQUFRZ0MsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtFLFVBTTFCLEdBSm9DLEdBQWhDUCxFQUFLckQsTUFBTThELG9CQUNiUixFQUFTLFNBR0csTUFBVkEsRUFBZ0IsQ0FHbEIsSUFGQTlCLEVBQVFrQyxLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsVUFDeEJsQyxFQUFRZ0MsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtFLFdBQ2hCUixFQUFJcEQsTUFBTTZELGNBQWNuQyxFQUFPRixJQUNyQ0EsRUFBUWtDLEtBQUtDLE1BQXNCLEVBQWhCRCxLQUFLRSxVQUN4QmxDLEVBQVFnQyxLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsVUFFUyxHQUEvQlIsRUFBSXBELE1BQU04RCxvQkFDWlIsRUFBUyxhQUtmLE9BQU9BLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9ib2FyZC5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJpbXBvcnQgeyB1c2VyLCBjb21wLCBzaGlwc1BsYWNlZCB9IGZyb20gXCIuLi9pbmRleC5qc1wiO1xyXG5cclxubGV0IHNoaXBzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiQ2FycmllclwiLFxyXG4gICAgbGVuZ3RoOiA1LFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmF0dGxlc2hpcFwiLFxyXG4gICAgbGVuZ3RoOiA0LFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQ3J1aXNlclwiLFxyXG4gICAgbGVuZ3RoOiAzLFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiU3VibWFyaW5lXCIsXHJcbiAgICBsZW5ndGg6IDMsXHJcbiAgICBwbGFjZWQ6IGZhbHNlLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJEZXN0cm95ZXJcIixcclxuICAgIGxlbmd0aDogMixcclxuICAgIHBsYWNlZDogZmFsc2UsXHJcbiAgfSxcclxuXTtcclxubGV0IHNoaXBJbmRleCA9IDA7XHJcbmZ1bmN0aW9uIGVtcHR5UmVuZGVyKGRpdiwgcGxheWVyKSB7XHJcbiAgbGV0IHBhcmVudERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRpdik7XHJcbiAgbGV0IHJvd0FyciA9IFtcIkFcIiwgXCJCXCIsIFwiQ1wiLCBcIkRcIiwgXCJFXCIsIFwiRlwiLCBcIkdcIl07XHJcbiAgLy9PdXRlciBsb29wIGlzIHJvd3MsIGlubmVyIGxvb3AgaXMgY29sdW1uc1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgODsgaSsrKSB7XHJcbiAgICBsZXQgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIHJvdy5jbGFzc05hbWUgPSBcInJvd1wiO1xyXG4gICAgcm93LnNldEF0dHJpYnV0ZShcIlktQ29yZFwiLCBpKTtcclxuICAgIGlmIChpID09IDApIHtcclxuICAgICAgbGV0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgIGJveC5jbGFzc05hbWUgPSBcImJveFwiO1xyXG4gICAgICBib3guaW5uZXJUZXh0ID0gXCJZL1ggXCI7XHJcbiAgICAgIHJvdy5hcHBlbmRDaGlsZChib3gpO1xyXG4gICAgfVxyXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCA4OyBqKyspIHtcclxuICAgICAgbGV0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgIGJveC5jbGFzc05hbWUgPSBcImJveFwiO1xyXG4gICAgICBib3guc2V0QXR0cmlidXRlKFwiWC1Db3JkXCIsIGopO1xyXG4gICAgICBpZiAoaSA9PSAwKSB7XHJcbiAgICAgICAgaWYgKGogIT09IDcpIHtcclxuICAgICAgICAgIGJveC5pbm5lclRleHQgPSByb3dBcnJbal07XHJcbiAgICAgICAgICBib3guaW5uZXJUZXh0ICs9IFwiKFwiICsgaiArIFwiKVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChqID09IDApIHtcclxuICAgICAgICBib3guaW5uZXJUZXh0ID0gaTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGogPT0gNyAmJiBpID09IDApIHtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByb3cuYXBwZW5kQ2hpbGQoYm94KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcGFyZW50RGl2LmFwcGVuZENoaWxkKHJvdyk7XHJcbiAgfVxyXG4gIGNvbnNvbGUubG9nKHBhcmVudERpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwicm93XCIpWzFdLmNoaWxkTm9kZXNbMF0pO1xyXG59XHJcbmZ1bmN0aW9uIGRlbGV0ZUJvYXJkKGRpdikge1xyXG4gIGxldCBwYXJlbnREaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkaXYpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVBZGRTaGlwcygpIHtcclxuICBsZXQgcGFyZW50RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbGF5ZXJcIik7XHJcbiAgbGV0IHJvd3MgPSBwYXJlbnREaXYuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInJvd1wiKTtcclxuICBmb3IgKGxldCBpID0gMTsgaSA8IHJvd3MubGVuZ3RoOyBpKyspIHtcclxuICAgIGxldCBjdXJSb3cgPSByb3dzW2ldO1xyXG4gICAgZm9yIChsZXQgaiA9IDE7IGogPCBjdXJSb3cuY2hpbGROb2Rlcy5sZW5ndGg7IGorKykge1xyXG4gICAgICBsZXQgY3VyQm94ID0gY3VyUm93LmNoaWxkTm9kZXNbal07XHJcbiAgICAgIGN1ckJveC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25BZGRTaGlwQ2xpY2spO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5mdW5jdGlvbiByZWZyZXNoQm9hcmQoZGl2LCBwbGF5ZXIsIHNoaXApIHtcclxuICBsZXQgcGFyZW50RGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGl2KTtcclxuICBsZXQgcm93cyA9IHBhcmVudERpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwicm93XCIpO1xyXG4gIGZvciAobGV0IGkgPSAxOyBpIDwgcm93cy5sZW5ndGg7IGkrKykge1xyXG4gICAgbGV0IGN1clJvdyA9IHJvd3NbaV07XHJcbiAgICBsZXQgY3VyWUNvcmQgPSBjdXJSb3cuZ2V0QXR0cmlidXRlKFwieS1jb3JkXCIpO1xyXG4gICAgZm9yIChsZXQgaiA9IDE7IGogPCBjdXJSb3cuY2hpbGROb2Rlcy5sZW5ndGg7IGorKykge1xyXG4gICAgICBsZXQgY3VyQm94ID0gY3VyUm93LmNoaWxkTm9kZXNbal07XHJcbiAgICAgIGxldCBjdXJYQ29yZCA9IGN1ckJveC5nZXRBdHRyaWJ1dGUoXCJ4LWNvcmRcIik7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBwbGF5ZXIuYm9hcmQuYm9hcmRbY3VyWUNvcmQgLSAxXVtjdXJYQ29yZCAtIDFdICE9PSBcImVtcHR5XCIgJiZcclxuICAgICAgICBwbGF5ZXIuYm9hcmQuYm9hcmRbY3VyWUNvcmQgLSAxXVtjdXJYQ29yZCAtIDFdICE9PSBcIm1pc3NcIlxyXG4gICAgICApIHtcclxuICAgICAgICBjdXJCb3guY2xhc3NMaXN0LmFkZChcInNoaXBcIik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgcmVtb3ZlQWRkU2hpcHMoKTtcclxuICBzaGlwSW5kZXgrKztcclxuICBpZiAoc2hpcEluZGV4IDwgNSkge1xyXG4gICAgcGxhY2VTaGlwTGlzdGVuZXJzKCk7XHJcbiAgfVxyXG4gIGlmIChzaGlwSW5kZXggPT0gNSkge1xyXG4gICAgc2hpcHNQbGFjZWQgPSB0cnVlO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcGxhY2VTaGlwTGlzdGVuZXJzKCkge1xyXG4gIGNvbnNvbGUubG9nKHVzZXIpO1xyXG4gIGxldCBwYXJlbnREaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKTtcclxuICBsZXQgcm93cyA9IHBhcmVudERpdi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwicm93XCIpO1xyXG4gIC8vbGV0IGRpcmVjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXJlY3Rpb24tcmFkaW8nKS52YWx1ZTtcclxuICBsZXQgZGlyZWN0aW9uID0gXCJob3Jpem9udGFsXCI7XHJcbiAgLy9PdXRlciBpdGVyYXRlcyB0aHJvdWdoIHJvd3MsIGlubmVyIHRocm91Z2ggYm94ZXMgaW4gcm93XHJcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCByb3dzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBsZXQgY3VyUm93ID0gcm93c1tpXTtcclxuICAgIGxldCBjdXJZQ29yZCA9IGN1clJvdy5nZXRBdHRyaWJ1dGUoXCJ5LWNvcmRcIik7XHJcbiAgICBmb3IgKGxldCBqID0gMTsgaiA8IGN1clJvdy5jaGlsZE5vZGVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgIGxldCBjdXJCb3ggPSBjdXJSb3cuY2hpbGROb2Rlc1tqXTtcclxuICAgICAgbGV0IGN1clhDb3JkID0gY3VyQm94LmdldEF0dHJpYnV0ZShcIngtY29yZFwiKTtcclxuICAgICAgaWYgKHVzZXIuYm9hcmQuYm9hcmRbY3VyWUNvcmQgLSAxXVtjdXJYQ29yZCAtIDFdID09IFwiZW1wdHlcIikge1xyXG4gICAgICAgIGN1ckJveC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25BZGRTaGlwQ2xpY2spO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBvbkFkZFNoaXBDbGljaygpIHtcclxuICBsZXQgZGlyZWN0aW9uID0gXCJob3Jpem9udGFsXCI7XHJcbiAgY29uc29sZS5sb2coZXZlbnQudGFyZ2V0KTtcclxuICBpZiAoXHJcbiAgICB1c2VyLmJvYXJkLnBsYWNlU2hpcChcclxuICAgICAgZGlyZWN0aW9uLFxyXG4gICAgICBzaGlwc1tzaGlwSW5kZXhdLm5hbWUsXHJcbiAgICAgIHNoaXBzW3NoaXBJbmRleF0ubGVuZ3RoLFxyXG4gICAgICBldmVudC50YXJnZXQucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoXCJ5LWNvcmRcIikgLSAxLFxyXG4gICAgICBldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKFwieC1jb3JkXCIpIC0gMVxyXG4gICAgKSA9PSB0cnVlXHJcbiAgKSB7XHJcbiAgICByZWZyZXNoQm9hcmQoXCJwbGF5ZXJcIiwgdXNlcik7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCB7IGVtcHR5UmVuZGVyLCBwbGFjZVNoaXBMaXN0ZW5lcnMgfTtcclxuIiwiaW1wb3J0IHsgZW1wdHlSZW5kZXIsIHBsYWNlU2hpcExpc3RlbmVycyB9IGZyb20gXCIuL21vZHVsZXMvYm9hcmRcIjtcclxuZnVuY3Rpb24gY3JlYXRlU2hpcChuYW1lLCBkaXJlY3Rpb24sIGxlbmd0aCwgc3RhcnRpbmdDb3JkLCBlbmRpbmdDb3JkKSB7XHJcbiAgdmFyIHNoaXAgPSB7fTtcclxuICBzaGlwLm5hbWUgPSBuYW1lO1xyXG4gIHNoaXAubGVuZ3RoID0gbGVuZ3RoO1xyXG4gIHNoaXAuc3RhcnRpbmdDb3JkID0gc3RhcnRpbmdDb3JkO1xyXG4gIHNoaXAuZW5kaW5nQ29yZCA9IGVuZGluZ0NvcmQ7XHJcbiAgc2hpcC5oZWFsdGggPSBbXTtcclxuICBzaGlwLnN1bmsgPSBmYWxzZTtcclxuICBzaGlwLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjtcclxuXHJcbiAgaWYgKGRpcmVjdGlvbiA9PSBcImhvcml6b250YWxcIikge1xyXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbGVuZ3RoOyBpKyspIHtcclxuICAgICAgc2hpcC5oZWFsdGgucHVzaCh7XHJcbiAgICAgICAgc2hpcFBvaW50OiBpLFxyXG4gICAgICAgIGhpdFN0YXR1czogXCJmYWxzZVwiLFxyXG4gICAgICAgIGNvb3JkaW5hdGVzOiB7XHJcbiAgICAgICAgICB4Q29yZDogc3RhcnRpbmdDb3JkLnN0YXJ0aW5nWENvcmQgKyBpLFxyXG4gICAgICAgICAgeUNvcmQ6IHN0YXJ0aW5nQ29yZC5zdGFydGluZ1lDb3JkLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09IFwidmVydGljYWxcIikge1xyXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbGVuZ3RoOyBpKyspIHtcclxuICAgICAgc2hpcC5oZWFsdGgucHVzaCh7XHJcbiAgICAgICAgc2hpcFBvaW50OiBpLFxyXG4gICAgICAgIGhpdFN0YXR1czogXCJmYWxzZVwiLFxyXG4gICAgICAgIGNvb3JkaW5hdGVzOiB7XHJcbiAgICAgICAgICB4Q29yZDogc3RhcnRpbmdDb3JkLnN0YXJ0aW5nWENvcmQsXHJcbiAgICAgICAgICB5Q29yZDogc3RhcnRpbmdDb3JkLnN0YXJ0aW5nWUNvcmQgKyBpLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2hpcC5pc1N1bmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgaWYgKHRoaXMuaGVhbHRoW2pdLmhpdFN0YXR1cyA9PT0gXCJmYWxzZVwiKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLnN1bmsgPSB0cnVlO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfTtcclxuXHJcbiAgc2hpcC5oaXQgPSBmdW5jdGlvbiAoaGl0UG9pbnQpIHtcclxuICAgIHRoaXMuaGVhbHRoW2hpdFBvaW50XS5oaXRTdGF0dXMgPSBcInRydWVcIjtcclxuICB9O1xyXG5cclxuICByZXR1cm4gc2hpcDtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlR2FtZUJvYXJkKCkge1xyXG4gIHZhciBnYW1lQm9hcmQgPSB7fTtcclxuICBnYW1lQm9hcmQuc2hpcHMgPSBbXTtcclxuICBnYW1lQm9hcmQuYm9hcmQgPSBbXHJcbiAgICBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICBdO1xyXG5cclxuICBnYW1lQm9hcmQuY2hlY2tGb3JWYWxpZFBsYWNlbWVudCA9IGZ1bmN0aW9uIChzaGlwVG9QbGFjZSkge1xyXG4gICAgbGV0IHN0YXJ0aW5nQ29sdW1uID0gc2hpcFRvUGxhY2Uuc3RhcnRpbmdDb3JkLnN0YXJ0aW5nWENvcmQ7XHJcbiAgICBsZXQgc3RhcnRpbmdSb3cgPSBzaGlwVG9QbGFjZS5zdGFydGluZ0NvcmQuc3RhcnRpbmdZQ29yZDtcclxuICAgIGxldCBlbmRpbmdDb2x1bW4gPSBzaGlwVG9QbGFjZS5lbmRpbmdDb3JkLmVuZGluZ1hDb3JkO1xyXG4gICAgbGV0IGVuZGluZ1JvdyA9IHNoaXBUb1BsYWNlLmVuZGluZ0NvcmQuZW5kaW5nWUNvcmQ7XHJcblxyXG4gICAgaWYgKHNoaXBUb1BsYWNlLmRpcmVjdGlvbiA9PSBcInZlcnRpY2FsXCIpIHtcclxuICAgICAgaWYgKHN0YXJ0aW5nUm93ID09IDYpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGVuZGluZ1JvdyA+IDYpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhzaGlwVG9QbGFjZS5uYW1lLCBlbmRpbmdSb3cpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGxldCBpID0gc3RhcnRpbmdSb3c7IGkgPD0gZW5kaW5nUm93OyBpKyspIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhzaGlwVG9QbGFjZS5uYW1lLCB0aGlzLmJvYXJkW2ldW3N0YXJ0aW5nQ29sdW1uXSk7XHJcbiAgICAgICAgaWYgKHRoaXMuYm9hcmRbaV1bc3RhcnRpbmdDb2x1bW5dICE9IFwiZW1wdHlcIikge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChzaGlwVG9QbGFjZS5kaXJlY3Rpb24gPT0gXCJob3Jpem9udGFsXCIpIHtcclxuICAgICAgaWYgKHN0YXJ0aW5nQ29sdW1uID09IDYpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGVuZGluZ0NvbHVtbiA+IDYpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChsZXQgaiA9IHN0YXJ0aW5nQ29sdW1uOyBqIDw9IGVuZGluZ0NvbHVtbjsgaisrKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coc2hpcFRvUGxhY2UubmFtZSwgdGhpcy5ib2FyZFtzdGFydGluZ1Jvd11bal0pO1xyXG4gICAgICAgIGlmICh0aGlzLmJvYXJkW3N0YXJ0aW5nUm93XVtqXSAhPSBcImVtcHR5XCIpIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH07XHJcblxyXG4gIGdhbWVCb2FyZC5wbGFjZVNoaXAgPSBmdW5jdGlvbiAoZGlyZWN0aW9uLCBuYW1lLCBsZW5ndGgsIHlDb3JkLCB4Q29yZCkge1xyXG4gICAgbGV0IGVuZGluZ0NvcmQgPSB7fTtcclxuICAgIGxldCBzdGFydGluZ0NvcmQgPSB7IHN0YXJ0aW5nWENvcmQ6IHhDb3JkLCBzdGFydGluZ1lDb3JkOiB5Q29yZCB9O1xyXG5cclxuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJob3Jpem9udGFsXCIpIHtcclxuICAgICAgZW5kaW5nQ29yZC5lbmRpbmdYQ29yZCA9IHhDb3JkICsgbGVuZ3RoIC0gMTtcclxuICAgICAgZW5kaW5nQ29yZC5lbmRpbmdZQ29yZCA9IHlDb3JkO1xyXG4gICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gXCJ2ZXJ0aWNhbFwiKSB7XHJcbiAgICAgIGVuZGluZ0NvcmQuZW5kaW5nWENvcmQgPSB4Q29yZDtcclxuICAgICAgZW5kaW5nQ29yZC5lbmRpbmdZQ29yZCA9IHlDb3JkICsgbGVuZ3RoIC0gMTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgc2hpcCA9IGNyZWF0ZVNoaXAobmFtZSwgZGlyZWN0aW9uLCBsZW5ndGgsIHN0YXJ0aW5nQ29yZCwgZW5kaW5nQ29yZCk7XHJcbiAgICBpZiAodGhpcy5jaGVja0ZvclZhbGlkUGxhY2VtZW50KHNoaXApID09IGZhbHNlKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGdhbWVCb2FyZC5zaGlwcy5wdXNoKHNoaXApO1xyXG4gICAgICBpZiAoZGlyZWN0aW9uID09IFwiaG9yaXpvbnRhbFwiKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgbGV0IHBsYWNlT2JqID0ge1xyXG4gICAgICAgICAgICBuYW1lOiBzaGlwLm5hbWUsXHJcbiAgICAgICAgICAgIHNwb3Q6IHNoaXAuaGVhbHRoW2ldLFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIHRoaXMuYm9hcmRbeUNvcmRdW3hDb3JkICsgaV0gPSBwbGFjZU9iajtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09IFwidmVydGljYWxcIikge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgIGxldCBwbGFjZU9iaiA9IHtcclxuICAgICAgICAgICAgbmFtZTogc2hpcC5uYW1lLFxyXG4gICAgICAgICAgICBzcG90OiBzaGlwLmhlYWx0aFtpXSxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICB0aGlzLmJvYXJkW3lDb3JkICsgaV1beENvcmRdID0gcGxhY2VPYmo7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9O1xyXG5cclxuICBnYW1lQm9hcmQucmVjZWl2ZUF0dGFjayA9IGZ1bmN0aW9uICh5Q29yZCwgeENvcmQpIHtcclxuICAgIGlmIChcclxuICAgICAgdGhpcy5ib2FyZFt5Q29yZF1beENvcmRdICE9PSBcImVtcHR5XCIgJiZcclxuICAgICAgdGhpcy5ib2FyZFt5Q29yZF1beENvcmRdICE9PSBcIm1pc3NcIlxyXG4gICAgKSB7XHJcbiAgICAgIGxldCBzaGlwTmFtZSA9IHRoaXMuYm9hcmRbeUNvcmRdW3hDb3JkXS5uYW1lO1xyXG4gICAgICBsZXQgZmlsdGVyZWRBcnIgPSB0aGlzLnNoaXBzLmZpbHRlcigoc2gpID0+IHNoLm5hbWUgPT0gc2hpcE5hbWUpO1xyXG4gICAgICBsZXQgc2hpcCA9IGZpbHRlcmVkQXJyWzBdO1xyXG4gICAgICBsZXQgcG9pbnRBcnIgPSBzaGlwLmhlYWx0aC5maWx0ZXIoXHJcbiAgICAgICAgKHBvaW50KSA9PlxyXG4gICAgICAgICAgcG9pbnQuY29vcmRpbmF0ZXMueENvcmQgPT09IHhDb3JkICYmIHBvaW50LmNvb3JkaW5hdGVzLnlDb3JkID09PSB5Q29yZFxyXG4gICAgICApO1xyXG4gICAgICBzaGlwLmhpdChwb2ludEFyclswXS5zaGlwUG9pbnQpO1xyXG4gICAgICBzaGlwLmlzU3VuaygpO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5ib2FyZFt5Q29yZF1beENvcmRdID09IFwiZW1wdHlcIikge1xyXG4gICAgICB0aGlzLmJvYXJkW3lDb3JkXVt4Q29yZF0gPSBcIm1pc3NcIjtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGVsc2UgaWYgKFxyXG4gICAgICB0aGlzLmJvYXJkW3lDb3JkXVt4Q29yZF0gPT0gXCJtaXNzXCIgfHxcclxuICAgICAgdGhpcy5ib2FyZFt5Q29yZF1beENvcmRdLnNwb3QuaGl0U3RhdHVzID09IFwidHJ1ZVwiXHJcbiAgICApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfTtcclxuXHJcbiAgZ2FtZUJvYXJkLmNoZWNrRm9yQWxsU3VuayA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zaGlwcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAodGhpcy5zaGlwc1tpXS5zdW5rID09IGZhbHNlKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9O1xyXG5cclxuICByZXR1cm4gZ2FtZUJvYXJkO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVQbGF5ZXIodHlwZSkge1xyXG4gIGxldCBwbGF5ZXIgPSB7fTtcclxuICBwbGF5ZXIudHlwZSA9IHR5cGU7XHJcbiAgcGxheWVyLmJvYXJkID0gY3JlYXRlR2FtZUJvYXJkKCk7XHJcblxyXG4gIHJldHVybiBwbGF5ZXI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdhbWVMb29wKCkge1xyXG4gIGxldCBodW0gPSBjcmVhdGVQbGF5ZXIoXCJodW1hblwiKTtcclxuICBsZXQgY29tcCA9IGNyZWF0ZVBsYXllcihcImNvbXB1dGVyXCIpO1xyXG4gIGxldCB3aW5uZXIgPSBudWxsO1xyXG4gIGxldCB0dXJuQ291bnRlciA9IDE7XHJcbiAgbGV0IHNoaXBOYW1lcyA9IFtcclxuICAgIFwiQ2FycmllclwiLFxyXG4gICAgXCJCYXR0bGVzaGlwXCIsXHJcbiAgICBcIkNydWlzZXJcIixcclxuICAgIFwiU3VibWFyaW5lXCIsXHJcbiAgICBcIkRlc3Ryb3llclwiLFxyXG4gIF07XHJcbiAgbGV0IHNoaXBMZW5ndGhzID0gWzUsIDQsIDMsIDMsIDJdO1xyXG4gIGxldCBkaXJlY3Rpb25zID0gW1wiaG9yaXpvbnRhbFwiLCBcInZlcnRpY2FsXCJdO1xyXG4gIGxldCB4Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIGxldCB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gIGxldCBkaXJlY3Rpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxKTtcclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTmFtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgIHdoaWxlIChcclxuICAgICAgIWNvbXAuYm9hcmQucGxhY2VTaGlwKFxyXG4gICAgICAgIGRpcmVjdGlvbnNbZGlyZWN0aW9uXSxcclxuICAgICAgICBzaGlwTmFtZXNbaV0sXHJcbiAgICAgICAgc2hpcExlbmd0aHNbaV0sXHJcbiAgICAgICAgeUNvcmQsXHJcbiAgICAgICAgeENvcmRcclxuICAgICAgKVxyXG4gICAgKSB7XHJcbiAgICAgIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICAgIHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgeUNvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuXHJcbiAgZm9yIChsZXQgaiA9IDA7IGogPCBzaGlwTmFtZXMubGVuZ3RoOyBqKyspIHtcclxuICAgIHdoaWxlIChcclxuICAgICAgIWh1bS5ib2FyZC5wbGFjZVNoaXAoXHJcbiAgICAgICAgZGlyZWN0aW9uc1tkaXJlY3Rpb25dLFxyXG4gICAgICAgIHNoaXBOYW1lc1tqXSxcclxuICAgICAgICBzaGlwTGVuZ3Roc1tqXSxcclxuICAgICAgICB5Q29yZCxcclxuICAgICAgICB4Q29yZFxyXG4gICAgICApXHJcbiAgICApIHtcclxuICAgICAgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgeUNvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHdoaWxlICh3aW5uZXIgPT0gbnVsbCkge1xyXG4gICAgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgIHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICB3aGlsZSAoIWNvbXAuYm9hcmQucmVjZWl2ZUF0dGFjayh5Q29yZCwgeENvcmQpKSB7XHJcbiAgICAgIHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICAgIHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgICB9XHJcbiAgICBpZiAoY29tcC5ib2FyZC5jaGVja0ZvckFsbFN1bmsoKSA9PSB0cnVlKSB7XHJcbiAgICAgIHdpbm5lciA9IFwiSHVtYW5cIjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAod2lubmVyID09IG51bGwpIHtcclxuICAgICAgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgeUNvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgd2hpbGUgKCFodW0uYm9hcmQucmVjZWl2ZUF0dGFjayh5Q29yZCwgeENvcmQpKSB7XHJcbiAgICAgICAgeENvcmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KTtcclxuICAgICAgICB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChodW0uYm9hcmQuY2hlY2tGb3JBbGxTdW5rKCkgPT0gdHJ1ZSkge1xyXG4gICAgICAgIHdpbm5lciA9IFwiQ29tcHV0ZXJcIjtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHdpbm5lcjtcclxufVxyXG5cclxuZnVuY3Rpb24gdGVzdFJlbmRlcigpIHtcclxuICBsZXQgc2hpcE5hbWVzID0gW1xyXG4gICAgXCJDYXJyaWVyXCIsXHJcbiAgICBcIkJhdHRsZXNoaXBcIixcclxuICAgIFwiQ3J1aXNlclwiLFxyXG4gICAgXCJTdWJtYXJpbmVcIixcclxuICAgIFwiRGVzdHJveWVyXCIsXHJcbiAgXTtcclxuICBsZXQgc2hpcExlbmd0aHMgPSBbNSwgNCwgMywgMywgMl07XHJcbiAgbGV0IGRpcmVjdGlvbnMgPSBbXCJob3Jpem9udGFsXCIsIFwidmVydGljYWxcIl07XHJcbiAgbGV0IHhDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgbGV0IHlDb3JkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyk7XHJcbiAgbGV0IGRpcmVjdGlvbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xyXG4gIGxldCBwbGF5ZXIgPSBjcmVhdGVQbGF5ZXIoXCJodW1hblwiKTtcclxuICBmb3IgKGxldCBqID0gMDsgaiA8IHNoaXBOYW1lcy5sZW5ndGg7IGorKykge1xyXG4gICAgd2hpbGUgKFxyXG4gICAgICAhcGxheWVyLmJvYXJkLnBsYWNlU2hpcChcclxuICAgICAgICBkaXJlY3Rpb25zW2RpcmVjdGlvbl0sXHJcbiAgICAgICAgc2hpcE5hbWVzW2pdLFxyXG4gICAgICAgIHNoaXBMZW5ndGhzW2pdLFxyXG4gICAgICAgIHlDb3JkLFxyXG4gICAgICAgIHhDb3JkXHJcbiAgICAgIClcclxuICAgICkge1xyXG4gICAgICB4Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgICB5Q29yZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xyXG4gICAgICBkaXJlY3Rpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxKTtcclxuICAgIH1cclxuICB9XHJcbiAgbGV0IHBhcmVudERpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyXCIpO1xyXG4gIGxldCByb3dBcnIgPSBbXCJBXCIsIFwiQlwiLCBcIkNcIiwgXCJEXCIsIFwiRVwiLCBcIkZcIiwgXCJHXCJdO1xyXG4gIC8vT3V0ZXIgbG9vcCBpcyByb3dzLCBpbm5lciBsb29wIGlzIGNvbHVtbnNcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkrKykge1xyXG4gICAgbGV0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICByb3cuY2xhc3NOYW1lID0gXCJyb3dcIjtcclxuICAgIHJvdy5zZXRBdHRyaWJ1dGUoXCJZLUNvcmRcIiwgaSk7XHJcbiAgICBpZiAoaSA9PSAwKSB7XHJcbiAgICAgIGxldCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICBib3guY2xhc3NOYW1lID0gXCJib3hcIjtcclxuICAgICAgYm94LmlubmVyVGV4dCA9IFwiWS9YIFwiO1xyXG4gICAgICByb3cuYXBwZW5kQ2hpbGQoYm94KTtcclxuICAgIH1cclxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgODsgaisrKSB7XHJcbiAgICAgIGxldCBib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICBib3guY2xhc3NOYW1lID0gXCJib3hcIjtcclxuICAgICAgYm94LnNldEF0dHJpYnV0ZShcIlgtQ29yZFwiLCBqKTtcclxuICAgICAgaWYgKGkgPT0gMCkge1xyXG4gICAgICAgIGlmIChqICE9PSA3KSB7XHJcbiAgICAgICAgICBib3guaW5uZXJUZXh0ID0gcm93QXJyW2pdO1xyXG4gICAgICAgICAgYm94LmlubmVyVGV4dCArPSBcIihcIiArIGogKyBcIilcIjtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoaiA9PSAwKSB7XHJcbiAgICAgICAgYm94LmlubmVyVGV4dCA9IGk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKHBsYXllci5ib2FyZC5ib2FyZFtpIC0gMV1baiAtIDFdID09IFwiZW1wdHlcIikge1xyXG4gICAgICAgICAgYm94LmlubmVyVGV4dCA9IHBsYXllci5ib2FyZC5ib2FyZFtpIC0gMV1baiAtIDFdO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBib3guaW5uZXJUZXh0ID0gcGxheWVyLmJvYXJkLmJvYXJkW2kgLSAxXVtqIC0gMV0ubmFtZTtcclxuICAgICAgICAgIGJveC5jbGFzc0xpc3QuYWRkKFwic2hpcFwiKTtcclxuICAgICAgICAgIGJveC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsZXQgc2hpcE5hbWUgPSBwbGF5ZXIuYm9hcmQuYm9hcmRbaSAtIDFdW2ogLSAxXS5uYW1lO1xyXG4gICAgICAgICAgICBsZXQgZmlsdGVyZWRBcnIgPSBwbGF5ZXIuYm9hcmQuc2hpcHMuZmlsdGVyKFxyXG4gICAgICAgICAgICAgIChzaCkgPT4gc2gubmFtZSA9PSBzaGlwTmFtZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBsZXQgc2hpcCA9IGZpbHRlcmVkQXJyWzBdO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzaGlwKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocGxheWVyLmJvYXJkLmJvYXJkKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGogPT0gNyAmJiBpID09IDApIHtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByb3cuYXBwZW5kQ2hpbGQoYm94KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcGFyZW50RGl2LmFwcGVuZENoaWxkKHJvdyk7XHJcbiAgfVxyXG59XHJcblxyXG4vL3Rlc3RSZW5kZXIoKTtcclxuLy8gZ2FtZUxvb3AoKTtcclxubGV0IHNoaXBzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiQ2FycmllclwiLFxyXG4gICAgbGVuZ3RoOiA1LFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmF0dGxlc2hpcFwiLFxyXG4gICAgbGVuZ3RoOiA0LFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQ3J1aXNlclwiLFxyXG4gICAgbGVuZ3RoOiAzLFxyXG4gICAgcGxhY2VkOiBmYWxzZSxcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiU3VibWFyaW5lXCIsXHJcbiAgICBsZW5ndGg6IDMsXHJcbiAgICBwbGFjZWQ6IGZhbHNlLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJEZXN0cm95ZXJcIixcclxuICAgIGxlbmd0aDogMixcclxuICAgIHBsYWNlZDogZmFsc2UsXHJcbiAgfSxcclxuXTtcclxubGV0IHVzZXIgPSBjcmVhdGVQbGF5ZXIoXCJodW1hblwiKTtcclxubGV0IGNvbXAgPSBjcmVhdGVQbGF5ZXIoXCJjb21wdXRlclwiKTtcclxubGV0IHR1cm5Db3VudCA9IDA7XHJcbmxldCBzaGlwc1BsYWNlZCA9IGZhbHNlO1xyXG5leHBvcnQgeyB1c2VyLCBjb21wLCB0dXJuQ291bnQsIHNoaXBzUGxhY2VkIH07XHJcbmVtcHR5UmVuZGVyKFwicGxheWVyXCIsIHVzZXIpO1xyXG5wbGFjZVNoaXBMaXN0ZW5lcnMoKTtcclxuZW1wdHlSZW5kZXIoXCJndWVzc1wiKTtcclxuXHJcbmZ1bmN0aW9uIHdhaXRGb3JTaGlwcygpIHtcclxuICBpZiAoc2hpcHNQbGFjZWQgIT0gdHJ1ZSkge1xyXG4gICAgc2V0VGltZW91dCh3YWl0Rm9yU2hpcHMsIDUwMCk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG59XHJcblxyXG4vKlxyXG5BZnRlciB3YWl0IGZvciBzaGlwcywgY2FsbCBmdW5jdGlvbiB0aGF0IHNldHMgdXAgY29tcHV0ZXIgcGxheWVyXHJcbkRvIG5vdGhpbmcgdW50aWwgb24gY2xpY2sgZnVuY3Rpb24gaXMgY2FsbGVkXHJcbk9uIGNsaWNrIGZ1bmN0aW9uIGZvciBodW1hbiBndWVzc2VzOlxyXG4tR2V0IGNvb3JkaW5hdGVzXHJcbi1Db21wLnJlY2VpdmUgYXR0YWNrXHJcbi1VcGRhdGUgZ3Vlc3Mgc3F1YXJlIHdpdGggY2xhc3MgZm9yIGhpdCBvciBtaXNzXHJcbi1DaGVjayBmb3IgYWxsIHN1bmtcclxuLSBpZiBhbGwgc3VuaywgcmVtb3ZlIGFsbCBsaXN0ZW5lcnMsIHJldHVybiwgYW5kIGRpc3BsYXkgd2lubmVyXHJcbi1pZiBub3QgYWxsIHN1bmssIHJlbW92ZSBsaXN0ZW5lciBmcm9tIHByZXZpb3VzIGd1ZXNzLCAtLT4gY29tcHV0ZXIgdHVybiBcclxuLWdlbmVyYXRlIHJhbmRvbSBndWVzcyB1bnRpbCB2YWxpZCBndWVzc1xyXG4tSHVtYW4ucmVjZWl2ZSBhdHRhY2tcclxuLVVwZGF0ZSBib2FyZCB3aXRoIGd1ZXNzIHJlc3VsdFxyXG4tQ2hlY2sgZm9yIGFsbCBzdW5rXHJcbi1pZiBhbGwgc3VuaywgcmVtb3ZlIGFsbCBsaXN0ZW5lcmVzLCByZXR1cm4sIGRpc3BsYXkgd2lubmVyXHJcbi1pZiBub3QgYWxsIHN1bmsgLS0+IGRvIG5vdGhpbmcuIFxyXG5cclxuKi9cclxuXHJcbi8qXHJcbnJlY2VpdmUgYXR0YWNrIFxyXG5maW5kIHJvdyBkaXYgYnkgYXR0cmlidXRlIC0tPiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKS5xdWVyeVNlbGVjdG9yQWxsKCdbeS1Db3JkPVwiMVwiXScpO1xyXG5maW5kIGJveCBkaXYgYnkgYXR0cmlidXRlXHJcbmxldCBydyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGxheWVyXCIpLnF1ZXJ5U2VsZWN0b3JBbGwoJ1t5LUNvcmQ9XCIxXCJdJyk7XHJcbmxldCBib3ggPSByd1swXS5xdWVyeVNlbGVjdG9yQWxsKCdbeC1Db3JkPVwiMVwiXScpO1xyXG5jb25zb2xlLmxvZyhib3hbMF0pO1xyXG5pZihwbGF5ZXIuYm9hcmQuYm9hcmRbeUd1ZXNzIC0xXVt4R3Vlc3MgLTFdID09ICdtaXNzJylcclxue1xyXG4gIGFkZCBjbGFzcyBuYW1lIG1pc3NcclxufWVsc2V7XHJcbiAgYWRkIGNsYXNzIG5hbWUgaGl0XHJcbn1cclxuICBOZWVkIGZ1bmN0aW9ucyBmb3I6XHJcbiAgICAtUmVtb3ZpbmcgYWxsIGd1ZXNzIGxpc3RlbmVyc1xyXG4gICAgXHJcblxyXG5cclxuKi9cclxuXHJcbmV4cG9ydHMuY3JlYXRlU2hpcCA9IGNyZWF0ZVNoaXA7XHJcbmV4cG9ydHMuY3JlYXRlR2FtZUJvYXJkID0gY3JlYXRlR2FtZUJvYXJkO1xyXG5leHBvcnRzLmdhbWVMb29wID0gZ2FtZUxvb3A7XHJcblxyXG4vKlxyXG4yZCBBcnJheTpcclxuICB4LT4gICAwICAgICAgIDEgICAgICAgICAyICAgICAgICAgMyAgICAgICA0ICAgICAgIDUgICAgICAgNlxyXG4gICAgMCBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIDEgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICAyIFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgMyBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIDQgW1wiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIl0sXHJcbiAgICA1IFtcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCJdLFxyXG4gICAgNiBbXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiLCBcImVtcHR5XCIsIFwiZW1wdHlcIiwgXCJlbXB0eVwiXSxcclxuICAgIF5cclxuICAgIHlcclxuICAgIEVhY2ggbmV3IHN1Yi1hcnJheSBpcyBhIHkgaW5jcmVtZW50YXRpb25cclxuICAgIEVhY2ggaW5kZXggaW5zaWRlIG9mIHRoZSBzdWJhcnJheSBpcyBhIHgtIGluY3JlbWVudGF0aW9uXHJcbiAgICBCb2FyZCB3aWxsIGJlIHkgPSAwIGZyb20gdGhlIHRvcCB4ID0gMCBmcm9tIHRoZSBsZWZ0XHJcbiAgICBib2FyZFtyb3ddW2NvbHVtbl1cclxuKi9cclxuXHJcbi8qXHJcbiAgICBTaGlwczpcclxuICAgIENhcnJpZXItIDVcclxuICAgIEJhdHRsZXNoaXAgLSA0XHJcbiAgICBDcnVpc2VyIC0gM1xyXG4gICAgU3VibWFyaW5lIC0gM1xyXG4gICAgRGVzdHJveWVyIC0gMlxyXG5cclxuKi9cclxuXHJcbi8qXHJcblxyXG5Gb3IgY29tcHV0ZXIgZ3Vlc3Nlc3M6XHJcbmxldCB4R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxubGV0IHlHdWVzcyA9IE1hdGgucmFuZG9tKDcpO1xyXG53aGlsZSghcDEuYm9hcmQucmVjZWl2ZUF0dGFjayh5R3Vlc3MsIHhHdWVzcykpXHJcbntcclxuICB4R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxuICB5R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxufVxyXG5cclxuRm9yIGdhbWUgbG9vcFwiXHJcbmxldCB0dXJuQ291bnRlciA9IDE7XHJcbmxldCB3aW5uZXIgPSBudWxsO1xyXG53aGlsZSh3aW5uZXIgPT0gbnVsbClcclxue1xyXG4gIGlmKHR1cm5Db3VudGVyJTIgPT0gKVxyXG4gIHtcclxuICAgIGdldCBndWVzcyB2YWx1ZXNcclxuICAgIHdoaWxlKCFwMi5ib2FyZC5yZWNlaXZlQXR0YWNrKHZhbHVlcykpXHJcbiAgICB7XHJcbiAgICAgIHVwZGF0ZSBndWVzcyB2YWx1ZXNcclxuICAgIH1cclxuICAgIGNoZWNrIGZvciBhbGwgc3Vua1xyXG4gIH1lbHNle1xyXG5sZXQgeEd1ZXNzID0gTWF0aC5yYW5kb20oNyk7XHJcbmxldCB5R3Vlc3MgPSBNYXRoLnJhbmRvbSg3KTtcclxud2hpbGUoIXAxLmJvYXJkLnJlY2VpdmVBdHRhY2soeUd1ZXNzLCB4R3Vlc3MpKVxyXG57XHJcbiAgeEd1ZXNzID0gTWF0aC5yYW5kb20oNyk7XHJcbiAgeUd1ZXNzID0gTWF0aC5yYW5kb20oNyk7XHJcbn1cclxuY2hlY2sgZm9yIGFsbCBzdW5rXHJcbiAgfVxyXG4gIHR1cm5Db3VudGVyKys7XHJcbn1cclxuXHJcblxyXG5cclxuTmVlZCBhIHdheSB0byB3YWl0IGZvciBuZXcgdmFsdWVzIGlmIGd1ZXNzIGZyb20gdXNlciBpcyBpbnZhbGlkXHJcbk1heWJlIGFuIG9uY2xpY2sgbWV0aG9kIHRoYXQgc2VuZHMgdmFsdWVzXHJcbk5lZWQgYSB3YXkgdG8gZ2V0IHJldHVybiBmcm9tIGNoZWNrIGlmIGFsbCBhcmUgc3Vuaz8gTWF5YmUgcmVtb3ZlIGl0IGZyb20gcmVjZWl2ZVxyXG5hdHRhY2sgYW5kIGNhbGwgaXQgYWZ0ZXIgZXZlcnkgdHVybiBcclxuXHJcbiovXHJcblxyXG4vKlxyXG4tUmVuZGVyIGVtcHR5IGJvYXJkXHJcbi1OZWVkIGEgd2F5IHRvIHRyYWNrIHdoaWNoIHNxdWFyZSBpcyBnZXR0aW5nIGNsaWNrZWQgaW4gcmVsYXRpb24gdG8gdGhlIDJkIGFycmF5XHJcbi1SZW5kZXIgYm9hcmQgYWZ0ZXIgcGxhY2luZyBlYWNoIHNoaXAgdy9hIHNoaXAgbWFya2VyXHJcbi1VcGRhdGUgc3F1YXJlcyBhZnRlciBlYWNoIGd1ZXNzIG9uIGVhY2ggc2lkZS4gXHJcbi1NYXliZSB1c2UgZ2V0IHNvdXJjZSB0byBnZXQgMmQgYXJyYXkgY29vcmRpbmF0ZXNcclxuXHJcblxyXG4tRXhwb3J0IGNvbXB1dGVyIHBsYXllclxyXG4tRXhwb3J0IHR1cm4gY291bnRlciB0byB0cmFjayB3aGVuIGNvbXAgc2hvdWxkIG1ha2UgYSBtb3ZlIGFuZCB3aGVuIHRvIGNoZWNrIGZvclxyXG5hbGwgc3VuayBmb3Igd2hvc2UgYm9hcmRcclxuLSBFdmVudCBsaXN0ZW5lciBvbiByaWdodCBzaWRlIGJvYXJkIGZvciBjb21wLmJvYXJkLnJlY2VpdmVBdHRhY2tcclxuLSBFbXB0eSB3aGlsZSBsb29wIHdpdGggY29uZGl0aW9uIG9mIHR1cm5Db3VudCBtb2QgMiA9PSAwLCBhZGQgdHVybkNvdW50IGluY3JlbWVudFxyXG4tIHRvIGd1ZXNzIG9uIGNsaWNrIFxyXG5cclxuKi9cclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwic2hpcHMiLCJuYW1lIiwibGVuZ3RoIiwicGxhY2VkIiwic2hpcEluZGV4IiwiZW1wdHlSZW5kZXIiLCJkaXYiLCJwbGF5ZXIiLCJwYXJlbnREaXYiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicm93QXJyIiwiaSIsInJvdyIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJzZXRBdHRyaWJ1dGUiLCJib3giLCJpbm5lclRleHQiLCJhcHBlbmRDaGlsZCIsImoiLCJjb25zb2xlIiwibG9nIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImNoaWxkTm9kZXMiLCJwbGFjZVNoaXBMaXN0ZW5lcnMiLCJ1c2VyIiwicm93cyIsImN1clJvdyIsImN1cllDb3JkIiwiZ2V0QXR0cmlidXRlIiwiY3VyQm94IiwiY3VyWENvcmQiLCJib2FyZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJvbkFkZFNoaXBDbGljayIsImV2ZW50IiwidGFyZ2V0IiwicGxhY2VTaGlwIiwicGFyZW50Tm9kZSIsInNoaXAiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicmVtb3ZlQWRkU2hpcHMiLCJzaGlwc1BsYWNlZCIsInJlZnJlc2hCb2FyZCIsImNyZWF0ZVNoaXAiLCJkaXJlY3Rpb24iLCJzdGFydGluZ0NvcmQiLCJlbmRpbmdDb3JkIiwiaGVhbHRoIiwic3VuayIsInB1c2giLCJzaGlwUG9pbnQiLCJoaXRTdGF0dXMiLCJjb29yZGluYXRlcyIsInhDb3JkIiwic3RhcnRpbmdYQ29yZCIsInlDb3JkIiwic3RhcnRpbmdZQ29yZCIsImlzU3VuayIsInRoaXMiLCJoaXQiLCJoaXRQb2ludCIsImNyZWF0ZUdhbWVCb2FyZCIsImdhbWVCb2FyZCIsInNoaXBUb1BsYWNlIiwic3RhcnRpbmdDb2x1bW4iLCJzdGFydGluZ1JvdyIsImVuZGluZ0NvbHVtbiIsImVuZGluZ1hDb3JkIiwiZW5kaW5nUm93IiwiZW5kaW5nWUNvcmQiLCJjaGVja0ZvclZhbGlkUGxhY2VtZW50IiwicGxhY2VPYmoiLCJzcG90Iiwic2hpcE5hbWUiLCJmaWx0ZXIiLCJzaCIsInBvaW50QXJyIiwicG9pbnQiLCJjcmVhdGVQbGF5ZXIiLCJ0eXBlIiwiZ2FtZUxvb3AiLCJodW0iLCJjb21wIiwid2lubmVyIiwic2hpcE5hbWVzIiwic2hpcExlbmd0aHMiLCJkaXJlY3Rpb25zIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicmVjZWl2ZUF0dGFjayIsImNoZWNrRm9yQWxsU3VuayJdLCJzb3VyY2VSb290IjoiIn0=